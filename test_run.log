
> spreadjs-jest@0.1.0 test C:\code\spreadjs-jest
> react-scripts test

  console.error
    Error: Uncaught [TypeError: Cannot read property 'replace' of undefined]
        at reportException (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
        at innerInvokeEventListeners (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:341:9)
        at invokeEventListeners (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:274:3)
        at HTMLUnknownElementImpl._dispatch (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:221:9)
        at HTMLUnknownElementImpl.dispatchEvent (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:94:17)
        at HTMLUnknownElement.dispatchEvent (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:231:34)
        at Object.apply (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:3994:16)
        at invokeGuardedCallback (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:4056:31)
        at eventHandler (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:23151:9)
        at unstable_runWithPriority (C:\code\spreadjs-jest\node_modules\scheduler\cjs\scheduler.development.js:468:12) TypeError: Cannot read property 'replace' of undefined
        at a.text (C:\code\spreadjs-jest\public\js\spreadjs\gc.spread.sheets.all.14.2.0.min.js:65:8090)
        at a.text (C:\code\spreadjs-jest\public\js\spreadjs\gc.spread.sheets.all.14.2.0.min.js:65:8196)
        at a.j1 (C:\code\spreadjs-jest\public\js\spreadjs\gc.spread.sheets.all.14.2.0.min.js:65:12534)
        at a.workbook (C:\code\spreadjs-jest\public\js\spreadjs\gc.spread.sheets.all.14.2.0.min.js:65:9203)
        at C:\code\spreadjs-jest\public\js\spreadjs\gc.spread.sheets.designer.all.14.2.0.min.js:1:863627
        at Object.InternalInit (C:\code\spreadjs-jest\public\js\spreadjs\gc.spread.sheets.designer.all.14.2.0.min.js:1:863316)
        at e.setConfig (C:\code\spreadjs-jest\public\js\spreadjs\gc.spread.sheets.designer.all.14.2.0.min.js:1:5422203)
        at m (C:\code\spreadjs-jest\public\js\spreadjs\gc.spread.sheets.designer.all.14.2.0.min.js:1:5249579)
        at o (C:\code\spreadjs-jest\public\js\spreadjs\gc.spread.sheets.designer.all.14.2.0.min.js:1:5252744)
        at l (C:\code\spreadjs-jest\public\js\spreadjs\gc.spread.sheets.designer.all.14.2.0.min.js:1:5256841)
        at Object._validate (C:\code\spreadjs-jest\public\js\spreadjs\gc.spread.sheets.designer.all.14.2.0.min.js:1:5251970)
        at Object.sd (C:\code\spreadjs-jest\public\js\spreadjs\gc.spread.sheets.designer.all.14.2.0.min.js:1:5253622)
        at new e (C:\code\spreadjs-jest\public\js\spreadjs\gc.spread.sheets.designer.all.14.2.0.min.js:1:5417964)
        at ref (C:\code\spreadjs-jest\src\Designer.jsx:9:27)
        at commitAttachRef (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:20875:7)
        at apply (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:23431:9)
        at HTMLUnknownElement.callCallback (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:3945:14)
        at HTMLUnknownElement.callTheUserObjectsOperation (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
        at innerInvokeEventListeners (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:338:25)
        at invokeEventListeners (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:274:3)
        at HTMLUnknownElementImpl._dispatch (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:221:9)
        at HTMLUnknownElementImpl.dispatchEvent (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:94:17)
        at HTMLUnknownElement.dispatchEvent (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:231:34)
        at Object.apply (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:3994:16)
        at invokeGuardedCallback (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:4056:31)
        at eventHandler (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:23151:9)
        at Scheduler_runWithPriority (C:\code\spreadjs-jest\node_modules\scheduler\cjs\scheduler.development.js:468:12)
        at runWithPriority$1 (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:11276:10)
        at commitRoot (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:22990:3)
        at performSyncWorkOnRoot (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:22329:3)
        at scheduleUpdateOnFiber (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:21881:7)
        at updateContainer (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:25482:3)
        at fn (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:26021:7)
        at unbatchedUpdates (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:22431:12)
        at legacyRenderSubtreeIntoContainer (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:26020:5)
        at Object.render (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:26103:10)
        at fn (C:\code\spreadjs-jest\node_modules\@testing-library\react\dist\pure.js:101:25)
        at batchedUpdates (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:22380:12)
        at act (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom-test-utils.development.js:1042:14)
        at render (C:\code\spreadjs-jest\node_modules\@testing-library\react\dist\pure.js:97:3)
        at Object.<anonymous> (C:\code\spreadjs-jest\src\App.test.js:5:3)
        at Promise.then.completed (C:\code\spreadjs-jest\node_modules\jest-circus\build\utils.js:276:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\code\spreadjs-jest\node_modules\jest-circus\build\utils.js:216:10)
        at _callCircusTest (C:\code\spreadjs-jest\node_modules\jest-circus\build\run.js:212:40)
        at processTicksAndRejections (internal/process/task_queues.js:95:5)
        at _runTest (C:\code\spreadjs-jest\node_modules\jest-circus\build\run.js:149:3)
        at _runTestsForDescribeBlock (C:\code\spreadjs-jest\node_modules\jest-circus\build\run.js:63:9)
        at run (C:\code\spreadjs-jest\node_modules\jest-circus\build\run.js:25:3)
        at runAndTransformResultsToJestFormat (C:\code\spreadjs-jest\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:176:21)
        at jestAdapter (C:\code\spreadjs-jest\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:109:19)
        at runTestInternal (C:\code\spreadjs-jest\node_modules\jest-runner\build\runTest.js:380:16)
        at runTest (C:\code\spreadjs-jest\node_modules\jest-runner\build\runTest.js:472:34)
        at Object.worker (C:\code\spreadjs-jest\node_modules\jest-runner\build\testWorker.js:133:12)

      at VirtualConsole.<anonymous> (node_modules/jsdom/lib/jsdom/virtual-console.js:29:45)

  console.error
    Error: Uncaught [TypeError: Cannot read property 'destroy' of null]
        at reportException (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\helpers\runtime-script-errors.js:66:24)
        at innerInvokeEventListeners (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:341:9)
        at invokeEventListeners (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:274:3)
        at HTMLUnknownElementImpl._dispatch (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:221:9)
        at HTMLUnknownElementImpl.dispatchEvent (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:94:17)
        at HTMLUnknownElement.dispatchEvent (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:231:34)
        at Object.apply (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:3994:16)
        at invokeGuardedCallback (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:4056:31)
        at safelyDetachRef (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:20435:9)
        at commitUnmount (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:20959:9) TypeError: Cannot read property 'destroy' of null
        at apply (C:\code\spreadjs-jest\src\Designer.jsx:12:25)
        at HTMLUnknownElement.callCallback (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:3945:14)
        at HTMLUnknownElement.callTheUserObjectsOperation (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
        at innerInvokeEventListeners (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:338:25)
        at invokeEventListeners (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:274:3)
        at HTMLUnknownElementImpl._dispatch (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:221:9)
        at HTMLUnknownElementImpl.dispatchEvent (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:94:17)
        at HTMLUnknownElement.dispatchEvent (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:231:34)
        at Object.apply (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:3994:16)
        at invokeGuardedCallback (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:4056:31)
        at safelyDetachRef (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:20435:9)
        at commitUnmount (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:20959:9)
        at commitNestedUnmounts (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:21004:5)
        at unmountHostComponents (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:21290:7)
        at commitDeletion (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:21347:5)
        at apply (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:23407:11)
        at HTMLUnknownElement.callCallback (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:3945:14)
        at HTMLUnknownElement.callTheUserObjectsOperation (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\generated\EventListener.js:26:30)
        at innerInvokeEventListeners (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:338:25)
        at invokeEventListeners (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:274:3)
        at HTMLUnknownElementImpl._dispatch (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:221:9)
        at HTMLUnknownElementImpl.dispatchEvent (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\events\EventTarget-impl.js:94:17)
        at HTMLUnknownElement.dispatchEvent (C:\code\spreadjs-jest\node_modules\jsdom\lib\jsdom\living\generated\EventTarget.js:231:34)
        at Object.apply (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:3994:16)
        at invokeGuardedCallback (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:4056:31)
        at eventHandler (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:23121:9)
        at Scheduler_runWithPriority (C:\code\spreadjs-jest\node_modules\scheduler\cjs\scheduler.development.js:468:12)
        at runWithPriority$1 (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:11276:10)
        at commitRoot (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:22990:3)
        at callback (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:22329:3)
        at eventHandler (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:11327:26)
        at Scheduler_runWithPriority (C:\code\spreadjs-jest\node_modules\scheduler\cjs\scheduler.development.js:468:12)
        at runWithPriority$1 (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:11276:10)
        at flushSyncCallbackQueueImpl (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:11322:9)
        at flushSyncCallbackQueue (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:11309:3)
        at batchedUpdates (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom.development.js:22387:7)
        at act (C:\code\spreadjs-jest\node_modules\react-dom\cjs\react-dom-test-utils.development.js:1042:14)
        at render (C:\code\spreadjs-jest\node_modules\@testing-library\react\dist\pure.js:97:3)
        at Object.<anonymous> (C:\code\spreadjs-jest\src\App.test.js:5:3)
        at Promise.then.completed (C:\code\spreadjs-jest\node_modules\jest-circus\build\utils.js:276:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\code\spreadjs-jest\node_modules\jest-circus\build\utils.js:216:10)
        at _callCircusTest (C:\code\spreadjs-jest\node_modules\jest-circus\build\run.js:212:40)
        at processTicksAndRejections (internal/process/task_queues.js:95:5)
        at _runTest (C:\code\spreadjs-jest\node_modules\jest-circus\build\run.js:149:3)
        at _runTestsForDescribeBlock (C:\code\spreadjs-jest\node_modules\jest-circus\build\run.js:63:9)
        at run (C:\code\spreadjs-jest\node_modules\jest-circus\build\run.js:25:3)
        at runAndTransformResultsToJestFormat (C:\code\spreadjs-jest\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:176:21)
        at jestAdapter (C:\code\spreadjs-jest\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:109:19)
        at runTestInternal (C:\code\spreadjs-jest\node_modules\jest-runner\build\runTest.js:380:16)
        at runTest (C:\code\spreadjs-jest\node_modules\jest-runner\build\runTest.js:472:34)
        at Object.worker (C:\code\spreadjs-jest\node_modules\jest-runner\build\testWorker.js:133:12)

      at VirtualConsole.<anonymous> (node_modules/jsdom/lib/jsdom/virtual-console.js:29:45)

  console.error
    The above error occurred in the <div> component:
    
        at div
        at fn (C:\code\spreadjs-jest\src\Designer.jsx:5:17)
        at App
    
    Consider adding an error boundary to your tree to customize error handling behavior.
    Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

      at logCapturedError (node_modules/react-dom/cjs/react-dom.development.js:20085:7)

  console.error
    The above error occurred in the <div> component:
    
        at div
        at fn (C:\code\spreadjs-jest\src\Designer.jsx:5:17)
        at App
    
    Consider adding an error boundary to your tree to customize error handling behavior.
    Visit https://reactjs.org/link/error-boundaries to learn more about error boundaries.

      at logCapturedError (node_modules/react-dom/cjs/react-dom.development.js:20085:7)

FAIL src/App.test.js (20.849 s)
  ├ù renders learn react link (11479 ms)

  ΓùÅ renders learn react link

    TypeError: Cannot read property 'replace' of undefined

      63 | pageX:d.X,pageY:d.Y,stopPropagation:function(){}})},a.prototype.qQ=function(a,b){var c=this,d=b?a.rN:c.OS(a.rN),e=a.dP.rO,f=c.MS.kj,g=f.parent;1!==e&&g&&g.options.allowUserZoom&&!b?c.hQ.SP(e):this.MS.CD({isTouch:!0,button:0,pageX:d.X,pageY:d.Y,stopPropagation:function(){}})},a.prototype.sQ=function(b,c){var d,f=this,g=c?b.rN:f.OS(b.rN),i={e:{rN:g},r:h};if(a.ao(f,"preProcessTapped",i),!i.r)try{d=f.MS.kj,d.suspendPaint(),f.YR.isSelected()||(d.uQ(),f.YR.isSelected(!0),d.Wq(e.Events.FloatingElementSelected,{type:"floatingObject"}),e.Vl.Zl(d)),d.clearSelection()}finally{d.resumePaint()}},a}(),b.FloatingObjectTouchEventHandler=j,e.Zn(j),e.Rxb.touch&&f.FloatingObjectRender.$n("touch",{init:function(a){var b=this,c=b.wR=new i(a,b,b.kj.parent.BQ);c.EQ()},dispose:function(){var a=this.wR;a&&a.FQ()},preProcessMouseDown:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.GQ(b)&&(g(b),a.r=!0)},preProcessMouseMove:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.IQ(b)&&(g(b),a.r=!0)},preProcessMouseUp:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.HQ(b)&&(g(b),a.r=!0)}})},"./dist/plugins/floatingObject/floatingobject.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/floatingObject/picture.js")),d(c("./dist/plugins/floatingObject/floatingobject.js")),d(c("./dist/plugins/floatingObject/floatingobject-actions.js")),d(c("./dist/plugins/floatingObject/floatingobject-touch.js")),d(c("./dist/plugins/floatingObject/floatingobject.ns.js"));var e=c("./dist/plugins/floatingObject/drawing/chart.ns.js");b.Drawing=e},"./dist/plugins/floatingObject/floatingobject.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/floatingObject/floatingobject.ns.js"),g=function(){function a(){this.rM={}}return a.prototype.push=function(a){this.rM[ea(a)]=a},a.prototype.remove=function(a){delete this.rM[a]},a.prototype.find=function(a){return this.rM[a]},a.prototype.empty=function(){delete this.rM,this.rM={}},a.prototype.each=function(a){var b,c=this.rM;for(b in c)c.hasOwnProperty(b)&&a(c[b])},a.prototype.isEmpty=function(){var a,b=this.rM;for(a in b)if(b.hasOwnProperty(a))return!1;return!0},a}(),b.yR=g,h=new e.Common.ResourceManager(f.SR,"FloatingObjects"),i=h.getResource.bind(h),j=e.Common.j,k=e.Common.D,l=j.Fa,m=j.Ma,n=d.Ul.Pl,o=d.Ul.Ol,p=d.Ul.Nl,q=d.Ul.Rl,r=g,s=document,t=k,u=null,v=void 0,w=Math.ceil,x=Math.floor,y=Math.max,z=Math.min,A=Math.abs,B={VKb:"div",cHc:"on",dHc:"z-index",dGc:"move",eHc:"unselectable",fHc:1,JLb:"border",gHc:9007199254740992,hHc:"floatingObjects",iHc:".gcFloatingObject",jHc:"name",kHc:"scroll",hFc:"x",lHc:"y",iGc:"width",jGc:"height",mHc:"startRow",nHc:"startRowOffset",oHc:"startColumn",pHc:"startColumnOffset",qHc:"endRow",rHc:"endRowOffset",sHc:"endColumn",tHc:"endColumnOffset",uHc:"isSelected",vHc:"isLocked",wHc:"isVisible",xHc:"canPrint",yHc:"dynamicSize",zHc:"dynamicMove",AHc:"fixedPosition",BHc:"allowResize",CHc:"allowMove",DHc:700,EHc:701,FHc:"position",GHc:"absolute",HHc:"background",IHc:"gc-no-user-select",JHc:"gc-floatingobject-selected",KHc:"gc-floatingobject-unselected",LHc:"gc-floatingobject-resize-indicator-select",MHc:"gc-floatingobject-resize-indicator-unSelect",NHc:"gc-floatingobject-content-container",OHc:"gc-floatingobject-container",PHc:"gc-floatingobject-moving-container",QHc:"gc-floatingobject-moving-div",RHc:".gc-floatingobject-resize-indicator",SHc:"gc-floatingobject-resize-indicator",THc:"gc-floatingobject-absolute",UHc:"gc-floatingobject-top",VHc:"gc-floatingobject-middle",WHc:"gcfloatingobject-bottom",XHc:"gc-floatingobject-left",YHc:"gc-floatingobject-center",ZHc:"gc-floatingobject-right",$Hc:"content",HGc:"gc-no-user-select",_Hc:"100%",aIc:"gc-floatingobject-background-cover",bIc:".fos",fGc:"left",cIc:"center",gGc:"right",OLb:"top",dIc:"middle",hGc:"bottom",VGc:"-resize",DGc:"cursor",eIc:"mousemove",fIc:"mouseup",gIc:"startX",hIc:"startY",iIc:"startWidth",jIc:"startHeight",kIc:"endX",lIc:"endY",mIc:"startTopRow",nIc:"startLeftColumn"},C=B.VKb+"."+B.SHc,D=C+"."+B.UHc+"."+B.XHc,E=C+"."+B.VHc+"."+B.XHc,F=C+"."+B.WHc+"."+B.XHc,G=C+"."+B.UHc+"."+B.YHc,H=C+"."+B.WHc+"."+B.YHc,I=C+"."+B.UHc+"."+B.ZHc,J=C+"."+B.VHc+"."+B.ZHc,K=C+"."+B.WHc+"."+B.ZHc,L=B.OLb+B.fGc,M=B.OLb+B.cIc,N=B.OLb+B.gGc,O=B.dIc+B.fGc,P=B.dIc+B.gGc,Q=B.hGc+B.fGc,R=B.hGc+B.cIc,S=B.hGc+B.gGc;function ea(a){return"string"==typeof a[B.jHc]?a[B.jHc]:a[B.jHc]()}T=function(){var a=this;a.uQ=function(){var a=this.wr;a&&a.zR().forEach(function(a){a.isSelected(!1)})},a.AR=function(){var a=this,b=a.wr;b&&(b.isNeedToUpdateLayout=!0)},a.BR=function(){var a=this,b=a.parent,c=a.tv,d=b&&b.tv;return c||(c=a.tv=d?d:{fromSheet:u,isCutting:!1}),c},a.ex=function(){var a=this,b=a.BR(),c=b&&b.fromSheet;c&&(c.CR=u),b.fromSheet=u,b.isCutting=!1},a.DR=function(a){var b=this.options;return!b.isProtected||!a.isLocked()||b.protectionOptions.allowEditObjects},a.ER=function(a){var b=this.options;return!b.isProtected||!a.isLocked()||b.protectionOptions.allowEditObjects},a.isPasteFloatingObject=function(){var a=this,b=a.BR().fromSheet,c=this.CR;return!c&&b&&(c=b.CR),c&&!c.isEmpty()},a.IR=function(a,b){var c,d,e=this;return e.FR||(e.FR=[]),c=e.FR[a],c||(e.FR[a]=[]),d=e.FR[a][b],d||(e.FR[a][b]=new ba(e)),d=e.FR[a][b]},a.QP=function(a,b){var c,d,e,f,g,h=this,i=h;if(!i.fI&&i.wr&&i.yl&&i.yl.bm())for(c=i.am(),d=void 0,b!==u&&void 0!==b||(b=i.zoom()),e=0;e<=2;e++)for(f=0;f<=2;f++)d=c.Ft(e,f),d&&(g=i.IR(e,f),g&&g.yl(e,f,b))}},T.call(d.Worksheet.prototype);function fa(a,b){var c,d,e,f,g,h,i,j=a.FR;if(j){for(c=void 0,d=void 0,e=void 0,f=void 0,e=j.length,c=0;c<e;c++)if(g=j[c]){for(f=g.length,d=0;d<f;d++)h=g[d],h&&h.no();g.length=0}j.length=0,a.FR=u}i=a.wr,i&&b!==!1&&i.no()}function ga(a,b,c){a.zR().forEach(function(a){a.rI(b,c)})}function ha(a,b,c){var d,e,f=[];for(a.zR().forEach(function(d){ka(b,-1,b+c-1,a.sheet().getColumnCount(),d)&&(d.dynamicMove()||d.dynamicSize())?f.push(d):d.GR(b,c)}),e=f.length,d=0;d<e;d++)a.Fb(f[d].name())}function ia(a,b,c){a.zR().forEach(function(a){a.tI(b,c)})}function ja(a,b,c){var d,e,f=[];for(a.zR().forEach(function(d){ka(-1,b,a.sheet().getRowCount(),b+c-1,d)&&(d.dynamicMove()||d.dynamicSize())?f.push(d):d.HR(b,c)}),e=f.length,d=0;d<e;d++)a.Fb(f[d].name())}function ka(a,b,c,d,e){var f=e[B.mHc](),g=e[B.oHc](),h=e[B.qHc](),i=e[B.sHc]();return a<=f&&b<=g&&c>=h&&d>=i}function la(a,b){var c=this;return b||(b={}),d.GC$.each(a,function(a,d){var e=c[d],f=e.call(c);e.isDefault(f)||(b[d]=f)}),b}b.toJsonFn=la;function ma(a,b){if(b){var c=this;d.GC$.each(a,function(a,d){b[d]!==v&&c[d].call(c,b[d],!1)})}}b.fromJsonFn=ma;function na(a){var b=a;return function(a,c){var d=this,e=d.sheet();b===B.$Hc&&(d.KR=!0),e&&e.$p(),d.onPropertyChanged(b,a,c)}}b.propertyRefreshCallback=na;function oa(a){var b=a;return function(a,c){var d=this,e=d.sheet();e&&(qa(d),d.CXc||va(d),e.$p()),d.onPropertyChanged(b,a,c)}}function pa(a){var b=a;return function(a,c){var d=this,e=d.sheet();e&&(Fa(d),e.$p()),d.onPropertyChanged(b,a,c)}}function qa(a){var b,c,e,f,g=a.sheet();function h(b,c,d,e){var f=0,h=b.call(a);return f=c.call(a,g,0,h),ra.call(a,b,d,e),f+=d.call(a)}g&&(b=h(a[B.mHc],sa,a[B.nHc],g.getRowHeight),c=h(a[B.oHc],ta,a[B.pHc],g.getColumnWidth),e=a.x(),f=a.y(),e===c&&f===b||(a.x(c,!1),a.y(b,!1),a.onPropertyChanged("position",new d.Point(c,b),new d.Point(e,f))))}function ra(a,b,c){var d=this,e=b.call(d),f=c.call(d.sheet(),a.call(d),3);f>0&&f--,e>f&&b.call(d,f,!1)}function sa(a,b,c,d){var e,f=0;for(e=b;e<c&&(f+=a.getRowHeight(e,3),!(f>d));e++);return f}function ta(a,b,c,d){var e,f=0;for(e=b;e<c&&(f+=a.getColumnWidth(e,3),!(f>d));e++);return f}function ua(a){var b=a.sheet();function c(b,c,d,e,f){var g=wa(a,b,c),h=g.index;e.call(a,g.offset,!1),g.offset===-1&&(h+=1,e.call(a,0),h===f&&(h=f-1)),d.call(a,h,!1)}b&&(c(!0,a.y(),a[B.mHc],a[B.nHc],b.getRowCount()),c(!1,a.x(),a[B.oHc],a[B.pHc],b.getColumnCount()))}function va(a){var b=a.sheet();function c(b,c,d,e){var f=wa(a,b,c);d.call(a,f.index,!1),e.call(a,f.offset,!1)}b&&(c(!0,a.y()+a[B.jGc](),a[B.qHc],a[B.rHc]),c(!1,a.x()+a[B.iGc](),a[B.sHc],a[B.tHc]))}function wa(a,b,c){var d,e,f=0,g=0,h=a.sheet(),i=b?h.getRowCount():h.getColumnCount();for(d=0;d<i;d++){if(e=b?h.getRowHeight(d,3):h.getColumnWidth(d,3),f+=e,g=f-c,g>0){g=g>0?e-g:-1;break}if(0===g){g=0,d+=1;break}}return d>=i&&(d=i-1,g=b?h.getRowHeight(d,3):h.getColumnWidth(d,3)),{offset:g,index:d}}function xa(a,b){ya(b,za(a))}function ya(a,b){a&&(a.style.zIndex=b+"")}function za(a){var b=a.PR;return l(b)&&(b=a.Cka),b}function Aa(a,b){a.PR=b,a.qo.forEach(function(a){for(var c=a.parentElement;c.className.indexOf(B.OHc)===-1;)c=c.parentElement;ya(c,b)})}function Ba(a,b){l(a.PR)&&(a.Cka+=b)}U=function(){function a(a,b){this.kj=a,this.g3=b}return a.prototype.no=function(){this.kj=u},a.prototype.add=function(a,b,c,d,e,f,g,h){var i=this,j;return"1"===i.g3?j=$.ozb(a,b,c,d,e,f):"0"===i.g3&&(j=a),i.kj.wr.Sb(j),j},a.prototype.get=function(a){return this.kj.wr.NR(a)},a.prototype.remove=function(a){this.kj.wr.Fb(a)},a.prototype.clear=function(){return this.kj.wr.$b(this.g3)},a.prototype.all=function(){return this.kj.wr.zR(this.g3)},a.prototype.zIndex=function(a,b){return this.kj.wr.PR(a,b)},a.prototype.tTa=function(a,b,c){this.all().forEach(function(d){var e=c?d.startRow():d.startColumn(),f=c?d.endRow():d.endColumn();b<e||a>f||!d.dynamicSize()||Fa(d),qa(d)})},a}(),b.FloatingObjectCollection=U;function Ca(a){var b=a.sheet();b&&(d.GC$(s.body).bind("scroll"+B.iHc,function(){var a=b.parent&&b.parent.getActiveSheet();a&&a.wr&&b.QP(a.Dr())}),b.Fu(d.Events.ColumnChanged+B.iHc,function(b,c){var d=c.propertyName;d!==B.iGc&&d!==B.wHc||Da(a)}),b.Fu(d.Events.RowChanged+B.iHc,function(b,c){var d=c.propertyName;d!==B.jGc&&d!==B.wHc||Da(a)}),b.Fu(d.Events.ColumnWidthChanged+B.iHc,function(){Da(a)}),b.Fu(d.Events.RowHeightChanged+B.iHc,function(){Da(a)}))}function Da(a){var b=a.sheet();a.isNeedToUpdateLayout=!0,b.QP(b.Dr())}function Ea(a,b,c){return c&&c.width>0&&c.height>0&&(c.x===a||c.y===b||c.contains(a,b))}V=function(){function a(a){var b=this;b.sheet(a),Ca(b),b.QR={}}return a.prototype.Dka=function(a){this.zR().forEach(function(b){Ba(b,a)})},a.prototype.Sb=function(a,b){var c,d=this,e=d.sheet();if(e.suspendPaint(),c=a.name(),!c)throw e.resumePaint(),Error(i().Exp_FloatingObjectNameEmptyError);if(d.QR[c]){if(!b)throw e.resumePaint(),Error(i().Exp_FloatingObjectHasSameNameError);c=d.FS(c+"__"),a.name(c)}e.ITa.AUa(),d.Dka(-1),a.sheet(e),d.QR[c]=a,e.Zoa(a),e.resumePaint()},a.prototype.NR=function(a){return this.QR[a]},a.prototype.Fb=function(a,b){var c,e,f,g=this;return!!a&&(c=g.sheet(),e=g.NR(a),c.ITa.AUa(),c.suspendPaint(),b?(f={sheet:c,sheetName:c.name(),floatingObject:e,cancel:!1},c.Wq(d.Events.FloatingObjectRemoving,f),f.cancel===!1&&(delete g.QR[a],c.Wq(d.Events.FloatingObjectRemoved,{sheet:c,sheetName:c.name(),floatingObject:e}))):delete g.QR[a],c.resumePaint(),!0)},a.prototype.U3=function(a,b){var c,d=this,e=d.sheet();if(e.suspendPaint(),!b)throw Error(i().Exp_FloatingObjectNameEmptyError);if(d.QR[b])throw Error(i().Exp_FloatingObjectHasSameNameError);c=d.QR[a],delete d.QR[a],d.QR[b]=c,c.onNameChanged&&c.onNameChanged(a,b),e.resumePaint()},a.prototype.$b=function(a){var b=this,c=b.sheet();c.suspendPaint(),d.GC$.each(this.QR,function(c,d){a&&a!==d.g3||b.Fb(d.name())}),c.resumePaint()},a.prototype.zR=function(a){var b=[];return d.GC$.each(this.QR,function(c,d){a&&a!==d.g3||b.push(d)}),b},a.prototype.PR=function(a,b){var c=isNaN(b),d=this.NR(a);if(d){if(c)return za(d);Aa(d,b)}if(c)return-1},a.prototype.toJSON=function(){var a=[];return this.zR().forEach(function(b){var c,d;b instanceof $&&b.hga()&&(c=b.toJSON(),d=b.PR,isNaN(d)||(c.zIndex=d),a.push(c))}),a},a.prototype.fromJSON=function(a,b){var c,e,f,g,h,i,j,k,m,n,o=this;if(a&&0!==a.length)for(c=0;c<a.length;c++)e=a[c],f=void 0,e&&(g=void 0,h=e.floatingObjectType,i=d.Ul.Ol(h)?h+"":e.typeName,"0"===i?f=new $:"1"===i?f=$.ozb():(g=d.getTypeFromString(i),g&&(f=new g)),f&&(j=o.sheet(),k=j&&j.parent,m=k&&k.GBb,f.fromJSON(e,b,m),o.Sb(f),n=e.zIndex,l(n)||(f.PR=n)))},a.prototype.no=function(a){d.GC$(s.body).unbind("scroll"+B.iHc);var b=this,c=b.sheet();c&&(c.Gu(d.Events.ColumnChanged+B.iHc),c.Gu(d.Events.RowChanged+B.iHc),c.Gu(d.Events.ColumnWidthChanged+B.iHc),c.Gu(d.Events.RowHeightChanged+B.iHc)),a!==!1&&(b.QR&&d.GC$.each(b.QR,function(b,c){c.no(a)}),b.sheet(u))},a.prototype.hitTest=function(a,b,c){var d,e,f,g,h=this.sheet(),i=h.am(),j=u;if(i)for(d=0;d<=2;d++)for(e=0;e<=2;e++)if(f=i.Ft(d,e),f&&f.contains(a,b)&&(g=h.IR&&h.IR(d,e),g&&g.jS.each(function(d){var e=d.YR;e&&e.isVisible()&&(h.DR(e)||c)&&Ea(a,b,d.Tka)&&(j?za(j.floatingObject)<za(e)&&(j.floatingobject=e):j={x:a,y:b,floatingObject:e,yl:d})}),j))return j;return j},a.prototype.FS=function(a){var b,c;for(a||(a="FloatingObject"),b=1,c=a+(""+b);this.NR(c);)b++,c=a+(""+b);return c},a}(),b.FloatingObjectModel=V,W={sheet:n("sheet",v)},d.GC$.extend(V.prototype,W);function Fa(a){var b,c,d,e,f=a.sheet();function g(b,c,d,e,g,h){var i,j=0,k=b.call(a),l=c.call(a);return j=d.call(a,f,k,l),k===l?(ra.call(a,c,h,e),j=h.call(a)-g.call(a)):(i=e.call(f,k,3),i>0&&(j-=g.call(a)),ra.call(a,c,h,e),j+=h.call(a)),j}f&&(b=g(a[B.mHc],a[B.qHc],sa,f.getRowHeight,a[B.nHc],a[B.rHc]),c=g(a[B.oHc],a[B.sHc],ta,f.getColumnWidth,a[B.pHc],a[B.tHc]),c<0&&(c=0),b<0&&(b=0),d=a[B.iGc](),d!==c&&(a[B.iGc](c,!1),a.onPropertyChanged(B.iGc,c,d)),e=a[B.jGc](),e!==b&&(a[B.jGc](b,!1),a.onPropertyChanged(B.jGc,b,e)))}X=["dotted","dashed","solid","double","groove","ridge","inset","outset"];function Ga(a){return X.indexOf(a)>=0}function Ha(a){var b,c,d;if(o(a)&&("string"!=typeof a||""===a))throw Error(i().Exp_FloatingObjectNameEmptyError);return b=this,a!==b.name()&&(c=b.sheet(),!c||(d=c.wr.NR(a),!d))}Y=[B.jHc,B.hFc,B.lHc,B.iGc,B.jGc,B.mHc,B.nHc,B.oHc,B.pHc,B.qHc,B.rHc,B.sHc,B.tHc,B.xHc,B.uHc,B.vHc,B.wHc,B.zHc,B.yHc,B.AHc,B.BHc,B.CHc,"alt"],Z=[["sheet",u,function(){Oa(this)}],[B.jHc,v,function(a,b){var c,d,e=this,f=e.sheet();f&&(c=f.wr,d=c.NR(b),d===e&&c.U3(b,a)),e.onPropertyChanged("name",a,b)},Ha],[B.hFc,0,Ja(B.hFc,!1)],[B.lHc,0,Ja(B.lHc,!1)],[B.jGc,0,Ja(B.jGc,!0)],[B.iGc,0,Ja(B.iGc,!0)],[B.mHc,v,oa(B.mHc)],[B.nHc,0,oa(B.nHc)],[B.oHc,v,oa(B.oHc)],[B.pHc,0,oa(B.pHc)],[B.qHc,v,pa(B.qHc)],[B.rHc,0,pa(B.rHc)],[B.sHc,v,pa(B.sHc)],[B.tHc,0,pa(B.tHc)],[B.uHc,!1,na(B.uHc)],[B.vHc,!0,Ia(B.vHc)],[B.xHc,!0,Ia(B.xHc)],[B.wHc,!0,na(B.wHc)],[B.zHc,!0,function(a,b){Ia(B.zHc).call(this,a,b)},function(a){return"boolean"==typeof a&&(a||this.dynamicSize(!1,!1),!this.fixedPosition())}],[B.yHc,!0,function(a,b){Ia(B.yHc).call(this,a,b)},function(a){return"boolean"==typeof a&&this.dynamicMove()&&!this.fixedPosition()}],[B.AHc,!1,function(a,b){var c=this;a&&(c.dynamicMove(!1,!1),c.dynamicSize(!1,!1)),c.onPropertyChanged(B.AHc,a,b)}],[B.BHc,!0,na(B.BHc)],[B.CHc,!0,na(B.CHc)],["alt","",Ia("alt")]];function Ia(a){return function(b,c){this.onPropertyChanged(a,b,c)}}function Ja(a,b){return function(c,d){var e=this,f=e.sheet();f&&(b&&Ma(e),Na(e),Ra(e),f.$p()),e.onPropertyChanged(a,c,d)}}function Ka(a,b,c,d){var e,f,g=this;g.CXc=!0,e=a.call(g),f=b.call(g),c<=e?g.dynamicMove()&&(a.call(g,e+d),b.call(g,f+d)):c<f&&g.dynamicSize()&&b.call(g,f+d),g.CXc=!1}function La(a,b,c,d,e,f,g){var h,i,j,k,l=this;l.CXc=!0,h=a.call(l),i=c.call(l),e<=h?g<h?l.dynamicMove()&&(a.call(l,h-f),c.call(l,i-f)):g<i&&(j=g-h+1,k=i-h+1-j,l.dynamicMove()&&(a.call(l,e),b.call(l,0)),l.dynamicSize()&&c.call(l,e+k-1)):e<=i&&(g<i?l.dynamicSize()&&c.call(l,i-f):l.dynamicSize()&&(c.call(l,e),d.call(l,0))),l.CXc=!1}function Ma(a){var b=Pa(a,a[B.jGc]()),c=Qa(a,a[B.iGc]());a[B.iGc]()>c&&a[B.iGc](c,!1),a[B.jGc]()>b&&a[B.jGc](b,!1)}function Na(a){var b,c,d=a.x()+a[B.iGc](),e=Qa(a,d);d>e&&a.x(y(0,e-a[B.iGc]()),!1),a.x()<0&&a.x(0,!1),b=a.y()+a[B.jGc](),c=Pa(a,b),b>c&&a.y(y(0,c-a[B.jGc]()),!1),a.y()<0&&a.y(0,!1)}function Oa(a){var b,c,d,e;Ma(a),Na(a),b=a[B.mHc](),c=a[B.oHc](),l(b)||l(c)?ua(a):qa(a),d=a[B.qHc](),e=a[B.sHc](),l(d)||l(e)?va(a):Fa(a)}function Pa(a,b){var c,d=a.sheet();return d?(c=d.getRowCount(),sa(d,0,c,b)):B.gHc}function Qa(a,b){var c,d=a.sheet();return d?(c=d.getColumnCount(),ta(d,0,c,b)):B.gHc}function Ra(a){ua(a),va(a)}function Sa(a,b,c,d,e,f,g){var h,i=0,j=g?f.getRowHeight:f.getColumnWidth;for(h=a;h<b;h++)i+=w(j.call(f,h)*e);return i-=w((c||0)*e),i+=w((d||0)*e)}function Ta(a,b,c,d){var e,f=0;for(e=0;e<a;e++)f+=d?c.getRowHeight(e,3):c.getColumnWidth(e,3);return f+=b}$=function(){function a(a,b,c,d,e){var f=this;f.LR={startRowOffset:v,startColumnOffset:v,endRowOffset:v,endColumnOffset:v},f.typeName="0",f.g3="0",f.name(a),f.x(b?b:0,!1),f.y(c?c:0,!1),f[B.iGc](d?d:0,!1),f[B.jGc](e?e:0,!1),f.qo=[],f.KR=!1,f.Cka=B.DHc,f.CXc=!1}return a.prototype.position=function(a){var b,c,e=this,f=e.sheet();return 0===arguments.length?new d.Point(e.x(),e.y()):(b=e.x(),c=e.y(),!m(a,d.Point)||b===a.x&&c===a.y||(e.x(a.x,!1),e.y(a.y,!1),Na(e),Ra(e),f&&f.$p(),e.onPropertyChanged("position",a,new d.Point(b,c))),e)},a.prototype.cloneContent=function(){var a,b,c=this.content();return c?(a=void 0,c.cloneNode?a=c.cloneNode(!0):(b=p(B.VKb),b.innerHTML=c.outerHTML,a=b.firstChild),d.GC$(a).removeAttr("id")[0]):u},a.prototype.refreshContent=function(a){var b,c,e,f,g,h,i=this;i.KR&&a&&(b=d.GC$(a),b.empty(),c=i.cloneContent(),e=B._Hc,f=B._Hc,g="",h="",c&&c.style&&(g=c.style.width,h=c.style.height),""!==g&&(e=g),""!==h&&(f=h),c!==u?(d.GC$(c).css({width:e,height:f}).addClass(B.aIc).addClass(B.IHc).attr(B.eHc,B.cHc).appendTo(a),b.css(B.HHc,"")):b.css(B.HHc,""),i.KR=!1)},a.prototype.toJSON=function(){var a,b=this,c=la.call(b,Y),e=b.LR;for(a in e)l(e[a])||(c[a]=e[a]);return c.typeName=b.typeName,c[B.$Hc]=d.GC$(p(B.VKb)).append(b.cloneContent()).html(),c},a.prototype.fromJSON=function(a,b){var c,e;a&&(c=this,c.TR=!0,ma.call(this,Y,a,b),l(a[B.mHc])&&Ra(c),a.content&&(e=p(B.VKb),e.innerHTML=a.content,c.content(d.GC$(e.firstChild)[0])),c.TR=v)},a.prototype.clone=function(b){var c=this,e=d.getTypeFromString(c.typeName),f=e?new e:new a,g=JSON.stringify(c.toJSON());return f.fromJSON(JSON.parse(g)),f.content(c.cloneContent()),f},a.prototype.onPropertyChanged=function(a,b,c){var d,e=this;e.TR||(d=e.sheet(),d&&(d.ITa.BUa(e,a,c),e.Wq({sheet:d,sheetName:d.name(),floatingObject:e,propertyName:a})))},a.prototype.Wq=function(a){var b,c=this.sheet();c&&(c.Wq(d.Events.FloatingObjectChanged,a),a.propertyName===B.uHc&&(b={sheet:a.sheet,sheetName:a.sheetName,floatingObject:a.floatingObject},c.Wq(d.Events.FloatingObjectSelectionChanged,b)))},a.prototype.rI=function(a,b){var c=this;a=w(a),b=w(b),Ka.call(c,c[B.mHc],c[B.qHc],a,b)},a.prototype.GR=function(a,b){var c=this,d=a+b-1;La.call(c,c[B.mHc],c[B.nHc],c[B.qHc],c[B.rHc],a,b,d)},a.prototype.tI=function(a,b){var c=this;a=w(a),b=w(b),Ka.call(c,c[B.oHc],c[B.sHc],a,b)},a.prototype.HR=function(a,b){var c,d=this;a=w(a),b=w(b),c=a+b-1,La.call(d,d[B.oHc],d[B.pHc],d[B.sHc],d[B.tHc],a,b,c)},a.prototype.getHost=function(a,b){var c,d,e=this.qo.concat();if(!l(a)&&!l(b)){for(c=0;c<e.length;c++)if(d=e[c],d.rowViewportIndex===a&&d.columnViewportIndex===b)return d;return u}return e},a.prototype.UR=function(a,b,c){var d=this.qo;a&&d.indexOf(a)<0&&(a.rowViewportIndex=b,a.columnViewportIndex=c,d.push(a))},a.prototype.VR=function(a){var b=this.qo,c=b.indexOf(a);c>=0&&b.splice(c,1)},a.prototype.WR=function(a,b){var c,e,f,g,h,i,j=p(B.VKb);return d.GC$(j).addClass(B.HGc).addClass(B.NHc).attr(B.eHc,B.cHc).css(B.FHc,B.GHc),c=this.cloneContent(),e=B._Hc,f=B._Hc,g="",h="",i=c&&c.style,i&&(g=i.width,h=i.height),""!==g&&(e=g),""!==h&&(f=h),c!==u&&d.GC$(c).css({width:e,height:f}).addClass(B.aIc).addClass(B.HGc).attr(B.eHc,B.cHc).appendTo(j),this.UR(j,a,b),j},a.prototype.hga=function(){return!0},a.prototype.no=function(a){},a.prototype.Toa=function(){qa(this),Fa(this)},a.prototype.wxb=function(a){var b,c,d=this;return 1===a?x(d.width()):(b=Ta(d.startColumn(),d.startColumnOffset(),d.sheet(),!1),c=wa(d,!1,b+d[B.iGc]()),Sa(d.startColumn(),c.index,d.startColumnOffset(),c.offset,a,d.sheet(),!1))},a.prototype.xxb=function(a){var b,c,d=this;return 1===a?x(d.height()):(b=Ta(d.startRow(),d.startRowOffset(),d.sheet(),!0),c=wa(d,!0,b+d[B.jGc]()),Sa(d.startRow(),c.index,d.startRowOffset(),c.offset,a,d.sheet(),!0))},a}(),b.FloatingObject=$,_={content:n(B.$Hc,u,na(B.$Hc))},d.GC$.each(Z,function(a,b){_[b[0]]=n(b[0],b[1],b[2],b[3])}),d.GC$.extend($.prototype,_);function Ua(a,b,c){var e=a.$R,f,g,h,i;switch(b){case L:f=z(e[B.gIc]+e[B.iIc],c.x),g=z(e[B.hIc]+e[B.jIc],c.y),h=A(c.x-e[B.gIc]-e[B.iIc]),i=A(c.y-e[B.hIc]-e[B.jIc]);break;case M:f=e[B.gIc],g=z(e[B.hIc]+e[B.jIc],c.y),h=e[B.iIc],i=A(c.y-e[B.hIc]-e[B.jIc]);break;case N:f=z(e[B.gIc],c.x),g=z(e[B.hIc]+e[B.jIc],c.y),h=A(c.x-e[B.gIc]),i=A(c.y-e[B.hIc]-e[B.jIc]);break;case O:f=z(e[B.gIc]+e[B.iIc],c.x),g=e[B.hIc],h=A(c.x-e[B.gIc]-e[B.iIc]),i=e[B.jIc];break;case P:f=z(e[B.gIc],c.x),g=e[B.hIc],h=A(c.x-e[B.gIc]),i=e[B.jIc];break;case Q:f=z(e[B.gIc]+e[B.iIc],c.x),g=z(e[B.hIc],c.y),h=A(c.x-e[B.gIc]-e[B.iIc]),i=A(c.y-e[B.hIc]);break;case R:f=e[B.gIc],g=z(e[B.hIc],c.y),h=e[B.iIc],i=A(c.y-e[B.hIc]);break;case S:f=z(e[B.gIc],c.x),g=z(e[B.hIc],c.y),h=A(c.x-e[B.gIc]),i=A(c.y-e[B.hIc])}return new d.Rect(f,g,h,i)}function Va(a){var b=d.GC$(a),c=b.position();return new d.Rect(c.left,c.top,b[B.iGc](),b[B.jGc]())}function Wa(a,b,c,e,f,g){d.GC$(a).css([B.OLb,B.fGc,B.iGc,B.jGc],[[e-1],[c-1],f,g]).addClass(B.QHc).appendTo(b)}function Xa(a,b){if(!a._R)return u;var c={inMoving:!1};return b||(c.inMoving=!0),c}function Ya(a){var b,c,d,e,f,g=a,h=g.kj,i=g.WE,j=g.aS,k=h.frozenTrailingRowCount(),l=h.frozenTrailingColumnCount(),m=h.am(),n=m.Ft(i,j),o=g.YR,p=o[B.mHc](),q=o[B.oHc](),r=o[B.qHc](),s=o[B.sHc](),t=h.frozenRowCount(),u=h.frozenColumnCount(),v=h.getRowCount(3)-k-1,w=h.getColumnCount(3)-l-1;return i===B.fHc?(t>0&&(b=h.getViewportTopRow(i),(p<t||b===t)&&(n.y-=m.fs,n[B.jGc]+=m.fs)),k>0&&(c=h.getViewportBottomRow(i),r>v&&c===v&&(n[B.jGc]+=m.gs))):i===B.fHc-1?(b=h.getViewportTopRow(i+1),(r>=b||b===t)&&(f=m.Ft(i+1,j),n[B.jGc]+=f[B.jGc])):i===B.fHc+1&&(c=h.getViewportBottomRow(i-1),(p<=c||c===v)&&(f=m.Ft(i-1,j),n.y=f.y,n[B.jGc]+=f[B.jGc])),j===B.fHc?(u>0&&(d=h.getViewportLeftColumn(j),(q<u||d===u)&&(n.x-=m.hs,n[B.iGc]+=m.hs)),h.frozenTrailingColumnCount()>0&&(e=h.getViewportRightColumn(j),(s>w||e===w)&&(n[B.iGc]+=m.js))):j===B.fHc-1?(d=h.getViewportLeftColumn(j+1),(s>=d||d===u)&&(f=m.Ft(i,j+1),n[B.iGc]+=f[B.iGc])):j===B.fHc+1&&(e=h.getViewportRightColumn(j-1),(q<=e||e===w)&&(f=m.Ft(i,j-1),n.x=f.x,n[B.iGc]+=f[B.iGc])),n}function Za(a,b,c,e,f){var g=Va(a);d.GC$(a).css([B.OLb,B.fGc,B.iGc,B.jGc],[g.y+c,g.x+b,g[B.iGc]+e,g[B.jGc]+f])}function $a(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q=a;if(q.bS){b=q.$F,c=Ya(q),e=q.cS,f=q.$R,g=f.direction,h=void 0,b=new d.Point(b.x-c.x,b.y-c.y),h=Ua(q,g,b),f.endX=h.x,f.endY=h.y,f.endWidth=h[B.iGc],f.endHeight=h[B.jGc],i=Va(e),j=h.y-i.y,k=h.x-i.x,l=h[B.iGc]-i[B.iGc],m=h[B.jGc]-i[B.jGc],Za(e,k,j,l,m),n=q.dS;for(o in n)t(n,o)&&(p=n[o],Za(p.moveResizeDiv,k,j,l,m))}}function _a(a,b){var c,e=a.kj;e&&(c=e.RF(b),c===!1&&d.Ul.nl(b))}function ab(a){var b,c,d,e,f,g,h,i=a,j=i.kj,k=i.eS;if(k){if(b=q(j,k[B.mIc],j.getViewportTopRow(i.WE),!0),c=q(j,k[B.nIc],j.getViewportLeftColumn(i.aS),!1),d=k[B.kIc]-k[B.gIc]+(k[B.kIc]>k[B.gIc]?c:-1*c),e=k[B.lIc]-k[B.hIc]+(k[B.lIc]>k[B.hIc]?b:-1*b),0===d&&0===e)return;f=[],f.push(i.YR.name()),g=i.dS;for(h in g)t(g,h)&&f.push(h);j.wu().execute({cmd:"dragCopyFloatingObjects",sheetName:j.name(),floatingObjects:f,offsetX:d,offsetY:e})}}function bb(a){var b,c,d,e,f,g,h,i=a,j=i.kj,k=i.eS,l=j.zoom();if(k){b=q(j,k[B.mIc],j.getViewportTopRow(i.WE),!0),c=q(j,k[B.nIc],j.getViewportLeftColumn(i.aS),!1),d=k[B.kIc]-k[B.gIc]+(k[B.kIc]>k[B.gIc]?c:-1*c),e=k[B.lIc]-k[B.hIc]+(k[B.lIc]>k[B.hIc]?b:-1*b),d/=l,e/=l,f=[],f.push(i.YR.name()),g=i.dS;for(h in g)t(g,h)&&f.push(h);j.wu().execute({cmd:"moveFloatingObjects",sheetName:j.name(),floatingObjects:f,offsetX:d,offsetY:e})}}function cb(a){var b,c,d,e,f,g,h,i,j,k=a,l=k.kj,m=l.zoom(),n=k.YR,o=k.$R;if(o){b=q(l,o[B.mIc],l.getViewportTopRow(k.WE),!0),c=q(l,o[B.nIc],l.getViewportLeftColumn(k.aS),!1),d=o[B.kIc]-o[B.gIc]+(o[B.kIc]>o[B.gIc]?c:-1*c),d/=m,e=o[B.lIc]-o[B.hIc]+(o[B.lIc]>o[B.hIc]?b:-1*b),e/=m,f=(o.endWidth+c)/m-n[B.iGc](),g=(o.endHeight+b)/m-n[B.jGc](),h=[],h.push(n.name()),i=k.dS;for(j in i)t(i,j)&&h.push(j);l.wu().execute({cmd:"resizeFloatingObjects",sheetName:l.name(),floatingObjects:h,offsetX:d,offsetY:e,offsetWidth:f,offsetHeight:g})}}function db(a,b,c){var d,e,f,g,h,i=a,j=i.cS;if(j){d=c.x-b.x,e=c.y-b.y,eb(j,d,e),f=i.dS;for(g in f)t(f,g)&&(h=f[g],eb(h.moveResizeDiv,d,e))}}function eb(a,b,c){var e=d.GC$(a),f=d.GC$(a).position();e.css([B.OLb,B.fGc],[f[B.OLb]+c,f[B.fGc]+b])}function fb(a){var b,c,d,e,f,g,h,i,j,k,l,m=a,n=m.eS;n&&(b=m.YR,c=m.kj,d=c.am(),e=d[B.iGc]-d.Br-d.zr,f=d[B.jGc]-d.Cr-d.Ar,g=n.startX,h=n.startY,i=b.position().x,j=b.position().y,k=b[B.iGc](),l=b[B.jGc](),i+n.endX-g<0&&(n.endX=g-i),j+n.endY-h<0&&(n.endY=h-j),i+k+n.endX-g>e&&(n.endX=e+g-i-k),j+l+n.endY-h>f&&(n.endY=f+h-j-l),n.startTopRow=c.getViewportTopRow(m.WE),n.startLeftColumn=c.getViewportLeftColumn(m.aS))}function gb(a){var b,c,e,f,g,h=a,i=h.$R;i&&(b=h.kj,c=b.am(),e=c[B.iGc]-c.Br-c.zr,f=c[B.jGc]-c.Cr-c.Ar,g=new d.Rect(i.endX,i.endY,i.endWidth,i.endHeight),g=g.getIntersect(0,0,e,f),i.endX=g.x,i.endY=g.y,i.endWidth=g[B.iGc],i.endHeight=g[B.jGc],i.startTopRow=b.getViewportTopRow(h.WE),i.startLeftColumn=b.getViewportLeftColumn(h.aS))}function hb(a){var b,c,e,f,g,h,i,j,k=p(B.VKb),l=d.GC$(k),m=a;return l.addClass(B.OHc).addClass(B.IHc).attr(B.eHc,B.cHc).css(B.dHc,B.DHc).bind("mousedown",function(a){m.AD(a)}).bind(B.eIc,function(a){m.BD(a)}).bind(B.fIc,function(a){m.CD(a)}),k.addEventListener("mousewheel",function(a){_a(m,a)},!1),k.addEventListener("DOMMouseScroll",function(a){_a(m,a)},!1),b=d.GC$(p(B.VKb)).addClass(B.SHc+" "+B.UHc+" "+B.XHc+" "+B.THc),c=d.GC$(p(B.VKb)).addClass(B.SHc+" "+B.UHc+" "+B.YHc+" "+B.THc),e=d.GC$(p(B.VKb)).addClass(B.SHc+" "+B.UHc+" "+B.ZHc+" "+B.THc),f=d.GC$(p(B.VKb)).addClass(B.SHc+" "+B.VHc+" "+B.XHc+" "+B.THc),g=d.GC$(p(B.VKb)).addClass(B.SHc+" "+B.VHc+" "+B.ZHc+" "+B.THc),h=d.GC$(p(B.VKb)).addClass(B.SHc+" "+B.WHc+" "+B.XHc+" "+B.THc),i=d.GC$(p(B.VKb)).addClass(B.SHc+" "+B.WHc+" "+B.YHc+" "+B.THc),j=d.GC$(p(B.VKb)).addClass(B.SHc+" "+B.WHc+" "+B.ZHc+" "+B.THc),l.append(b).append(c).append(e).append(f).append(g).append(h).append(i).append(j),aa.ao(m,"init",k),k}function ib(a){var b,c,e,f,g,h,i,j,k=a,l=k.hS&&k._R;if(l&&!k.cS){b=k.iS=p(B.VKb),k.cS=p(B.VKb),k.dS={},k.gS.jS.each(function(a){var b,c=a.YR;c&&c.name()!==k.YR.name()&&c.isSelected()&&!k.dS[c.name()]&&(b=a._R,k.dS[c.name()]={offsetX:b.x-l.x,offsetY:b.y-l.y,height:b[B.jGc],width:b[B.iGc],moveResizeDiv:p(B.VKb)})}),c=Ya(k),e=d.GC$(b),e.css([B.dHc,B.OLb,B.fGc,B.iGc,B.jGc,B.HHc],[B.EHc,c.y,c.x,c[B.iGc],c[B.jGc],"rgba(255,255,255,0.01)"]).addClass(B.PHc).bind(B.eIc,function(a){k.BD(a)}).bind(B.fIc,function(a){k.CD(a)}),f=l.y-c.y,g=l.x-c.x,Wa(k.cS,b,g,f,l[B.iGc],l[B.jGc]),h=k.dS;for(i in h)t(h,i)&&(j=h[i],Wa(j.moveResizeDiv,k.iS,g+j.offsetX,f+j.offsetY,j[B.iGc],j[B.jGc]));k.Ks&&d.GC$(k.Ks).append(k.iS)}}function jb(a){var b=a;b.RB||(d.GC$(s).bind(B.eIc+B.iHc,function(a){b.BD(a)}).bind(B.fIc+B.iHc,function(a){b.CD(a)}),b.RB=!0)}function kb(a){var b=a;b.RB&&(b.RB=!1,d.GC$(s).unbind(B.eIc+B.iHc).unbind(B.fIc+B.iHc))}function lb(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=d.GC$(B.RHc,b);t.removeClass(B.MHc),c=a,e=Va(c.hS),f=c.kS,g=c.YR,c.lS&&(f=c.lS),h=aa.mS,i=Va(f),j=i.x,k=i.y,l=e[B.jGc]-i.y-i[B.jGc],m=e[B.iGc]-i.x-i[B.iGc],n=0,o=h+2,p=x(h/2+1),"1"===g.typeName&&(q=g.borderWidth(),r=g.borderStyle(),Ga(r)||(q=0),q>=p&&(n=q-p),l=e[B.jGc]-k-i[B.jGc]-q,m=e[B.iGc]-j-i[B.iGc]-q,j+=q,k+=q),s=[],j>0?(mb(c,k>0,D,n,n,v,v,"nw"+B.VGc,L,s),mb(c,e[B.jGc]>0,E,n,(i[B.jGc]-o)/2+k,v,v,"w"+B.VGc,O,s),mb(c,l>0,F,n,v,v,n,"ne"+B.VGc,Q,s)):(nb(c,D),nb(c,E),nb(c,F)),mb(c,k>0,G,(i[B.iGc]-o)/2+j,n,v,v,"n"+B.VGc,M,s),mb(c,l>0,H,(i[B.iGc]-o)/2+j,v,v,n,"n"+B.VGc,R,s),m>0?(mb(c,k>0,I,v,n,n,v,"sw"+B.VGc,N,s),mb(c,e[B.jGc]>0,J,v,(i[B.jGc]-o)/2+k,n,v,"w"+B.VGc,P,s),mb(c,l>0,K,v,v,n,n,"se"+B.VGc,S,s)):(nb(c,I),nb(c,J),nb(c,K)),c.ZR=!0,c.pmb=s}function mb(a,b,c,e,f,g,h,i,j,k){var m,n,o,p,q=a,r=d.GC$(c,q.hS),s=aa.mS;b?r.css([B.fGc,B.OLb,B.gGc,B.hGc,B.iGc,B.jGc,B.DGc],[e,f,g,h,s,s,i]).addClass(B.LHc).attr("resizeDirection",j):nb(q,c),k&&(m=d.GC$(q.hS),n=0,o=0,l(e)||(n=e),l(f)||(o=f),l(g)||(n=m.width()-g-s),l(h)||(o=m.height()-h-s),p=new d.Rect(n,o,s,s),k.push({rect:p,cursor:i,direction:j}))}function nb(a,b){d.GC$(b,a.hS).removeClass(B.LHc).addClass(B.MHc)}function ob(a,b){d.GC$(B.RHc,b).removeClass(B.LHc).addClass(B.MHc),a.ZR=!1}function pb(a){var b,c,e,f,g,h,i,j,k,l,m,n=a,o=n.YR,p=o.qmb||o.src(),q=o.pictureStretch(),r=d.Rm.Om(o.sheet(),o.backColor()),s=n.kS;p&&s&&(b=d.GC$(s),n.XR!==p&&(n.XR=p,b.css([B.HHc+"-image",B.HHc+"-repeat"],["url('"+p+"')","no-repeat"])),b.css(B.HHc+"-color",r),q!==u&&q!==v&&o.oS&&(c=o.getOriginalWidth(),e=o.getOriginalHeight(),f=b[B.iGc](),g=b[B.jGc](),h=o.rmb,i=void 0,h&&(j=f/h.width,k=g/h.height,l=j*h.left,m=k*h.top,i={position:-l+"px "+-m+"px",size:j+"px "+k+"px"}),d.Ul.ql(s,f,g,c,e,q,i)))}function qb(a,b,c){var e,f,g,h,i=a.lS,j=a.YR,k=j.borderWidth(),l=j.borderStyle(),m=d.Rm.Om(j.sheet(),j.borderColor()),n=j.borderRadius(),o=0,p=x(aa.mS/2+1);Ga(l)&&!j.noFill()||(k=0),k<p&&(o=p-k),e=o,f=o,g=o,h=o,p=y(k,p),b.x<0?e+=b.x-p:(e+=b.x<p?b.x-p:0,h=c[B.iGc]-e-b[B.iGc]-2-2*k),b.y<0?f+=b.y-p:(f+=b.y<p?b.y-p:0,g=c[B.jGc]-f-b[B.jGc]-2-2*k),d.GC$(i).css([B.FHc,B.fGc,B.OLb,B.hGc,B.gGc,B.JLb+"-width",B.JLb+"-style",B.JLb+"-color",B.JLb+"-radius"],[B.GHc,e,f,g,h,k,l,m,n])}aa=function(){function a(a,b){this.XR="";var c=this;c.YR=a,c.name=a?a.name():"",c.kj=b,c.RB=!1,c.ZR=!1}return a.prototype.gV=function(a){var b,c,e,f,g,h,i=d.GC$(a.target).attr("resizeDirection");if(i)return i;if(b=d.GC$(this.hS).offset(),c=a.pageX-b.left,e=a.pageY-b.top,f=this.pmb)for(g=0;g<f.length;g++)if(h=f[g],h.rect.contains(c,e))return h.direction},a.prototype.smb=function(a){var b,c,e,f,g,h,i=a.target,j=d.GC$(i).attr("resizeDirection");if(j)return i.style.cursor;if(b=d.GC$(this.hS).offset(),c=a.pageX-b.left,e=a.pageY-b.top,f=this.pmb)for(g=0;g<f.length;g++)if(h=f[g],h.rect.contains(c,e))return h.cursor},a.prototype.AD=function(b){var c,e,f,g,h,i,j,k,l,m,n,o=this,p=o.kj,q=o.YR,r=p.ITa.Ky,s=o.WE,t=o.aS;if(p.ER(q)&&p.endEdit()&&(p.zt(!0),c={e:b,r:u},a.ao(o,"preProcessMouseDown",c),!c.r)){if(0===b.button||2===b.button){if(e=q.isSelected(),b.ctrlKey||b.shiftKey?q.isSelected(!e):e||(p.uQ(),q.isSelected(!0)),e||d.Vl.Zl(p),r&&r.vQ(),p.EJ(),p.hm&&p.hm(),2===b.button)return;if(f=p.mm,g=p.Vs(),h=o.gV(b),i=new d.Point(b.pageX-g.left,b.pageY-g.top),j=Xa(o,h),!q.allowMove()&&(!q.allowResize()||j.inMoving))return;o.$F=i,o.pS=!0,o.bS=j,j.inMoving?(k={},k.startTopRow=p.getViewportTopRow(s),k.startLeftColumn=p.getViewportLeftColumn(t),k.startX=i.x,k.startY=i.y,o.eS=k):(ib(o),l={},m=Va(o.cS),l.startX=m.x,l.startY=m.y,l.startWidth=m[B.iGc],l.startHeight=m[B.jGc],l.startTopRow=p.getViewportTopRow(s),l.startLeftColumn=p.getViewportLeftColumn(t),l.cursor=o.smb(b),l.direction=h,o.$R=l),jb(o),n=p.hitTest(i.x,i.y),f.rG={KG:n.rowViewportIndex,MG:n.colViewportIndex,sG:n.hitTestType},f.$F=i,f.qG(),f.O3=!0,p.Wq(d.Events.FloatingElementSelected,{type:"floatingObject"})}return!1}},a.prototype.BD=function(b){var c,e,f,g,h,i,j,k,l=this,m=l.kj,n=l.hS,o=l.iS;if(m.ER(l.YR))return c={e:b,r:u},a.ao(l,"preProcessMouseMove",c),c.r?(e=c.cursor,void(e&&d.GC$(n).css(B.DGc,e))):(f=l.YR,g=f.isLocked()&&m.options.isProtected,d.GC$(n).css(B.DGc,g||!f.allowMove()?"default":B.dGc),m.dG?(n&&d.GC$(n).css(B.DGc,"default"),!0):(h=m.mm,i=m.Vs(),j=new d.Point(b.pageX-i.left,b.pageY-i.top),l.pS?(l.bS.inMoving?(l.qS=!0,ib(l),db(l,l.$F,j),d.GC$(o).css(B.DGc,B.dGc)):l.YR.allowResize()&&(l.kv=!0,$a(l),d.GC$(o).css(B.DGc,l.$R[B.DGc])),(l.qS||l.kv)&&(l.$F=j,h.$F=j,h.NG(),d.GC$(s.body).addClass(B.IHc).attr(B.eHc,B.cHc))):(k=m.parent,
      64 | k.options.enableAccessibility&&k.dgc(f.alt())),!1))},a.prototype.CD=function(b){var c,e,f,g,h,i=this,j=i.kj,k=j.mm,l=i.YR,m=i.hS,n=i.bS;if(j.ER(l)&&(c={e:b,r:u},a.ao(i,"preProcessMouseUp",c),!c.r))return j.dG?(d.GC$(m).css(B.DGc,B.dGc),!0):(k.O3=!1,k.RG(),e=j.Vs(),f=new d.Point(b.pageX-e.left,b.pageY-e.top),g=i.eS,g&&(g.endX=f.x,g.endY=f.y),n&&(h=l.fixedPosition(),n.inMoving&&i.qS?(h&&fb(i),b.ctrlKey?ab(i):bb(i)):i.kv&&(h&&gb(i),cb(i)),d.GC$(s.body).removeClass(B.IHc)),i.rS(),!1)},a.prototype.rS=function(){var a=this;a.$R=u,a.eS=u,a.dS=u,d.GC$(a.iS).remove(),a.cS=u,a.pS=!1,kb(a),a.qS=!1,a.kv=!1},a.prototype.yl=function(a,b){var c,e,f,g,h,i,j,k=this,l=k.YR,m=k.kj;if(l){if(c=!1,k.sS=a,e=k.hS,!e){if(a.width<=0||a.height<=0)return;e=k.hS=hb(k),xa(l,e),f=m.parent,f&&(g=k.Ks=f.xv(),g&&d.GC$(g).append(e))}h=k.kS,h||(h=k.kS=l.WR(k.WE,k.aS),"1"===l.typeName?(k.lS=p(B.VKb),d.GC$(k.lS).addClass(B.IHc+" "+B.NHc).attr(B.eHc,B.cHc),e.appendChild(k.lS),k.lS.appendChild(h)):(e.appendChild(h),c=!0)),k.lS&&(qb(k,b,a),b.x=0,b.y=0),i=d.GC$(h),d.GC$(e).css([B.OLb,B.fGc,B.iGc,B.jGc],[a.y,a.x,a[B.iGc],a[B.jGc]]),i.css([B.OLb,B.fGc,B.iGc,B.jGc],[b.y,b.x,b[B.iGc],b[B.jGc]]),k.Tka=a,l.refreshContent&&l.refreshContent(h),k.lS&&pb(k),l.isSelected()?(i.removeClass(B.KHc).addClass(B.JHc),l.allowResize()?lb(k,e):k.ZR&&ob(k,e)):(i.removeClass(B.JHc).addClass(B.KHc),ob(k,e)),c&&(j=h.firstChild,m.Wq(d.Events.FloatingObjectLoaded,{sheet:m,sheetName:m.name(),floatingObject:l,element:j}))}},a.prototype.no=function(){var b=this,c=b.YR,e=b.hS,f=b.iS,g=b.kS;a.ao(b,"dispose"),g&&c.VR&&(c.VR(g),c.no(!1)),e&&(d.GC$(e).remove(),b.hS=u),f&&(d.GC$(f).remove(),b.iS=u)},a.mS=7,a}(),b.FloatingObjectRender=aa,d.Zn(aa);function rb(a){a.zR().forEach(function(a){a.dynamicMove()?qa(a):ua(a),a.dynamicSize()?Fa(a):va(a)})}function sb(a,b,c){var e,f,g,h,i,j,k,l=a.kj,m=l.it(c),n=0,o=0,p=0,q=0;return m&&m.length>0&&(e=m[0],f=m[m.length-1],n=e.x,p=f.x+f[B.iGc]-n),g=l.jt(b),g&&g.length>0&&(h=g[0],i=g[g.length-1],o=h.y,q=i.y+i[B.jGc]-o),j=l.am(),k=j.Ft(b,c),k.getIntersect(n,o,p,q)||new d.Rect(0,0,0,0)}function tb(a,b,c,d){var e,f,g,h,i,j,k,l,m=a,n=m.kj,o=new r,p=n.wr;return p.isNeedToUpdateLayout&&(rb(p),p.isNeedToUpdateLayout=!1),e=n.am(),f=n.ss,g=n.it(c),h=n.jt(b),g.length<=0||h.length<=0?o:(i=g[0],j=g[g.length-1],k=h[0],l=h[h.length-1],p.zR().forEach(function(a){var b,c,m,p,q,r,s,t,u,v,w,x,y,z,A;if(a&&a.isVisible()){if(b=void 0,c=void 0,m=a[B.mHc](),p=a[B.oHc](),q=a[B.qHc](),r=a[B.sHc](),a.fixedPosition())s=a.position(),b=s.x*d+e.kt,c=s.y*d+e.nt;else{if(t=g.findCol(p))b=t.x;else if(p<i.col)for(b=i.x,u=i.col-1;u>=p;u--)b-=f._m(u);else for(b=j.x+j[B.iGc],v=j.col+1;v<=p;v++)b+=f._m(v);if(b+=a[B.pHc]()*d,w=h.findRow(m))c=w.y;else if(m<k.row)for(c=k.y,x=k.row-1;x>=m;x--)c-=f.Sl(x);else for(c=l.y+l[B.jGc],y=l.row+1;y<=m;y++)c+=f.Sl(y);c+=a[B.nHc]()*d}z=void 0,A=void 0,z=a.wxb(d),A=a.xxb(d),ub(n,m,p,q,r)||o.push({name:a.name(),x:b,y:c,width:z,height:A})}}),o)}function ub(a,b,c,d,e){var f,g,h;if(a.rowOutlines)for(f=!0,h=b;h<=d;h++)if(!a.rowOutlines.isCollapsed(h)){f=!1;break}if(a.columnOutlines)for(g=!0,h=c;h<=e;h++)if(!a.columnOutlines.isCollapsed(h)){g=!1;break}return f||g}ba=function(){function a(a){this.kj=a,this.jS=new r}return a.prototype.no=function(){var a=this.jS;a.each(function(a){a.no()}),a.empty(),this.kj=u},a.prototype.yl=function(a,b,c){var e,f,g,h,i,j,k,l,m,n;if(!(a<0||b<0)){for(e=this,f=e.kj,g=e.jS,h=f.wr,i=tb(e,a,b,c),j=[],g.each(function(a){i.find(a.name)||j.push(a)}),l=j.length,k=0;k<l;k++)m=j[k],m.gS=u,g.remove(m.name),m.no();n=f.parent&&f.parent.options.useTouchLayout,aa.mS=n?11:7,i.each(function(c){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,z,A,C=h.NR(c.name),D=x(aa.mS/2+1);C&&"1"===C.typeName&&(i=C.borderWidth(),j=C.borderStyle(),Ga(j)||(i=0),i>D&&(D=i)),k=sb(e,a,b),l=1,m=c.x-D-l,n=c.y-D-l,o=c[B.iGc]+2*D+2*l,p=c[B.jGc]+2*D+2*l,q=y(k.y,n),r=y(k.x,m),s=p,t=o,u=D,v=D,w=-1*D-l,u=n-q+u,v=m-r+v,u<=0?(s+=u,s+=w):u<D&&u>0&&(s-=D-u),v<=0?(t+=v,t+=w):v<D&&v>0&&(t-=D-v),z=g.find(c.name),z||(z=new aa(h.NR(c.name),f),z.gS=e,g.push(z)),z._R=c,z.WE=a,z.aS=b,A=new d.Rect(k.x,k.y,k[B.iGc],k[B.jGc]),z.yl(new d.Rect(r,q,t,s).getIntersectRect(A)||new d.Rect(r,q,0,0),new d.Rect(v,u,c[B.iGc],c[B.jGc]))})}},a}(),ca={init:function(){var a=this,b=a.$oa=[];a.Zoa=function(a){b.forEach(function(b){b.Wva&&b.Wva(a)})},a.wr=a.ITa.wr,a.pictures=new U(a,"1"),a.floatingObjects=new U(a,"0")},dispose:function(a){var b=this;fa(b,a.clearCache),b.wr&&d.GC$.each(b.wr.zR(),function(b,c){c.no(a.clearCache)}),a.clearCache!==!1&&(b.pictures&&(b.pictures.no(),b.pictures=u),b.floatingObjects&&(b.floatingObjects.no(),b.floatingObjects=u),b.QP=u,b.Zoa=u,b.IR=u),b.unbind(d.Events.TableFiltered+B.bIc),b.unbind(d.Events.RangeFiltered+B.bIc),b.unbind(d.Events.FloatingElementSelected+B.bIc)},setHost:function(a){if(a){var b=this;b.bind(d.Events.TableFiltered+B.bIc,function(){b.AR()}),b.bind(d.Events.RangeFiltered+B.bIc,function(){b.AR()}),b.bind(d.Events.FloatingElementSelected+B.bIc,function(a,c){"floatingObject"!==c.type&&b.uQ()})}},onLayoutChanged:function(a){var b=a.changeType,c=a.row,d=a.rowCount,e=a.col,f=a.colCount,g=this.wr;"addRows"===b?ga(g,c,d):"deleteRows"===b?ha(g,c,d):"addColumns"===b?ia(g,e,f):"deleteColumns"===b&&ja(g,e,f)},paint:function(a){var b=this,c=a.clipRect;b.QP(c)},lastNonNullRowAndCol:function(){var a=0,b=0,c=this.wr;return c&&c.zR().forEach(function(c){c&&(c[B.qHc]()>a&&(a=c[B.qHc]()),c[B.sHc]()>b&&(b=c[B.sHc]()))}),{lastNonNullRow:a,lastNonNullCol:b}},toJson:function(a,b){var c,d=b&&b.ignoreStyle;d||(c=this.wr.toJSON(),c.length>0&&(a.floatingObjects=c))},fromJson:function(a,b,c){var d,e,f,g=c&&c.ignoreStyle;g||(d=this,d.wr=new V(d),d.ITa.wr=d.wr,e=a&&a.floatingObjectArray,f=b?e&&e.floatingObjects:a.floatingObjects,f&&d.wr.fromJSON(f,b))},preProcessMouseDown:function(a){var b,c,d=a.e,e=this.Vs(),f=d.pageX-e.left,g=d.pageY-e.top;!this.Cw&&this.Cva&&(b=this.hitTest(f,g),c=b&&b.formulaRangeHitInfo,c&&(c.inBorder||c.inTopLeft||c.inTopRight||c.inBottomLeft||c.inBottomRight))||this.uQ()},processKeyDown:function(a){var b,c,d,e,f=this.wr;if(f)for(b=f.zR(),c=void 0,d=b.length,c=0;c<d;c++)if(e=b[c],e.isSelected())return void(a.r=!0)},onGroupChanged:function(a){this.floatingObjects.tTa(a.start,a.end,a.isRow),this.pictures.tTa(a.start,a.end,a.isRow)}},d.Worksheet.$n(B.hHc,ca),da={init:function(){d.Commands.JR(this.commandManager())},onCommandExecuting:function(a){var b=a.wr.zR();b.forEach(function(a){a.isSelected(!1)})},onCultureChanged:function(){i()}},d.Workbook.$n(B.hHc,da),d.GC$.extend(d.lUa.prototype,{BUa:function(a,b,c){var d,e=this.zTa;e&&(d=e.CUa,d||(d=e.CUa=[]),d.push({type:"property",floatingObject:a,name:b,value:c}))},AUa:function(){var a,b,c,e=this.zTa;e&&(a=e.CUa,a||(a=e.CUa=[]),b={},c=this.wr,d.GC$.each(c.QR,function(a,c){b[a]=c}),a.push({type:"collection",floatingObjects:b}))},DUa:function(a){var b,c,d,e,f,g,h;if(a)for(b=this.wr,c=a.length-1;c>=0;c--)d=a[c],"collection"===d.type?b.QR=d.floatingObjects:"property"===d.type&&(e=["startRow","startRowOffset","startColumn","startColumnOffset","endRow","endRowOffset","endColumn","endColumnOffset"],f=d.floatingObject,g=d.name,h=d.value,f[g](h),e.indexOf(g)>=0&&(qa(f),Fa(f),f.sheet().$p()))}}),d.lUa.$n(B.hHc,{init:function(){this.wr=new V(this.kj)},undo:function(a){var b=a.CUa;b&&this.DUa(b)},dispose:function(a){var b=this,c=a&&a.clearCache;c!==!1&&b.wr&&(b.wr.no(),b.wr=u)}})},"./dist/plugins/floatingObject/floatingobject.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/floatingObject/floatingobject.res.en.js");b.SR={en:d}},"./dist/plugins/floatingObject/floatingobject.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_FloatingObjectHasSameNameError="The current worksheet already has a floating object with the same name.",b.Exp_FloatingObjectNameEmptyError="Floating object must have name"},"./dist/plugins/floatingObject/picture.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("./dist/plugins/floatingObject/floatingobject.js"),f=d.Ul.Nl,g=d.Ul.Pl,h=d.GC$,i=null,j=void 0,k="src",l="backColor",m="pictureStretch",n="borderRadius",o="borderWidth",p="borderStyle",q="borderColor",r="noFill",s=[k,l,n,o,p,r,q,m];function x(a){return"number"==typeof a&&!isNaN(a)}e.FloatingObject.ozb=function(a,b,c,d,e,f){return new t(a,b,c,d,e,f)},t=function(a){w(b,a);function b(b,c,d,e,f,g){var h=a.call(this,b,d,e,f,g)||this,j=h;return j.typeName="1",j.g3="1",j.bt=i,j.oS=!1,j.JS=!1,"string"==typeof c&&(j.JS=!(x(f)&&x(g)),j.src(c)),h}return b.prototype.onPropertyChanged=function(a,b,c){var d,e=this;e.TR||(d=e.sheet(),d&&(d.ITa.BUa(e,a,c),this.Wq({sheet:d,sheetName:d.name(),picture:e,propertyName:a})))},b.prototype.toJSON=function(){var b,c,d,f=this,g=a.prototype.toJSON.call(this);return e.toJsonFn.call(f,s,g),g.originalWidth=f.getOriginalWidth(),g.originalHeight=f.getOriginalHeight(),f.tmb&&(g.rot=f.tmb),b=f.rmb,b&&(c=b.left,d=b.top,g.srcRect={l:c,t:d,r:1-c-b.width,b:1-d-b.height}),delete g.content,g},b.prototype.fromJSON=function(b,c,d){var f,g,h,i,k;b&&(f=this,f.TR=!0,d&&(g=x(b.x)&&x(b.y)&&x(b.width)&&x(b.height),g&&(b.endRow=null,b.endRowOffset=null,b.endColumn=null,b.endColumnOffset=null)),a.prototype.fromJSON.call(this,b,c),e.fromJsonFn.call(f,s,b,c),b.rot&&(f.tmb=b.rot),f.oS=!1,h=b.srcRect,h&&(i=h.l,k=h.t,f.rmb={left:i,top:k,width:1-i-h.r,height:1-k-h.b}),y(f),f.TR=j)},b.prototype.clone=function(){var a=new b,c=JSON.stringify(this.toJSON());return a.fromJSON(JSON.parse(c)),a},b.prototype.getOriginalWidth=function(){return this.KS},b.prototype.getOriginalHeight=function(){return this.LS},b.prototype.nS=function(a){var b=["dotted","dashed","solid","double","groove","ridge","inset","outset"];return b.indexOf(a)>=0},b.prototype.WR=function(a,b){var c=f("div");return h(c).addClass("gc-floatingobject-content-container").addClass("gc-no-user-select").attr("unselectable","on").css("position","absolute"),this.UR(c,a,b),c},b.prototype.Wq=function(a){var b,c=this.sheet();c&&(c.Wq(d.Events.PictureChanged,a),"isSelected"===a.propertyName&&(b={sheet:a.sheet,sheetName:a.sheetName,picture:a.picture},c.Wq(d.Events.PictureSelectionChanged,b)))},b.prototype.no=function(a){var b=this;b.bt&&a!==!1&&(b.bt.no(),b.bt=i)},b}(e.FloatingObject),b.Picture=t;function y(a){var b,c,e=a,f=e.src(),g=e.sheet();e.bt||(e.bt=new d.oo(function(){y(e)})),b=e.bt;try{b.ko(f)?(e.oS=!0,c=b.lo(f),e.KS=c.width,e.LS=c.height,e.tmb&&e.tmb%90===0&&(e.qmb=z(c,c.width,c.height,e.tmb)),e.JS&&(e.width(c.width,!0),e.height(c.height,!0),e.JS=!1),e.Wq({sheet:g,sheetName:g.name(),picture:e,propertyName:"originalSize"}),e.isVisible()&&g&&g.repaint()):b.fo(f)}catch(a){}}function z(a,b,c,d){var e,f,g=b,h=c;return 90!==d&&270!==d||(g=c,h=b),e=document.createElement("canvas"),e.width=g,e.height=h,f=e.getContext("2d"),f.translate(g/2,h/2),f.rotate(d/180*Math.PI),f.translate(-g/2,-h/2),f.drawImage(a,0,0,b,c,(g-b)/2,(h-c)/2,b,c),f.setTransform(1,0,0,1,0,0),e.toDataURL()}u=[[k,j,function(a,b){var c=this;c.oS=!1,y(c),c.srccallback||(c.srccallback=e.propertyRefreshCallback(k)),c.srccallback.call(c,a,b)}],[l,i,e.propertyRefreshCallback(l)],[n,-1,e.propertyRefreshCallback(n),x],[o,1,e.propertyRefreshCallback(o),x],[p,"none",function(a,b){var c=this;c.nS(a)||c.borderWidth(0),c.bscallback||(c.bscallback=e.propertyRefreshCallback(p)),c.bscallback.call(c,a,b)}],[r,j],[q,i,e.propertyRefreshCallback(q)],[m,0,e.propertyRefreshCallback(m)]],v=t.prototype,h.each(u,function(a,b){v[b[0]]=g(b[0],b[1],b[2],b[3])})},"./dist/plugins/formulaTextbox/formulaTextBox.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/formulaTextbox/formulatextbox.js")),d(c("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js")),c("./dist/plugins/formulaTextbox/formulatextbox-event.js"),c("./dist/plugins/formulaTextbox/formulatextbox-actions.js"),c("./dist/plugins/formulaTextbox/formulatextbox-render.js")},"./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js":function(a,b,c){"use strict";var d,e,f,g,h;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("./dist/plugins/formulaTextbox/formulatextbox.js"),f=null;function i(a){var b=d.Ul.Nl("textarea"),c=d.GC$(b);return c.css({display:"none"}),d.GC$(a).append(b),b}b.W4=i,g=function(){function a(){var a=this;a.nT=-1,a.Mk=-1,a._text="",a.Q2=-1,a.kj=null,a.MH=!1,a.R2=-1,a.I0=null,a.OC=null,a.f1=null}return a.prototype.$b=function(){var a=this;a.S2(),a.nT=-1,a.Mk=-1,a._text="",a.Q2=-1,a.MH=!1,a.R2=-1,a.kj=null,a.OC=null,a.f1=null},a.prototype.S2=function(){var a,b,c=this;c.kj.Js||(a=c.kj.getCellType(c.nT,c.Mk),b={sheet:c.kj,row:c.nT,col:c.Mk,sheetArea:3},c.I0&&c.I0.firstChild&&a.deactivateEditor(c.I0.firstChild.firstChild,b)),d.GC$(c.I0).remove(),c.I0=null},a.prototype.T2=function(a){var b=this,c=a.Cw;c&&(b._text=c.text(),b.nT=a.getActiveRowIndex(),b.Mk=a.getActiveColumnIndex(),b.Q2=c.caret(),b.MH=c.MH,b.R2=c.C1(),b.V4=c.V4,b.C5=c.C5,b.Nfa=c.Nfa,b.kj=a,b.OC=a.parent,b.f1=a.mm.bG())},a.prototype.VF=function(a){var b=this;a.Cw&&(b._text=a.Cw.text(),b.Q2=a.Cw.caret(),b.MH=a.Cw.MH,b.R2=a.Cw.C1())},a.prototype.U2=function(a){var b=this,c=a.Cw;c&&(c.V4=b.V4,c.C5=b.C5,c.Nfa=b.Nfa,c.text(b._text),c.caret(b.Q2),b.MH&&(c.B1(),c.C1(b.R2)))},a.prototype.V2=function(a){var b,c=a.oldSheet,d=this,e=c&&c.Cw;if(e)if(e.close(),(!d.kj||d.kj.Js)&&e.M0()||d.C5!==e.C5){d.T2(c),b=c.getValue(c.Jl,c.Kl,3),c.suspendEvent();try{if(!c.endEdit(!0))return}finally{c.resumeEvent()}c.setValue(c.Jl,c.Kl,b,3,!0),c.Px=1,a.needTriggerSheetChange=!1}else d._text&&(d.VF(c),e.destroy(),c.Cw=f,a.needTriggerSheetChange=!1)},a.prototype.W2=function(a){var b,c=a.oldSheet,d=a.newSheet,f=this;d.Js||(f.I0&&""===f._text&&(c.GJ(),f.$b()),f._text&&f.kj===d?(d.Px=0,d.zt(),d.suspendEvent(),f.V4?(b=i(d.parent.qo),e.J0(d,b),d.Px=2,d.yl.uH()):d.startEdit(!1),d.resumeEvent(),f.U2(d),f.VK(d,f.nT,f.Mk),c.GJ(),f.$b()):f._text&&!f.I0?(d.Px=1,c.Px=1,f.X2(d),d.EJ()):f._text&&f.kj!==d&&(d.Px=1,c.Px=1,f.X2(d),c.GJ(),d.EJ()))},a.prototype.X2=function(a){var b,c,g,h,i,j,k,l,m,n=this,o=n.kj;o.Js||(b=n.nT,c=n.Mk,g=o.getCellType(b,c),h={sheet:o,row:b,col:c,sheetArea:3,canvasOffset:this.f1},i=g.isImeAware(h),i&&(a.Px=1,j=g.a5(h),n.I0&&n.S2(),n.I0=j,d.GC$(j).css("position","absolute"),k=o.getCellRect(b,c),d.GC$(j).attr("id","across"),l=o.getActualStyle(b,c),g.d5(j,l,k,h),m=n.OC&&n.OC.getHost()||document.body,m.insertBefore(j,f),n.V4&&d.GC$(j).css({display:"none"}),e.J0(a,g.getEditingElement(),!0),j.firstChild&&!n.V4&&g.focus(j.firstChild.firstChild),n.U2(a),g.g5(j,l,k,h)))},a.prototype.VK=function(a,b,c){var d,e=a.getCellType(b,c),f=a.BF,g=a.am(),h=a.getActualStyle(b,c),i=a.getCellRect(b,c);i&&i.width>0&&i.height>0&&i.x>=g.kt&&i.y>=g.nt&&i.x+i.width<=g.lt+g.js&&i.y+i.height<=g.ot+g.gs&&(d={sheet:a,row:b,col:c,sheetArea:3},f&&f.parentNode&&e.g5(f.parentNode.parentNode,h,i,d))},a}(),h=function(){function a(){}return a.Q0=function(b,c){a.H0||(a.H0=new g),a.H0.V2(c)},a.R0=function(b,c){a.H0||(a.H0=new g),a.H0.W2(c)},a}(),b.G0=h},"./dist/plugins/formulaTextbox/formulatextbox-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/formulaTextbox/formulatextbox.js"),g=c("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),h=void 0,i=e.Common.j.Fa;function k(a){var b,c=a.Cw,d=a.mm;return b=c.MH?d.E2:d.E2={anchorRow:a.Jl,anchorCol:a.Kl,leadingRow:a.Qr,leadingCol:a.Rr}}function l(a,b,c,e,g){var h,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=a.Cw,F=a.parent,G=F&&F.options;if(E&&E.M0()&&G&&G.allowUserEditFormula&&G.enableFormulaTextbox){switch(h=k(a),j=h.anchorRow,l=h.anchorCol,m=h.leadingRow,n=h.leadingCol,i(e)&&(e=j),i(g)&&(g=l),o=a.mm,b){case 3:t=a.iy(e,g,c,m);break;case 4:t=a.hy(e,g,c,m);break;case 1:t=a.HJ(e,g,c,n);break;case 2:t=a.LJ(e,g,c,n);break;case 5:t=a.OJ();break;case 6:t=a.NJ()}t&&(p=t.row,q=t.col,r=t.leadingCellRow?t.leadingCellRow:p,s=t.leadingCellCol?t.leadingCellCol:q,a.IJ(p,q)&&(h.anchorRow=p,h.anchorCol=q,h.leadingRow=r,h.leadingCol=s,u=a.pivotTables&&a.pivotTables.findPivotTable(r,s),v=E.shift,w=E.ctrl,x=u&&u.getPivotInfoImp(r,s,!1,!0),y=x&&x.area,!E.Nfa&&u&&x&&4===y?(E.uMc=new d.Range(r,s,1,1),z=x.valueFieldName,A=x.rowInfos,B=x.colInfos,(A||B)&&(C=a.mm.vMc(y,z,A,B,u.position()),C&&(E.v1(C,v,!w,!0),E.OG=!1))):(delete E.uMc,D=f.C2(o.kj,d.kf(p,q,1,1)),D&&E.v1(D,!1,!0)),p>=0&&q>=0&&a.Yq(p,q)))}}function m(a,b){if(a){if(2===a.Px)return!1;var c=a.Cw;return c&&c.M0()?(l(a,b,!1),!0):(c&&(a=j.O2(a)),a.yx(b,!1),!0)}return!1}function n(a,b,c,d){if(a){if(2===a.Px)return!1;var e=a.Cw;return e&&e.M0()?(l(a,b,!1,c,d),!0):(e&&(a=j.O2(a)),a.yx(b,!1,c,d),!0)}return!1}function o(a,b,c){var e,g,h,i,j,l,m,n,o=a.Cw,p=a.parent,q=p&&p.options;o&&o.M0()&&q&&q.allowUserEditFormula&&q.enableFormulaTextbox&&(e=a.mm,g=k(a),h=g.anchorRow,i=g.anchorCol,o.MH?(l=o.m1(),j=f.L0(a,l.text)):j=d.kf(h,i,1,1),j&&(m=a.UJ(j,b,c,h,i),n=f.C2(e.kj,m),n&&o.v1(n,!0,!1)))}function p(a,b,c){if(a){if(2===a.Px)return!1;var d=a.Cw;return d&&d.M0()?(o(a,b,c),!0):(d&&(a=j.O2(a)),!!a.endEdit()&&(a.Sx(b,c),!0))}return!1}d.Commands.Ox=m,d.Commands.Qx=n,d.Commands.Rx=p,j=function(){function a(){}return a.fv=function(b){return a.O2(b)},a.Xx=function(b){return a.O2(b)},a.Yx=function(b){return a.O2(b)},a.O2=function(b){var c=b,d=g.G0.H0;return d&&d._text&&(c=d.kj,a.G2(c)),c},a.G2=function(a,b){var c,d;void 0===b&&(b=!0),c=a.parent,d=g.G0.H0,d&&d._text&&c.hw(a,b)},a.Zx=function(b,c,e){var g,h,i=!1,j=b.Cw;return j&&j.M0()?(g=k(b),g.anchorRow=c,g.leadingRow=c,h=f.C2(b,d.kf(g.anchorRow,g.anchorCol,1,1)),h&&j.v1(h,!1,!0),b.mq(e),i=!0):j&&(b=a.O2(b)),{sheet:b,r:i}},a._x=function(b,c,e){var g,h,i=!1,j=b.Cw;return j&&j.M0()?(g=k(b),g.anchorRow=c,g.leadingRow=c,h=f.C2(b,d.kf(g.anchorRow,g.anchorCol,1,1)),h&&j.v1(h,!1,!0),b.mq(e),i=!0):j&&(b=a.O2(b)),{sheet:b,r:i}},a.pzb=function(b,c){var d=!1,e=c?5:6,f=b.Cw,g=b.Jl,h=b.Kl;return f&&f.M0()?(f.MH||(b.mm.E2={anchorRow:g,anchorCol:h,leadingRow:b.Qr,leadingCol:b.Rr}),l(b,e,!1,g,h),d=!0):f&&(b=a.O2(b)),{sheet:b,r:d}},a.ay=function(b){return a.pzb(b,!0)},a.by=function(b){return a.pzb(b,!1)},a.ey=function(b){return a.O2(b)},a.gy=function(b){return a.O2(b)},a.jy=function(b){var c,d,e,i=g.G0.H0;if(i&&i._text&&(b=i.kj,c=i.nT,d=i.Mk,a.G2(b,!1),f.K0(b),i.V4||b.Sr(c,d,h,h,1),b.isEditing()))return e=b.getValue(c,d,3),!!b.gv(!0,void 0,void 0,!0)&&(b.setValue(c,d,e,3,!0),!0)},a}(),d.Commands.Wx=j},"./dist/plugins/formulaTextbox/formulatextbox-event.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-calc"),f=c("SheetsCalc"),g=c("./dist/plugins/formulaTextbox/formulatextbox.js"),h=c("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),i=d.GC$.extend,j=null,k=void 0,l=Math.max,m=Math.min,i(d.iI.prototype,{D2:function(a){var b,c,e,f,h,i,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=this,F=E.kj,G=F.Cw;G&&(E.Kka(),b=F.frozenRowCount(),c=F.frozenColumnCount(),e=G.MH,e&&E.E2||(E.E2={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1}),f=F.getRowCount(),h=F.getColumnCount(),i=a.hitTestType,j=a.row,l=a.col,m=E.shift,n=E.ctrl,o=E.E2,p=o.anchorRow,q=o.anchorCol,r=-1,s=-1,0===i?(r=b?F.ar():F.lq,s=c?F.$q():F.qq,t=d.kf(-1,-1,-1,-1),G.v1(g.C2(F,t),m,!n),E.OG=!0):1===i?(r=b?F.ar():F.lq,s=l,t=F.Jx(0,l,f-1,l,!0),m&&q>=0&&(t=F.Jx(0,l,f-1,q,!0)),t=d.kf(-1,t.col,-1,t.colCount),G.v1(g.C2(F,t),m,!n),E.OG=!0):2===i?(r=j,s=c?F.$q():F.qq,t=F.Jx(j,0,j,h-1,!0),m&&p>=0&&(t=F.Jx(j,0,p,h-1,!0)),t=d.kf(t.row,-1,t.rowCount,-1),G.v1(g.C2(F,t),m,!n),E.OG=!0):3===i&&(r=j,s=l,j!==k&&l!==k&&(u=a.row,v=a.col,w=a.pivotTableInfo,x=w&&w.getPivotInfoImp(u,v,!1,!0),y=x&&x.area,z=a.tableSelectInfo&&a.tableSelectInfo.tableSelection,!G.Nfa&&w&&x&&4===y?(G.uMc=new d.Range(u,v,1,1),A=x.valueFieldName,B=x.rowInfos,C=x.colInfos,(B||C)&&(D=E.vMc(y,A,B,C,w.position()),D&&(G.v1(D,m,!n,!0),E.OG=!0,E.SLc=!0))):(delete G.uMc,z?t=z:(t=F.Jx(j,l,j,l,!0),t=d.kf(t.row,t.col,1,1),m&&p>=0&&q>=0&&(t=F.Jx(j,l,p,q,!0))),G.v1(g.C2(F,t),m,!n),E.OG=!0))),E.DG=E.OG,m&&e||(o.anchorRow=r,o.anchorCol=s,o.leadingRow=r,o.leadingCol=s),E.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},E.qG())},vMc:function(a,b,c,e,f){var h,i,j,k,l,m,n,o,p,q=this,r=q.kj;if(4===a)return h=void 0,i=void 0,j="",k=f.row,l=f.col,m=d.kf(k,l,1,1),h=g.C2(r,m,!0),n=[],o=[],o=Array.isArray(c)&&Array.isArray(e)?c.concat(e):Array.isArray(c)&&c||Array.isArray(e)&&e,o&&o.forEach(function(a){"number"==typeof a.fieldName?n.push(a.fieldName):n.push('"'+a.fieldName+'"'),"number"==typeof a.itemName?n.push(a.itemName):n.push('"'+a.itemName+'"')}),j=n.join(","),i=b,p='GETPIVOTDATA("'+i+'",'+h,""!==j&&(p+=","+j),p+")"},F2:function(a){var b,c,e=!1,f=h.G0.H0;if(f&&f.I0)if(b=f.kj,c=a.Cw,c&&b.setFormula(f.nT,f.Mk,c.text()),b!==a){if(d.Commands.Wx.G2(b),!b.endEdit())return;e=!0}else c&&(c.destroy(),a.Cw=j),f.$b();return e},EG:function(){var a,b=this,c=b.rG;c&&b.OG&&(a=c.sG,3===a?b.H2():2===a?b.I2():1===a&&b.J2())},H2:function(){var a,b,c,d,e=this,f=e.E2,h=f.anchorRow,i=f.anchorCol,j=e.fH(),k=e.gH();h>=0&&i>=0&&j>=0&&k>=0&&(a=e.kj,b=a.Jx(j,k,h,i,!0),c=g.C2(a,b),c&&(d=a.Cw,e.SLc?b.equals(d.uMc)||(delete d.uMc,d.v1(c,!0,!0)):d.v1(c,!0,!1))),e.NG()},I2:function(){var a,b,c,e,f=this,h=f.E2.anchorRow,i=f.fH();h>=0&&i>=0&&(a=f.kj,b=a.Jx(i,0,h,a.getColumnCount()-1,!0),b=d.kf(b.row,-1,b.rowCount,-1),c=g.C2(a,b),c&&(e=a.Cw,e.v1(c,!0,!1))),f.NG()},J2:function(){var a,b,c,e,f=this,h=f.E2.anchorCol,i=f.gH();h>=0&&i>=0&&(a=f.kj,b=a.Jx(0,i,a.getRowCount()-1,h,!0),b=d.kf(-1,b.col,-1,b.colCount),c=g.C2(a,b),c&&(e=a.Cw,e.v1(c,!0,!1))),f.NG()},yH:function(){var a=this;a.RG(),a.rG=j,a.OG=!1,a.DG=!1},iG:function(a){var b,c,d,e,f,h,i,j,k=this,l=k.kj,m=k._oa(),n=a.formulaRangeHitInfo;n&&n.inBorder&&m&&(m.MH&&m.NH(),m.close(),b=n.paramRange,c=b&&b.text,c&&(d=g.L0(l,c),d&&(k.Kka(),e=l.Tq(d),f=a.row,h=a.col,f<e.row&&(f=e.row),f>=e.row+e.rowCount&&(f=e.row+e.rowCount-1),h<e.col&&(h=e.col),h>=e.col+e.colCount&&(h=e.col+e.colCount-1),i=f-e.row,j=h-e.col,k.OG=!0,k.FG=!0,k.K2={paramRange:b,fromRange:d,rowOffset:i,colOffset:j},k.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},k.qG())))},GG:function(){var a,b,c,e,f,h,i,j,k,n,o,p,q,r,s,t,u,v,w,x,y,z=this;z.OG&&z.FG&&(a=z.fH(),b=z.gH(),a>=0&&b>=0&&(c=z.K2,e=c.fromRange,f=c.rowOffset,h=c.colOffset,i=c.toRow,j=c.toCol,k=a,n=b,k===i&&n===j||(c.toRow=k,c.toCol=n,o=z.kj,p=o.getRowCount(),q=o.getColumnCount(),r=e.row,s=e.col,t=e.rowCount,u=e.colCount,v=r<0?-1:l(0,m(p-t,a-f)),w=s<0?-1:l(0,m(q-u,b-h)),x=g.C2(o,d.kf(v,w,t,u)),x&&(y=z._oa(),y.D1(c.paramRange.index,x,!0)))),z.NG())},zH:function(){var a,b=this;b.RG(),b.OG=!1,b.FG=!1,b.K2=j,a=b._oa(),a.onRangeMoved&&a.onRangeMoved()},jG:function(a){var b,c,d,e,f,h,i,j,k,l,m,n=this,o=n.kj,p=n._oa(),q=a.formulaRangeHitInfo;if(q&&p&&(p.MH&&p.NH(),b=q.paramRange,c=b&&b.text,b&&c&&(d=g.L0(o,c)))){if(n.Kka(),e=d.row,f=d.row<0?-1:d.row+d.rowCount-1,h=d.col,i=d.col<0?-1:d.col+d.colCount-1,q.inTopLeft)j=f,k=i,l=e,m=h;else if(q.inTopRight)j=f,k=h,l=e,m=i;else if(q.inBottomLeft)j=e,k=i,l=f,m=h;else{if(!q.inBottomRight)return;j=e,k=h,l=f,m=i}n.OG=!0,n.HG=!0,n.L2={paramRange:b,anchorRow:j,anchorCol:k,toRow:l,toCol:m},n.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},n.qG()}},kG:function(a,b){var c=a.Cw;return c&&c.M0()?(this.D2(b),!0):!!this.F2(a)},IG:function(){var a,b,c,e,f,h,i,j,k,n,o,p,q,r,s,t,u,v,w,x,y=this;y.OG&&y.HG&&(a=y.fH(),b=y.gH(),a>=0&&b>=0&&(c=y.L2,e=c.anchorRow,f=c.anchorCol,h=c.toRow,i=c.toCol,j=a,k=b,j===h&&k===i||(c.toRow=j,c.toCol=k,n=y.kj,o=n.getRowCount(),p=n.getColumnCount(),q=e<0?o-1:e,r=f<0?p-1:f,s=m(q,j),t=m(r,k),u=l(q,j)-s+1,v=l(r,k)-t+1,0===s&&u===o&&(s=-1,u=-1),0===t&&v===p&&(t=-1,v=-1),w=g.C2(n,d.kf(s,t,u,v)),w&&(x=y._oa(),x.D1(c.paramRange.index,w,!0)))),y.NG())},AH:function(){var a,b,c=this;c.RG(),c.OG=!1,c.HG=!1,c.L2=j,a=c._oa(),a.V4&&(a.W0=1,b=a.text().lastIndexOf(",",a.caret()),b!==-1&&(a.W0=b+1)),a.onRangeResized&&a.onRangeResized()},vr:function(a,b,c){var d,e,f,i,k,l,m,n,o,p,q,r,s=this.kj,t=this._oa(),u=t&&t.l1();if(!u||0===u.length||!t.UQa)return j;if(d=a.rowViewportIndex,e=a.colViewportIndex,this.qH(d,e,b,c))return j;for(l=u.length-1;l>=0;l--)if(f=u[l],f.allowDrag!==!1&&(m=h.G0.H0,(!m||!m._text)&&(i=g.L0(s,f.text)))){if(k=s.getRangeRect(d,e,i),n=5,o=k.x-2,p=k.x+k.width+1-n,q=k.y-2,r=k.y+k.height+1-n,o+n<=b&&b<p&&(q+1<=c&&c<=q+3||r+1<=c&&c<=r+3))return{paramRange:f,inBorder:!0};if(q+n<=c&&c<r&&(o+1<=b&&b<=o+3||p+1<=b&&b<=p+3))return{paramRange:f,inBorder:!0};if(p<=b&&b<p+n&&r<=c&&c<r+n)return{paramRange:f,inBottomRight:!0};if(o<=b&&b<o+n&&r<=c&&c<r+n)return{paramRange:f,inBottomLeft:!0};if(p<=b&&b<p+n&&q<=c&&c<q+n)return{paramRange:f,inTopRight:!0};if(o<=b&&b<o+n&&q<=c&&c<q+n)return{paramRange:f,inTopLeft:!0}}return j},_oa:function(){var a=this.kj;return a.Cw||a.Cva},ly:function(){var a,b,c,d,g,h,i,k,l,m,n,o,p,q=this,r=q.kj,s=r.Cw;if(s)if(a=r.Jl,b=r.Kl,c=r.parent,d=c&&1===c.options.referenceStyle,g=new f.SheetParserContext(r,d,e.pf(a,b)),h=new e.Parser,s.MH)for(l=s.u1(),m=0;m<l.length;m++){i=l[m];try{k=h.parse(g,i.text)}catch(a){k=j}k&&1===k.type&&(q.M2(k,a,b,!0,!0),s.D1(i.index,h.unparse(g,k)))}else{if(i=s.m1(),!i)return;try{k=h.parse(g,i.text)}catch(a){k=j}if(!k)return;1!==k.type||k.sf()?1===k.type&&(q.N2(k,a,b),s.D1(i.index,h.unparse(g,k))):(n=i.textOffset+i.text.lastIndexOf(":"),o=s.caret()<=n,o?(q.M2(k,a,b,!0,!1),p=h.unparse(g,k),s.D1(i.index,p),s.caret(i.textOffset+p.lastIndexOf(":"))):(q.M2(k,a,b,!1,!0),s.D1(i.index,h.unparse(g,k))))}},M2:function(a,b,c,d,e){var f,g,h=a.rowRelative,i=a.columnRelative;d&&(h&&i?(a.rowRelative=!1,a.columnRelative=!1,a.row+=b,a.column+=c):h?(a.columnRelative=!0,a.column-=c):i?(a.rowRelative=!0,a.columnRelative=!1,a.row-=b,a.column+=c):(a.columnRelative=!0,a.column-=c)),f=a.endRowRelative,g=a.endColumnRelative,e&&(f&&g?(a.endRowRelative=!1,a.endColumnRelative=!1,a.endRow+=b,a.endColumn+=c):f?(a.endColumnRelative=!0,a.endColumn-=c):g?(a.endRowRelative=!0,a.endColumnRelative=!1,a.endRow-=b,a.endColumn+=c):(a.endColumnRelative=!0,a.endColumn-=c))},N2:function(a,b,c){var d=a.rowRelative,e=a.columnRelative;d&&e?(a.rowRelative=!1,a.columnRelative=!1,a.row+=b,a.column+=c):d?(a.columnRelative=!0,a.column-=c):e?(a.rowRelative=!0,a.columnRelative=!1,a.row-=b,a.column+=c):(a.columnRelative=!0,a.column-=c)},Kka:function(){var a,b=this.kj,c=b.Cw;c&&(a=c.qo,a&&c.Cia(a)&&c.Jka())}})},"./dist/plugins/formulaTextbox/formulatextbox-render.js":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/formulaTextbox/formulatextbox.js"),g=c("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),h=d.GC$.extend,i=e.Common.u,h(d.oJ.prototype,{uH:function(){var a,b,c=this,d=c.kj;d.Xq>0||(a=d.am(),b=c.bm(),c.Mx(a.x,a.y,a.width,a.height),c.Pw(b))}}),d.Worksheet.$n("formulatextboxrender",{paintAdornment:function(a){var b,c,d,e=this,f=a.ctx,g=a.clipRect,h=e.yl,i=e.am(),k=e.mm._oa();if(k)for(c=0;c<=2;c++)for(d=0;d<=2;d++)b=i.Ft(c,d),b&&0!==b.width&&0!==b.height&&j(h,f,c,d,g,k)}});function j(a,b,c,d,h,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=a.kj,M=L.mm,N=j&&j.l1(),O=N&&N.length;if(!(O<=0)&&(k=a.VI(c,d,h))){for(b.save(),b.rect(k.x,k.y,k.width,k.height),b.clip(),b.beginPath(),l=[],m=M.isFormulaRangeHoving,n=M.tH,o=M.FG,p=M.K2,q=M.HG,r=M.L2,x=0;x<O;x++)if(s=N[x],t=s.text,u=s.ranges&&s.ranges.length>0?s.ranges:[f.L0(L,t)]){if(y=g.G0.H0,y&&y.kj&&void 0!==t)if(i.Bb(t,"!")){if(z=i.Ib(t,"!"),L.name()!==z&&"'"+L.name()+"'"!==z)continue}else if(A=i.Ib(t,"["),B=L.tables,!(L.getCustomNames()[A]||B&&B.findByName(A)))continue;for(v=a.XI(c,d,u,k),C=0;C<v.length;C++)D=v[C],D&&D.width>0&&D.height>0&&(w=j.o1(x),j.t1(s)||s.isPivotClickCell?(m&&n.paramRange.index===x&&(b.beginPath(),b.lineWidth=2,b.strokeStyle=w,b.rect(D.x+1,D.y+1,D.width-3,D.height-3),b.stroke()),a.fJ(b,D,w)):m&&n.paramRange.index===x||o&&p.paramRange.index===x||q&&r.paramRange.index===x?(b.beginPath(),b.lineWidth=2,b.strokeStyle=w,b.rect(D.x+1,D.y+1,D.width-3,D.height-3),b.stroke()):(b.beginPath(),b.lineWidth=2,b.strokeStyle=w,b.rect(D.x,D.y,D.width-1,D.height-1),b.stroke()),j.n1(s)&&(E=e.Common.pc.ec(w),E.a=.1,b.beginPath(),b.fillStyle=e.Common.pc.bc(E),b.fillRect(D.x+1,D.y+1,D.width-3,D.height-3)),l.push({rect:D,color:w,allowDrag:s.allowDrag}))}if(l.length>0&&j.UQa)for(F=l.length,x=0;x<F;x++)D=l[x].rect,w=l[x].color,G=5,H=D.x-2,I=D.x+D.width+1-G,J=D.y-2,K=D.y+D.height+1-G,l[x].allowDrag!==!1&&(y=g.G0.H0,y&&y._text||(b.beginPath(),b.fillStyle=w,b.fillRect(H,J,G,G),b.fillRect(I,J,G,G),b.fillRect(H,K,G,G),b.fillRect(I,K,G,G)));b.beginPath(),b.restore()}}},"./dist/plugins/formulaTextbox/formulatextbox.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-calc"),e=c("SheetsCalc"),f=c("Common"),g=c("Core"),h=c("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),i=null,j=void 0,k=Math.max,l=Math.min,m=g.GC$.extend,n=g.Ul.Nl,o=window,p=document,q=f.Common.u,r=g.Ul.nl,s=f.Common.j.Fa,t=g.Ul.Ml,u=t.msie&&parseInt(t.version,10)<10,v=q.Nb,w="formulatextbox",x="gcUIElement",y="input",z="\xa0",A=".gcFormulaTextBoxInternal",B=".gcFormulaTextBox",C="TextChanged",D="CaretChanged",E="AppendStarted",F="AppendEnded",G={left:37,right:39,up:38,down:40,tab:9,enter:13,pup:33,pdn:34,end:35,home:36,esc:27},H=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],I='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJSSURBVDhPY3hILqBYZ/eqV81LXpbNfp7S/yS0+Z5p+olD5x5OWXGyYcaBmql7yifuLOnbBkRFPVuACKIFqjNzwv2Qhhue5ReByK/qYlDtxb///n35+efd1z/PP/wB6vn2+/f7b79ffgIhiBaoTlPP5I2bN2/asmX7jh3Hjh+ft3wLUOfX779ef/h+6+nHtXsuffrx+/bj16euvwQiiBaETiAy904NTasGantRkvA8wetpsO0NJ839htKb9l/Jal6T3rgytX4FEEG0QHXuOnbr55+/P379AyIg40m8x8uZ3U+aC49bKn64eHzX0es4Xds0Y9ejl++vPXx3+f77Nx9/3PU3e5YR/CTM4WGs53pVPqBrgX6+8+QNFtdmNq0q6NpU1LOpe/6+o+fvH3fR36XCc9dE/KG3EdDNQPaF7VunLTuY0bA0omg2RAtUZ1LNUohjgCEJDJVtdlpPty6dr8x3yUDsvoPqRm2hqcp8Jy+9WbH/7cQ1EB0wnXEVCyBBt+fc8+NXXy9Yf/znz5/31swFaliiKjBZme/yrSe7z36YsuZBy4KbEC1QnRFFcxKqFgP1A1Fq7ZKcpqU1EzYuWX/kxIa1/WBtizYcAwqG5E71SZsA0QLVGZI3A+Lax+/+ACMwvHDmsn1v1xx8e+jSp83HXgP1ALmztryYsv4ZEEG0QHUGZk+FuHbHqadABORO3fC8Z/mdvmU3Oxdd9cuY1LX0VsOci/WzQQiiBaET4lQgii1fEFU6F4iAXgC6JShnakDWZKBmoDshCKIFqpMMQK7Ohw8BTajNa73pg9oAAAAASUVORK5CYII=")',J='url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+U1BKUyBBbm90aGVyLVNlbGVjdGluZzwvdGl0bGU+CiAgICA8ZyBpZD0iU1BKUy1Bbm90aGVyLVNlbGVjdGluZyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IlN3aXRjaC1yb3cvY29sdW1uIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMS4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZS04IiBmaWxsPSIjRDVENUQ1IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTYiIGhlaWdodD0iMTMiPjwvcmVjdD4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMyIgeT0iNSIgd2lkdGg9IjEwIiBoZWlnaHQ9IjQiPjwvcmVjdD4KICAgICAgICAgICAgPHBhdGggZD0iTTMsNSBMMTMsNSBMMTMsOSBMMyw5IEwzLDUgWiBNNCw2IEw0LDggTDEyLDggTDEyLDYgTDQsNiBaIiBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTAsMCBMMTYsMCBMMTYsMTMgTDAsMTMgTDAsMCBaIE0xLDEgTDEsMTIgTDE1LDEyIEwxNSwxIEwxLDEgWiIgaWQ9IuefqeW9oiIgZmlsbD0iIzY2NjY2NiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOCI+CiAgICAgICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjODFCRUZDIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTQiIGhlaWdodD0iMiI+PC9yZWN0PgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2LDAgTDE2LDQgTDAsNCBMMCwwIEwxNiwwIFogTTE1LDEgTDEsMSBMMSwzIEwxNSwzIEwxNSwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiMzNjdGQzkiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi41ODc3NjcsIDYuMDAwMDAwKSIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJTaGFwZSIgZmlsbD0iI0ZBNzU0MSIgcG9pbnRzPSI1LjQxMjIzMjg1IDcgMi40MTIyMzI4NSAzLjk5NTM1Mjk1IDQuNDEyMjMyODUgMy45OTUzNTI5NSA0LjQxMjIzMjg1IDEgNi40MTIyMzI4NSAxIDYuNDEyMjMyODUgMy45OTUzNTI5NSA4LjQxNDAzOTk4IDMuOTk1MzUyOTUiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMC44MjY2NDAyLDIuOTk1MzUyOTUgTDUuNDEyMDE5ODEsOC40MTUwOTU5NCBMMC4wMDA2NTkxMTExNjIsMi45OTUzNTI5NSBMMy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwzLjQxMjIzMjg1LDAgTDcuNDEyMjMyODUsMCBMNy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwxMC44MjY2NDAyLDIuOTk1MzUyOTUgWiBNNS40MTIyMzI4NSw3IEw4LjQxNDAzOTk4LDMuOTk1MzUyOTUgTDYuNDEyMjMyODUsMy45OTUzNTI5NSBMNi40MTIyMzI4NSwxIEw0LjQxMjIzMjg1LDEgTDQuNDEyMjMyODUsMy45OTUzNTI5NSBMMi40MTIyMzI4NSwzLjk5NTM1Mjk1IEw1LjQxMjIzMjg1LDcgWiIgaWQ9IlNoYXBlIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==")',
    > 65 | K="background",L="background-repeat",M="text-before",N="caret-before",O="\u200b";function T(a,b){var c,d=0;for(c=0;c<a.length;c++)a[c]===b&&d++;return d}function U(){var a=[];return g.GC$.each(d.sR()._h,function(b,c){d.Functions.bi[b]&&(c.name=b,a.push(c))}),a}function V(a){var b=[],c;return g.GC$.each(a,function(a,d){c=d.description(),c&&(c.name=a,b.push(c))}),b}function W(a,b){if(!a)return!1;var c=!1,d=!1;if(1===b.rowCount){if(a.hasHeadersRow()&&b.row===a.startRow())return!0;if(a.hasTotalsRow()&&b.row===a.endRow())return!0}else a.hasHeadersRow()&&b.row===a.startRow()&&(b.rowCount===a.dataRange().rowCount+1&&(c=!0),a.hasTotalsRow()&&b.rowCount===a.dataRange().rowCount+1+1&&(c=!0)),b.row===a.dataRange().row&&(b.rowCount===a.dataRange().rowCount&&(c=!0),a.hasTotalsRow()&&b.rowCount===a.dataRange().rowCount+1&&(c=!0));return b.col+b.colCount<=a.startColumn()+a.dataRange().colCount&&(d=!0),c&&d}function X(a){return a.replace(/'/g,"''")}function Y(a){var b=a.name();return e.jma(b.split(""),!1)?b:"'"+X(b)+"'"}function Z(a){var b=d.getMapping()&&d.getMapping().builtInFunctionsMapping;return b&&b[a]&&b[a].alias||a}function $(a,b,c){var d,f,j,k,l,m,n,o,p,q,r,s;return b?(d=a.Cw,f=h.G0.H0,j=f&&f.kj||a,k=j.Jl,l=j.Kl,m=a.parent,n=m&&1===m.options.referenceStyle,o=15,(a.Cw&&a.Cw.Nfa||c)&&(o=0),b.row<0&&b.col<0&&(b=new g.Range(0,(-1),a.getRowCount(),(-1))),p=a.tables,q=p&&p.find(b.row,b.col),(f&&f.Nfa||c)&&(o=0),d&&!d.V4&&W(q,b)?(f&&f._text&&f.kj!==a&&(k=l=-1),e.rangeToFormulaWithStructReference(a,b,k,l,o,n,q)):(r=e.rangeToFormula(b,k,l,o,n),(f&&f._text||a.Cw&&a.Cw.V4&&a.Cw.ria)&&(s=Y(a),r=s+"!"+r),r)):i}b.C2=$,g.Events.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",g.Events.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",o.Yl.km.push(function(a,b){var c,d=h.G0;!b&&a.endEdit&&d&&(c=d.H0,c&&c.I0&&a.Cw&&(a.Cw&&a.Cw.destroy(),a.Cw=i,c.$b()))});function _(a,b,c){var e,f,h,i,j,k=a.parent,l=k&&k.options;(b&&l&&l.allowUserEditFormula&&l.enableFormulaTextbox||c)&&(a.Cw&&a.Cw.destroy(),a.Cw=new S(b,null,k),e=a.Cw.text(),f=a.getFormulaInformation(a.Jl,a.Kl),"="!==e[0]||f&&f.hasFormula||(e="'"+e,a.Cw.text(e)),h=a.Cw,i=a.mm,j=a.yl,h.bind("AppendStarted",function(){h.close();var b=a.Px;1!==b&&(a.Px=1,a.Cu(b,1))}),h.bind("AppendEnded",function(){j.uH()}),h.bind(C,function(b,c){if(!a.Js){if(c&&c.type!==y){i.Qw(c);var d=a.Jl,e=a.Kl,f=a.getCellType(d,e);a.Wq(g.Events.EditChange,{sheet:a,sheetName:a.name(),row:d,col:e,editingText:f.getEditorValue(a.BF)})}j.uH(),a.Wq(g.Events.FormulaTextBoxTextChanged,{sheet:a,sheetName:a.name(),text:h.text()})}}),h.bind("CaretChanged",function(){j.uH(),a.Wq(g.Events.FormulaTextBoxCaretChanged,{sheet:a,sheetName:a.name(),caret:h.caret()})}),h.add(U()),h.add(V(d.Functions.ci)),h.add(V(a.Su).concat(V(k.Su))),j.uH())}b.J0=_;function aa(a){a.Cw&&(a.Cw.destroy(),a.Cw=i,a.yl.uH());var b=a.parent&&a.parent.CF;p.activeElement===(b&&b.qo)&&a.mm.Qq()}b.K0=aa;function ba(a,b){var c,d,f,g;if(!b)return i;c=h.G0.H0,d=c&&c.kj||a,f=d.Jl,g=d.Kl;try{return e.formulaToRange(a,b,f,g)}catch(a){}return i}b.L0=ba,m(g.DC.prototype,{bE:function(a){return!(a&&a.Cw&&a.Cw.M0())}}),g.Worksheet.$n(w,{startEdit:function(a){_(this,a.element)},endEdit:function(){aa(this)}}),P=g.DC.prototype,Q=P.dE,g.DC.$n(w,{preProcessMouseDbClick:function(a){var b=g.sJc(this.OC),c=b?b.Cw:void 0,d=c&&c.M0(),e=h.G0.H0;d?a.r=!1:e&&e.I0&&e.$b()}}),P.dE=function(){var a=g.sJc(this.OC),b=a&&a.Cw,c=h.G0.H0,d=c&&c._text;return Q.call(this)&&!d&&!b},R=1;function ca(a,b){var c,d,e,f,h,i,j,k,l,m,o=g.GC$(a);return o.attr("contenteditable","false"),c=n("table"),g.GC$(c).css("border-spacing","0"),g.GC$(c).css("width","100%"),o.append(c),d=n("tbody"),c.appendChild(d),e=document.createElement("tr"),d.appendChild(e),f=document.createElement("td"),g.GC$(f).css("padding-right","0px"),e.appendChild(f),h=document.createElement("td"),g.GC$(h).css("width","23px"),g.GC$(h).css("padding-right","0px"),e.appendChild(h),i=o.width()-g.GC$(h).width(),j=n("div"),k=n("div"),g.GC$(k).width(i),g.GC$(k).css({"overflow-y":"auto","overflow-x":"hidden",height:"20px"}),k.appendChild(j),f.appendChild(k),l=n("div"),h.appendChild(l),g.GC$(j).css({display:"inline-block",float:"left",height:"auto",outline:"none"}),g.GC$(j).width(i),g.GC$(j).attr("contenteditable","true"),g.GC$(j).attr("spellcheck","false"),m=g.GC$(l),m.css({display:"block",float:"right",width:"23px",height:"23px",background:I,"background-repeat":"no-repeat"}),m.bind("click",function(){b.D5?(b.OC.Wq("RangeSelectEnding",b),b.endSelectMode()):b.startSelectMode()}),{contentDiv:j,button:l}}function da(a){var b,c=["FILTER","RANDARRAY","SEQUENCE","SORT","SORTBY","UNIQUE"];for(b=0;b<c.length;b++)if(a===c[b])return!0}S=function(){function a(a,b,c){var d,e,f,i,j=this,k=a;if(j.V4=!1,j.Nfa=!1,j.ria=!0,j.Ac=[],j.Bc=[],j._gc=[],b&&b.rangeSelectMode&&(b.absoluteReference===!0&&(j.Nfa=!0),b.needSheetName===!1&&(j.ria=!1),j.V4=!0,j.D5=!1,j.E5=!1,j.cga=a,d=ca(a,j),k=d.contentDiv,j.sia=d.button,j.tia=a,j.C5=R,R++),j.UQa=!0,j.ad(c&&c.getHost()||p.body),k&&j.N0(k),c&&(j.O0=!0,j.P0(c),j.OC.Gu(g.Events.FormulatextboxActiveSheetChanging,h.G0.Q0),j.OC.Fu(g.Events.FormulatextboxActiveSheetChanging,h.G0.Q0),j.OC.Gu(g.Events.FormulatextboxActiveSheetChanged,h.G0.R0),j.OC.Fu(g.Events.FormulatextboxActiveSheetChanged,h.G0.R0)),e=j.text(),j.S0=j.T0(e),f=j.Cia(k)){j.V0(j.S0);try{i=o.getSelection(),i.selectAllChildren(k),i.rangeCount>0&&i.collapseToEnd()}catch(a){}g.GC$(j.qo).data(M,e)}}return a.prototype.j5=function(a){var b,c,d,e,f,g,i=this;i.O1(),i.UF(),i.E5=!0,b=h.W4(i.OC.qo),c=i.a1(),c&&(c.suspendPaint(),_(c,b,!0),d=c.Cw,d.V4=!0,d.C5=i.C5,d.Nfa=i.Nfa,d.ria=i.ria,a&&(i.text(a),i.caret(a.length)),e=i.text(),f=i.caret(),f<=0&&(f=e.length),i.focus(),i.caret(f),i.MH=!0,i.W0=1,g=e.lastIndexOf(",",f),g!==-1&&(i.W0=g+1),e||(i.text("="),e="=",i.caret(1),f=1),0!==e.indexOf("=")&&(e="="+e,f++),d.text(e),d.caret(f),d.MH=i.MH,d.W0=i.W0,c.resumePaint())},a.prototype.startSelectMode=function(a){var b,c=a;c&&0!==c.indexOf("=")&&(c="="+c),b=this,b.V4=!0,b.D5=!0,g.GC$(b.sia).css([K,L],[J,"no-repeat"]),b.j5(c)},a.prototype.endSelectMode=function(){this.D5=!1,this.H5(),g.GC$(this.sia).css([K,L],[I,"no-repeat"])},a.prototype.H5=function(){var a=this.a1();a&&(a.gv(!0,j,!0),a.repaint())},a.prototype.rgc=function(a){this._gc=[a]},a.prototype.ahc=function(){return this._gc},a.prototype.destroy=function(){var a=this;a.D5&&a.H5(),a._gc=i,a.MH=!1,a.W0=-1,a.X0(),a.Y0(),g.GC$(a.Z0).remove(),g.GC$(a.$0).remove(),g.GC$(a._0).remove()},a.prototype.bind=function(a,b,c){var d=this.qo;d&&a&&(a=a.split(/\s+/).join(B+" "),g.GC$(d).bind(a+B,b,c))},a.prototype.unbind=function(a,b){var c=this.qo;c&&a&&(a=a.split(/\s+/).join(B+" "),g.GC$(c).unbind(a+B,b))},a.prototype.unbindAll=function(){var a=this.qo;a&&g.GC$(a).unbind(B)},a.prototype.caret=function(a){var b,c,d=this,e=d.qo;if(e)return b=p.activeElement===e,c=g.GC$(e),0===arguments.length?b?d.b1(e).end:c.data(N):void(a!==d.caret()&&(b?(d.c1(e,a),c.data(N,d.b1(e).end)):c.data(N,a),d.Wq(D,{})))},a.prototype.b1=function(a){var b,c,d,e=this,f=-1,g=-1;return e.d1(a)?(f=a.selectionStart,g=a.selectionEnd):e.Cia(a)&&(b=o.getSelection(),b.rangeCount>0&&(c=b.getRangeAt(0),d=c.cloneRange(),d.selectNodeContents(a),d.setEnd(c.endContainer,c.endOffset),g=(""+d).length,d=c.cloneRange(),d.selectNodeContents(a),d.setEnd(c.startContainer,c.startOffset),f=(""+d).length,d.detach())),{start:f,end:g}},a.prototype.c1=function(a,b){var c,d,e,f,g=this;g.d1(a)?a.setSelectionRange(b,b):g.Cia(a)&&(e=this.e1(a,b),e&&(c=o.getSelection(),d=p.createRange(),f=e.node,f&&1===f.childNodes.length?d.setStart(f.firstChild,e.offset):f.lastChild&&f.lastChild.length&&d.setStart(f.lastChild,f.lastChild.length),d.collapse(!0),c.removeAllRanges(),c.addRange(d),this.V4&&(a.parentElement.scrollTop=a.parentElement.scrollHeight)))},a.prototype.text=function(a){var b,c,d,e,f,i,j,k,l=this,m=l.qo,n=l.a1();if(!m||!n||n.Js)return"";if(b=l.d1(m),c=l.Cia(m),0===arguments.length){if(d="",b)d=m.value;else if(c){if(e=m.getElementsByClassName("gcsj-func-gray-formula"),e.length>0)return"";d=u?g.Ul.Woa(m):m.innerText,d=d.replace(/\r\n?/g,"\n"),d.indexOf(z)>=0&&(d=g.Ul.Ika(d,z," "))}return d}null!==a&&void 0!==a||(a=""),a!==l.text()&&(f=l.mLb(a),f?l.S0=l.T0(f):l.S0=l.T0(a),b?m.value=a:c&&(i=l.nLb(l.S0,a),l.V0(i),l.caret(a.length)),j={},k=h.G0.H0,k&&k._text&&(j={sheet:k.kj,editor:k.I0&&k.I0.firstChild.firstChild,canvasOffset:k.f1}),l.Wq(C,j)),l.oLb&&l.pLb()},a.prototype.BXc=function(){var a=this;g.GC$(a.qo).data(M,a.text())},a.prototype.autoComplete=function(a){return 0===arguments.length?this.g1:void(this.g1=a)},a.prototype.showHelp=function(a){return 0===arguments.length?this.h1:void(this.h1=a)},a.prototype.add=function(a){var b,c;if(a)if(g.GC$.isArray(a))for(b=a.length,c=0;c<b;c++)this.Sb(a[c]);else this.Sb(a)},a.prototype.Sb=function(a){var b,c,d,e,f=a&&v(Z(a.name));if(f){for(b=this.i1,c=b.length,d=0;d<c;d++){if(e=v(b[d].name),e===f)return;if(e>f)break}b.splice(d,0,a)}},a.prototype.remove=function(a){var b,c,d;if(a)for(a=v(a),b=this.i1,c=b.length,d=0;d<c;d++)if(v(b[d].name)===a){b.splice(d,1);break}},a.prototype.workbook=function(a){var b=this;return 0===arguments.length?b.OC:void(a===i?b.V4&&b.H5():(b.P0(a),b.j1()))},a.prototype.P0=function(a){var b,c;a&&(b=this,b.OC&&b.Y0(),c=b.qo,c&&(b.OC=a))},a.prototype.l1=function(){var a,b,c,d,e=[],f=this.S0,g=f&&f.length,h=0,i=0;if(g>0)for(c=0;c<g;c++)a=f[c],b=a.text,11===a.type&&(e.push({textOffset:h,text:b,ranges:a.ranges,index:i,allowDrag:a.allowDrag}),i++),h+=b.length;return d=this.uMc,d&&e.push({ranges:[d],index:i,allowDrag:!1,isPivotClickCell:!0}),e},a.prototype.m1=function(){var a,b,c,d,e,f=this.qo,g=this.l1();if(f&&g&&g.length>0)for(a=this.caret(),b=g.length,c=void 0,d=void 0,e=0;e<b;e++){if(c=g[e],d=c.textOffset,d<a&&a<=d+c.text.length)return c;if(d>=a)break}return i},a.prototype.n1=function(a){var b,c,d;return!!a&&(b=this.caret(),c=a.text,d=a.textOffset,d<b&&b<=d+c.length)},a.prototype.o1=function(a){var b,c,d,e,f,g,h,i=this.l1(),j=i.length;if(a<0||j<=a)return"";for(b=[],d=0,e=0;e<j;e++){for(c=i[e],f=!1,g=0;g<b.length;g++)if(c.text&&b[g].text.replace(/\s+/g,"").toUpperCase()===c.text.replace(/\s+/g,"").toUpperCase()){f=!0;break}if(f){if(a===e){d=g;break}}else if(b.push(c),a===e){d=b.length-1;break}}return h=H,h[d%h.length]},a.prototype.M0=function(){var a,b,c;return!!this.MH||(!!this.V4||(a=this.s1(this.caret()),!!a&&(b=a.type,c=a.text,1===b||8===b||7===b&&"%"!==c||5===b||9===b||15===b)))},a.prototype.t1=function(a){if(!a||!this.MH)return!1;var b=this.W0,c=this.caret(),d=a.textOffset;return b<=d&&d<c},a.prototype.u1=function(){var a,b,c=[],d=this.l1(),e=d.length;if(e>0)for(b=0;b<e;b++)a=d[b],this.t1(a)&&c.push(a);return c},a.prototype.v1=function(a,b,c,d){var e,g,i,j,k,l,m,n,o,p,q,r=this,s=r.qo;if(a&&s){if(!r.MH){if(!r.M0())return;b=!1,r.MH=!0,r.W0=r.caret(),r.Wq(E,{})}e=r.W0,g=r.text(),i=r.caret(),g||(g="=",e=r.W0=1,i=1),j=i,c&&(b=!1,g=g.substr(0,e)+(i<0?"":g.substr(i)),r.S0=r.T0(g),i=e,j=i),k=r.s1(i),b?(l=g.substr(0,i),l=l.substr(0,l.length-k.text.length),l.length>=e&&(k.text=a,j=l.length+a.length)):(m=r.S0,n=f.Common.k.Cb(m,k),o=r.V4&&m.length>1&&n===m.length-1&&11===k.type,d?(a=i>e||o?g+this.w1()+a:g.slice(0,i)+a+g.slice(i),r.S0=r.T0(a)):i>e||o?(m.splice(n+1,0,{text:this.w1(),type:8}),m.splice(n+2,0,{text:a,type:11}),a=","+a):m.splice(n+1,0,{text:a,type:11}),j=i+a.length),r.z1(),p={},q=h.G0.H0,q&&q._text&&(p={sheet:q.kj,editor:q.I0&&q.I0.firstChild.firstChild,canvasOffset:q.f1}),r.Wq(C,p),r.caret(j)}},a.prototype.NH=function(){var a=this;a.MH&&(a.MH=!1,a.W0=-1,a.Wq(F,{}))},a.prototype.B1=function(){this.MH=!0,this.W0=this.caret()},a.prototype.C1=function(a){return void 0!==a&&(this.W0=a),this.W0},a.prototype.D1=function(a,b,c){var d,e,f,g,h,i,j,k=this,l=k.qo;if(l&&!(a<0)&&b){for(d="",e=!1,f=k.S0,g=f&&f.length,i=0,j=0;j<g;j++){if(h=f[j],11===h.type&&i++===a){f[j]={text:b,type:11},e=!0;break}d+=h.text}e&&(k.z1(),k.Wq(C,{}),c?k.caret(k.text().length):k.caret(d.length+b.length))}},a.prototype.j1=function(){var a,b,c=this;c.OC&&(a=c.qo,c.OC&&a&&(a.setAttribute(x,"gcAttachedFormulaTextBox"),c.V4||(c.OC.CF=c),c.OC.Fu(g.Events.FormulatextboxEditStarted,c,c.E1),c.OC.Fu(g.Events.FormulatextboxEnterCell,c,c.F1),c.OC.Fu(g.Events.FormulatextboxEditEnded,c,c.G1),c.OC.Fu(g.Events.FormulatextboxActiveSheetChanged,c,c.H1),c.OC.Fu(g.Events.FormulatextboxRangeChanged,c,c.I1),c.OC.Fu(g.Events.FormulaTextBoxTextChanged,c,c.J1),c.OC.Fu(g.Events.FormulaTextBoxCaretChanged,c,c.K1),c.OC.Fu(g.Events.ValueChanged,c,c.qLb),b=g.sJc(c.OC),b&&!c.V4&&c.text(c.L1(b,b.Jl,b.Kl)),c.Fu(C,c,c.M1),c.Fu(D,c,c.N1)))},a.prototype.refresh=function(a){var b,c=this.OC,d=this;c&&(b=g.sJc(c),b&&!d.V4&&(d.OG=!!a||d.OG,d.text(d.L1(b,b.Jl,b.Kl)),d.OG=!1))},a.prototype.Y0=function(){var a=this,b=a.OC;!a.O0&&b&&(a.V4||(b.CF=null,b.Gu(g.Events.FormulatextboxEditStarted,a.E1),b.Gu(g.Events.FormulatextboxEnterCell,a.F1),b.Gu(g.Events.FormulatextboxEditEnded,a.G1),b.Gu(g.Events.FormulatextboxActiveSheetChanged,a.H1),b.Gu(g.Events.FormulatextboxRangeChanged,a.I1),b.Gu(g.Events.FormulaTextBoxTextChanged,a.J1),b.Gu(g.Events.FormulaTextBoxCaretChanged,a.K1),b.Gu(g.Events.ValueChanged,a.qLb),a.Gu(C,a.M1),a.Gu(D,a.N1)),a.text("")),a.OC=null},a.prototype.O1=function(){var a,b,c=this;c.OG||(c.OG=!0,a=this.OC,b=a&&g.sJc(a),b&&!b.isEditing()?(c.V4||b.EF(null,b.Jl,b.Kl,null,null,!1,null),c.Q1=!0):c.Q1=!1,c.OG=!1,c.R1||c.S1())},a.prototype.rLb=function(){var a=this,b=a.qo,c=a.sLb;b.insertBefore(c,b.firstChild),c.innerText=a.oLb},a.prototype.tLb=function(a,b){if(a){var c=this.uLb;c!==b&&(this.uLb=b,a.style.display=b?"":"none")}},a.prototype.pLb=function(){var a,b=this,c=b.qo,d=b.Cia(c);d?(a=b.sLb,a||(a=b.sLb=n("span"),a.className="gcsj-func-gray-formula"),b.tLb(a,!0),b.rLb()):c.placeholder=b.oLb},a.prototype.vLb=function(){var a,b,c=this;c.oLb&&(c.oLb="",a=c.qo,b=c.Cia(a),b?c.tLb(c.sLb,!1):a&&(a.placeholder=""))},a.prototype.UF=function(){var a,b,c,d,e,f,h=this,i=h.OC,j=i&&g.sJc(i);j&&(a=j.Cw,h.Q1&&a&&(b=a.text(),c=h.text(),c!==b&&(d=h.caret(),e=j.getFormulaInformation(j.getActiveRowIndex(),j.getActiveColumnIndex()),h.text(b),e.isArrayFormula&&(d>=c.length&&(d-=1),d=k(0,d-1)),h.caret(d))),(h.Q1&&a||h.V4)&&(f=j.Px,2!==f&&(j.Px=2,j.Cu(f,2))))},a.prototype.L1=function(a,b,c){var d,e,f,h,i,j="";if(a){if(d=a.parent,e=d&&d.options,f=a.getFormulaInformation(b,c),f&&f.hasFormula){if(j="="+f.formulaWithCulture,f.isDynamicArray)return this.oLb=j,"";this.oLb="",f.isArrayFormula&&(j="{"+j+"}")}else h=a.getActualStyle(b,c),i=a.getValue(b,c),j="string"==typeof i&&h.quotePrefix||j.length>0&&"="===j[0]&&e&&e.allowUserEditFormula?"'"+i:g.Ul.Il(h,i,a)||"";this.vLb()}return j},a.prototype.H1=function(a,b){var c,d,e=a.data;e.OG||(c=b.newSheet,e.V4||(e.OG=!0,e.close(),b&&(d=c,e.text(e.L1(d,d.Jl,d.Kl))),e.OG=!1))},a.prototype.E1=function(a){var b,c,d,e=a.data;e.OG||(b=e.OC,c=b&&g.sJc(b),d=c&&c.Cw,d&&e.V4===d.V4&&e.C5===d.C5&&(e.vLb(),e.OG=!0,e.text(d.text()),e.OG=!1))},a.prototype.F1=function(a,b){var c=a.data;c.V4||c.OG||(c.OG=!0,b&&c.text(c.L1(b.sheet,b.row,b.col)),c.OG=!1)},a.prototype.I1=function(a,b){var c,d,e,f,h,i=a.data;i.OG||i.V4||(i.OG=!0,b&&(c=b.sheet,d=b.row,e=b.col,f=b.rowCount,h=b.colCount,new g.Range(d,e,f,h).contains(c.Jl,c.Kl)&&i.text(i.L1(c,c.Jl,c.Kl))),i.OG=!1)},a.prototype.G1=function(a,b){var c=a.data;return c.V4&&c.D5&&c.E5?void(b.ignore=!0):void(c.OG||(c.OG=!0,c.close(),b&&b.sheet.Cw&&!b.sheet.Cw.V4&&!c.V4&&c.text(c.L1(b.sheet,b.row,b.col)),c.OG=!1))},a.prototype.qLb=function(b,c){var d=c.sheet,e=d&&d.parent&&d.parent.CF;e&&e.e2()===c.row&&e.f2()===c.col&&e.a1()===d&&b.data instanceof a&&(c.text=d.getText(c.row,c.col),b.data.J1(b,c))},a.prototype.J1=function(a,b){var c,d=a.data;d.OG||(!b.sheet.Cw||d.V4===b.sheet.Cw.V4&&d.C5===b.sheet.Cw.C5)&&(d.OG=!0,b&&(c=d.caret(),d.text(b.text),d.caret(c)),d.OG=!1)},a.prototype.K1=function(a,b){var c=a.data;c.OG||(!b.sheet.Cw||c.V4===b.sheet.Cw.V4&&c.C5===b.sheet.Cw.C5)&&(c.OG=!0,b&&c.caret(b.caret),c.OG=!1)},a.prototype.M1=function(a){var b,c,d,e,f,h,i,j,k=a.data;if(!k.OG&&(b=k.OC,c=b&&g.sJc(b))){if(c.isEditing()||(k.O1(),k.focus()),k.OG=!0,d=c.Jl,e=c.Kl,f=c.Cw,h=c.getCellType(d,e),f){if(k.V4!==f.V4||k.C5!==f.C5)return;i=f.caret(),f.text(k.text()),f.caret(i)}else j={sheet:c,row:d,col:e,sheetArea:3},h.setEditorValue(c.BF,k.text(),j);k.OG=!1}},a.prototype.N1=function(a){var b,c,d,e=a.data;e.OG||(b=e.OC,c=b&&g.sJc(b),c&&c.isEditing()&&(d=c.Cw,(!d||e.V4===d.V4&&e.C5===d.C5)&&(e.OG=!0,d&&(d.caret(e.caret()),e.S1()),e.OG=!1)))},a.prototype.ad=function(a){var b,c,d,e=this;e.T1=!1,e.U1=!1,e.MH=!1,e.W0=-1,e.i1=[],e.g1=!0,e.h1=!0,e.V1=!0,b=n("div"),b.className="gcsj-func-ac-popup",b.style.display="none",b.setAttribute(x,"gcFuncACPopup"),a.insertBefore(b,i),e.Z0=b,e.R1=!1,c=n("div"),c.className="gcsj-func-help-popup",c.style.display="none",c.setAttribute(x,"gcFuncHelpPopup"),a.insertBefore(c,i),e.$0=c,e.W1=!1,g.GC$(b).bind("mouseover",function(){e.V1=!1}).bind("mouseout",function(){e.V1=!0}),g.GC$(c).bind("mouseover",function(){e.V1=!1}).bind("mouseout",function(){e.V1=!0}),g.GC$(b).bind("scroll",function(){e.X1&&clearTimeout(e.X1),e.X1=o.setTimeout(function(){e.qo&&e.qo.focus()},100)}),d=n("div"),d.style.display="none",d.setAttribute(x,"gcFuncHelpDiv"),a.insertBefore(d,i),e._0=d,e.OC=null,e.OG=!1,e.Q1=!1,e.O0=!1},a.prototype.N0=function(a){var b,c,d;a&&(b=this,c=b.Cia(a),(b.d1(a)||c)&&(d=g.GC$(a),b.qo&&b.X0(),b.qo=a,t&&(t.msie||t.chrome)?c||u||t.chrome?(b.Fu("focus",function(){d.data(M,b.text())}),b.Fu("click",function(){d.focus()}),"input keydown keyup cut paste".split(" ").forEach(function(a){b.Fu(a,function(){b.Y1()})})):b.Fu(y,function(){b.Z1()}):b.Fu(y,function(){if(c){var a=b.qo.lastChild;t.chrome&&a&&"BR"===a.tagName&&b.qo.removeChild(a)}b.Z1()}),b.Fu("keydown",function(a){var d,e,f,h,i,j=a.ctrlKey,k=a.shiftKey,l=a.altKey,m=a.metaKey,n=j||k||l||m,o=a.keyCode;!n&&b.R1&&(o===G.down?(b._1(1),r(a)):o===G.up?(b._1(-1),r(a)):o===G.tab&&(b.a2(),r(a))),o===G.esc&&b.close(),b.b2(a),d=g.sJc(b.OC),e=d&&d.mm.LH(a),b.V4&&e&&(f=d.Cw,f&&f.MH&&f.NH()),c&&(e?(8===o?fa(a)&&g.uHb.processBackspaceAndLeftArrowKeyEvent(a,!0):46===o&&fa(a)&&g.uHb.processDeleteAndRightArrowKeyEvent(a,!0),b.Jka()):13===o&&(j||l)?(fa(a)&&ea(),b.Jka(!0)):37===o?fa(a)&&g.uHb.processBackspaceAndLeftArrowKeyEvent(a,!1):39===o&&fa(a)&&g.uHb.processDeleteAndRightArrowKeyEvent(a,!1),c&&j&&(90===o||89===o)&&r(a)),h=b.text(),g.Ul.sl()&&c&&m&&(i=void 0,90===o&&(k?(i=b.Bc.pop(),i&&(b.text(i),b.Ac.push(h))):(i=b.Ac.pop()||"",b.text(i),b.Bc.push(h)),a.preventDefault(),a.stopPropagation()))}),b.Fu("keyup",function(a){var d,e,f,g;b.b2(a),d=b.text(),c&&(e=void 0,f=a.keyCode,g=a.ctrlKey,g&&90===f?(e=b.Ac.pop()||"",b.text(e),b.Bc.push(d)):g&&89===f&&(e=b.Bc.pop(),e&&(b.text(e),b.Ac.push(d))))}),b.Fu("focus",function(a){var c=t&&t.mozilla;c&&!b.qo.innerText&&(b.qo.innerText=""),b.b2(a),b.V4&&b.D5&&(b.E5=!0,b.j5())}),b.Fu("blur",function(){b.V1&&b.close(),b.V4&&(b.H5(),b.E5=!1)}),b.Fu("mousedown",function(){b.E5=!0,b.uLb&&(b.vLb(),b.wLb=!0),b.O1()}),b.Fu("mouseup",function(){if(b.wLb){b.wLb=!1;var a=b.qo,c=o.getSelection();a!==c.anchorNode&&c.selectAllChildren(a)}b.UF()}),b.Fu("click",function(a){var c,d,e;b.MH&&b.NH(),c=b.OC,d=c&&g.sJc(c),e=d&&d.Cw,e&&e.MH&&!e.V4&&e.NH(),b.b2(a)}),b.Fu("compositionstart",function(){b.T1=!0}),b.Fu("compositionend",function(){b.T1=!1,(t.edge||t.chrome)&&b.Y1()})))},a.prototype.X0=function(){var a,b=this,c=b.qo;c&&(a=g.GC$(c),a.removeData(M),a.removeData(N),a.removeAttr(x),b.nu(),b.unbindAll(),b.V4&&(g.GC$(b.cga).empty(),b.cga=i),b.qo=i)},a.prototype.Y1=function(){var a=this,b=g.GC$(a.qo),c=a.text();b.data(M)!==c&&(a.T1||b.data(M,c),a.Z1())},a.prototype.b2=function(a){if(t&&t.msie){var b=function(a,b){return function(){a.d2(a,b)}};setTimeout(b(this,a),10)}else this.d2(this,a)},a.prototype.d2=function(a,b){var c,d,e,f,h,i=b.keyCode,j=i===G.left||i===G.right||i===G.home||i===G.end||i===G.pdn||i===G.pup||i===G.tab||i===G.enter;if(a.g1||(j=j||i===G.up||i===G.down),c=void 0!==b.button,j||c){if(d=a.qo,e=g.GC$(d),f=a.b1(d),f.start!==f.end)return;h=f.end,e.data(N)!==h&&(e.data(N,h),a.Wq(D,{}),a.S1())}},a.prototype.e2=function(){var a=this.a1();return a?a.Jl:j},a.prototype.f2=function(){var a=this.a1();return a?a.Kl:j},a.prototype.a1=function(){if(this.OC)return g.sJc(this.OC)},a.prototype.parseInternal=function(a,b,c,f){var g,h,i=this,j=[];return a&&"="===a[0]&&T(a,'"')%2!==1?(g=new d.Parser,h=e.qzb(g,a,b,c,f,!0),j=i.i2(h)):(j.push({text:a,type:17}),j)},a.prototype.T0=function(a){return this.parseInternal(a,this.a1(),this.e2(),this.f2())},a.prototype.Z1=function(){var a,b,c,d=this,e=d.text();return"\n"!==e&&e.indexOf("\n")>=0?void d.Wq(C,{type:y}):(a=d.qo,b=g.GC$(a),d.U1=!0,d.S0=d.T0(e),d.Cia(a)?d.T1||("\n"===e?(b.empty(),d.Wq(C,{type:y})):(c=d.caret(),d.V0(d.S0),d.Wq(C,{type:y}),d.caret(c))):d.Wq(C,{type:y}),c=d.caret(),b.data(N)!==c&&(b.data(N,c),d.Wq(D,{})),d.c2(),void(d.R1||d.S1()))},a.prototype.j2=function(){return f.Common.CultureManager.q4().NumberFormat},a.prototype.h2=function(){var a=this.j2();return a&&a.arrayGroupSeperator||";"},a.prototype.l2=function(){var a=this.j2();return a&&a.arrayListSeparator||","},a.prototype.w1=function(){var a=this.j2();return a&&a.listSeparator||","},a.prototype.g2=function(){var a=this.j2();return a&&a.numberDecimalSeparator||"."},a.prototype.i2=function(a){var b,c,d,e,g=[],h=[],i=this.h2(),j=this.l2(),k=!1;for(b=0;b<a.length;b++)b>0&&b<a.length-1&&";"===a[b-1].text&&","===a[b].text&&"ARRAYROW"===a[b+1].text||(c=a[b],d=this.m2(c,h),e=c.text,2===d?g.push({text:e,type:d}):k&&8===d&&","===e?g.push({text:j,type:9}):k&&8===d&&";"===e?g.push({text:i,type:10}):8===d?g.push({text:e,type:d}):3===d?("ARRAY"===e&&(k=!0),g.push({text:"{",type:3})):4===d?"ARRAY"===e?(k=!1,g.push({text:"}",type:4})):g.push({text:e,type:4}):6===d?g.push({text:")",type:d}):13===d?g.push({text:f.Common.o.nb(e),type:d,ranges:c.ranges,allowDrag:c.canDrag}):null!==d&&g.push({text:e,type:d,ranges:c.ranges,allowDrag:c.canDrag}));return g},a.prototype.m2=function(a,b){var c,d=a.type,e=a.subType,f=a.text,g=a.value;if(1===d){if(1===e)return"ARRAY"===f||"ARRAYROW"===f?(b.push(3),3):(b.push(5),"@"===g||"("===g.trim()?5:2);if(2===e){if(")"===g.trim())return 6;if(b.length>0){if(c=b[b.length-1],3===c)return b.pop(),4;if(5===c)return b.pop(),6}}if("="===g.trim())return 1}else if(3===d){if(0===e)return 8}else{if(5===d||6===d||4===d)return 7;if(0===d)return 7===e||0===e?11:5===e?12:4===e?13:3===e?14:6===e?16:14;if(7===d)return 15;if(8===d)return 17}return 17},a.prototype.z1=function(){var a,b=this,c=b.qo,d=b.S0,e="",f=d&&d.length;for(a=0;a<f;a++)e+=d[a].text;b.d1(c)?c.value=e:b.Cia(c)&&b.V0(d)},a.prototype.d1=function(a){var b=a&&a.tagName;return"TEXTAREA"===b||"INPUT"===b},a.prototype.Cia=function(a){return a&&"DIV"===a.tagName&&"true"===a.contentEditable},a.prototype.Dia=function(a){return"gcEditingInput"===g.GC$(a).attr(x)},a.prototype.bW=function(a){return a&&"="===a[0]},a.prototype.Fu=function(a,b,c){var d=this.qo;d&&a&&(a=a.split(/\s+/).join(A+" "),g.GC$(d).bind(a+A,b,c))},a.prototype.Gu=function(a,b){var c=this.qo;c&&a&&(a=a.split(/\s+/).join(A+" "),g.GC$(c).unbind(a+A,b))},a.prototype.nu=function(){var a=this.qo;a&&g.GC$(a).unbind(A)},a.prototype.Wq=function(a,b){var c=this.qo;c&&g.GC$(c).trigger(a,b)},a.prototype.s1=function(a){var b,c,d,e,f;if(a<=0)return i;if(b=this.S0,c=b&&b.length,c>0)for(d=0,e=void 0,f=0;f<c;f++)if(e=b[f],d+=e.text.length,d>=a)return e;return i},a.prototype.n2=function(){var a,b,c,d,e,f=this.OC;if(f&&(a=g.sJc(f),a&&(b=a.getCalcService().allowDynamicArray,c=a.Cw))){for(d=[].concat(c.i1),e=d.length-1;e>=0;e--)!b&&d[e]&&da(d[e].name)?d.splice(e,1):d[e].isFunc=!0;return d.concat(this.o2(f,a)).concat(this.q2(f.sheets)).concat(this.wMc(f))}return this.i1},a.prototype.o2=function(a,b){var c,d=[],e=b.getCustomNames();return e&&g.GC$.each(e,function(a,b){d.push({name:b.Cj,description:b.kT})}),c=a.getCustomNames(),c&&g.GC$.each(c,function(a,b){d.push({name:b.Cj,description:b.kT})}),d},a.prototype.q2=function(a){var b=[];return a.forEach(function(a){var c,e,f=a.tables;if(f&&(c=f.all()))for(e=0;e<c.length;e++)b.push({name:c[e].name(),description:d.sR().Fbx_TableName_Description+c[e].name()})}),b},a.prototype.wMc=function(a){var b,c=[],e=a.pJc;for(b=0;b<e.length;b++)c.push({name:e[b].name(),description:d.sR().Fbx_TableSheetName_Description+e[b].name()});return c},a.prototype.s2=function(a,b){var c,d,e,f;for(a=v(a),q.Bb(a,"[")&&(a=a.substr(a.lastIndexOf("[")+1),a=q.Gb(a,"@","")),c=[],d=b&&b.length,f=0;f<d;f++)e=b[f],0===v(Z(e.name)).indexOf(a)&&c.push(e);return c},a.prototype.t2=function(){var a,b,c,d,e,f=this.caret();if(f<=0)return"";if(a=this.S0,b=a&&a.length,b>0)for(c=0,d=void 0,e=0;e<b;e++){if(d=a[e],c+d.text.length>=f)return d.text.substring(0,f-c);c+=d.text.length}return""},a.prototype.u2=function(){var a,b,c,d,e,f,g,h,j,k=this.caret(),l=this.S0,m=l&&l.length,n=[],o=0;for(b=0;b<m;b++){if(a=l[b],n.push(a),6===a.type)for(c=0;n.length>0;)if(d=n.pop(),6===d.type&&c++,5===d.type&&c--,0===c){n.length>0&&(d=n[n.length-1],d&&2===d.type&&n.pop());break}if(o+=a.text.length,o>=k)break}if(n.length>0)for(e=0;n.length>0;)if(a=n.pop(),8===a.type)e++;else if(2===a.type){for(f=v(a.text),g=this.n2(),h=g&&g.length,j=void 0,b=0;b<h;b++)if(j=g[b],v(Z(j.name))===f)return{func:j,activeParamterIndex:e,isFunc:j.isFunc};break}return i},a.prototype.c2=function(){var a,b,c,d,e,f,h,i,j=this,k=j.v2(),l=j.g1&&j.bW(j.text())&&k&&k.length>0&&!j.MH&&!j.T1;if(l&&!j.V4){for(j.w2(),a=j.Z0,k.length>8?(a.style.height="204px",a.style.overflowY="scroll"):(a.style.height="auto",a.style.overflowY=""),b="",c=k.length,d=void 0,e=0;e<c;e++)d=k[e],b+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+d.isFunc+">"+Z(d.name)+"</div><div class='gcsj-func-ac-row-description'>"+(d.description||"")+"</div></div>";f=g.GC$(j.Z0),f.html(b).show(),j.R1=!0,h=f.find(".gcsj-func-ac-row"),h.length>0&&(i="gcsj-ac-row-active",g.GC$(h[0]).addClass(i),h.bind("mouseover",function(){h.removeClass(i),g.GC$(this).addClass(i)}),h.bind("click",function(){j.a2()})),j.SH()}else j.z2()},a.prototype.v2=function(){var a,b,c,e,f,g,h,i=this,j=i.s1(i.caret()),k=j&&j.text,l=[],m=i.S0.indexOf(j);if(j&&14===j.type)return l;if(a=i.A2(m),a.length>0){b=JSON.parse(JSON.stringify(d.sR().B2)),c=d.getMapping()&&d.getMapping().tableFunctionsMapping,e=[];for(f in b)g=c&&c[b[f].name],g&&(b[f].name=g),e.push(b[f]);if(l=l.concat(a).concat(e),q.jb(k,"[")||q.jb(k,"[@"))return l}else l=this.n2();return k=i.t2(),h=[],k&&(h=i.s2(k,l)),h},a.prototype.A2=function(a){var b,c,d,e,f,h,j,k,l=[],m=this.S0,n=m&&m.length;if(a<0||a>=m.length)return l;if(b=this.OC,c=b&&g.sJc(b),d={},void 0!==a&&a!==i||(a=n),c&&(e=m[a],f=c.tables,h=f&&f.findByName(q.Ib(e.text,"[")),s(h)&&(h=b.getSheetTab(q.Ib(e.text,"["))),void 0!==h&&h!==i&&!d[h])){for(d[h]=!0,j=0,k="";k!==i;)k=h.getColumnName(j),j++,k!==i&&l.push({name:k,description:""});if(l.length>0)return l}return l},a.prototype.z2=function(){g.GC$(this.Z0).hide(),this.R1=!1},a.prototype._1=function(a){var b,c,d,e,f,h,i=g.GC$(this.Z0).find(".gcsj-func-ac-row"),j=i.length;if(0!==j){if(b="gcsj-ac-row-active",c=0,a)for(d=0;d<j;d++)if(g.GC$(i[d]).hasClass(b)){c=d+a;break}e=g.GC$(this.Z0).scrollTop(),i.removeClass(b),f=0,j>0&&(f=i[0].offsetHeight),c=k(c,0),c=l(c,j-1),h=i[c],g.GC$(h).addClass(b),h.offsetTop+h.offsetHeight>g.GC$(this.Z0).scrollTop()+g.GC$(this.Z0).height()?g.GC$(this.Z0).scrollTop(g.GC$(this.Z0).scrollTop()+f):h.offsetTop<g.GC$(this.Z0).scrollTop()?g.GC$(this.Z0).scrollTop(h.offsetTop):g.GC$(this.Z0).scrollTop(e)}},a.prototype.a2=function(){var a,b,c,d,e,f,h,j,k,l,m,n,o,p,r,s=this,t=g.GC$(s.Z0).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),u=t.text(),v="true"===t.attr("isFunc");if(u){for(a=s.caret(),b=s.S0,c=b&&b.length,d=0,e=0,f=0,h=i;f<c&&(h=b[f],e=h.text.length,!(d+e>=a));)f++,d+=e;j=a-d,k=h.text,l=0,m=0,q.Bb(k,"[")?(l=k.lastIndexOf("[",j-1),l===-1?(l=k.indexOf("["),l===-1?h.text=u:h.text=u+k.substr(l),l=0):(l++,"@"===k.charAt(l)&&(l+=1),m=k.indexOf("]",j),m===-1&&(m=k.length),h.text=k.substring(0,l)+u+k.substr(m))):(h.text=u,n=k.substr(j),n&&(o=s.T0("="+n),o.length>1&&b.splice(f+1,0,o[1]))),v?h.type=2:h.type=11,p=f+1,r=b[p],!v||r&&5===r.type||b.splice(p,0,{text:"(",type:5}),s.z2(),s.qo.focus(),s.z1(),s.caret(d+u.length+l+(v?1:0)),s.S1(),s.S0=s.T0(s.text()),s.Wq(C,{})}},a.prototype.S1=function(){var a,b,c,e,f,h,j,k,m,n,o,p,q,r,s,t,u,v=this;if(v.R1&&v.z2(),a=v.u2(),a===i||a.isFunc!==!0)return void v.w2();if(b=v.w1(),c=v.h1&&v.bW(v.text())&&a&&!v.MH&&!v.T1,c&&!v.V4){for(e=a.func,f=e.parameters,h=f&&f.length,j=l(h-1,a.activeParamterIndex),k=void 0,m="",n=0;n<h;n++)k=f[n],o=k.name,k.repeatable&&(o+=b+"..."),k.optional&&(o="["+o+"]"),p=n===h-1?"":b+" ",o=n===j?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+o+"</span>"+p:"<span class='gcsj-func-help-paramter'>"+o+"</span>"+p,m+=o;q="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+Z(e.name)+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+m+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div>",r="<div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+d.sR().Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+(e.description||"")+"</div></div>",s="<div class='gcsj-func-help-section-content'>"+r+"</div>",t="<div class='gcsj-func-help-body'>"+s+"</div>",u=q+t,g.GC$(v.$0).html(u).show(),v.W1=!0,v.SH()}else v.w2()},a.prototype.w2=function(){g.GC$(this.$0).hide(),this.W1=!1},a.prototype.close=function(){this.z2(),this.w2()},a.prototype.BH=function(a,b){var c,d,e,f,g,h;return!this.MH&&(c=a.ctrlKey||a.shiftKey||a.altKey||a.metaKey,d=a.keyCode,e=a.ctrlKey,f=a.altKey,g=a.metaKey,h=a.srcElement||a.target,h&&b&&b.isEditing&&"gcAttachedFormulaTextBox"===h.getAttribute("gcUIElement")?67===d&&(e||g)&&!f||88===d&&(e||g)&&!f:this.R1&&!c&&(d===G.down||d===G.up||d===G.tab))},a.prototype.SH=function(){var a,b,c,d,e,f,j,k,l,m,n,o,q,r,s,t=this,u=i;if(t.R1?u=t.Z0:t.W1&&(u=t.$0),u){if(a=g.GC$(t.qo),b=g.GC$(u),c=h.G0.H0,c&&c.kj)return d=c.kj.getCellRect(c.nT,c.Mk),e=c.f1,void b.css("top",d.y+d.height+e.top).css("left",d.x+e.left);f=a.parent(),j=a.outerHeight(),t.Dia(t.qo)&&(f=f.parent(),j=f.outerHeight()),k=f.css("top"),l=parseFloat(k),isNaN(l)||(k=l),m=f.css("left"),"auto"===k&&(k=a.offset().top,m=a.offset().left),n=k+j,o=g.GC$(p.body).outerHeight(),q=b.outerHeight(),r=n+q,r>o&&(s=k-q,s>=0&&(n=s)),b.css("top",n).css("left",m)}},a.prototype.focus=function(){g.GC$(this.qo).focus()},a.prototype.V0=function(a){var b,c,d,e,f=this,g="",h="",i=a&&a.length,j=0;for(c=0;c<i;c++)b=a[c],d="",11===b.type&&(d=" style='color: "+f.o1(j)+"'",j++),f._0.innerText=b.text,g+="<span"+d+" class='gcsj-func-color-text'>"+f._0.innerHTML+"</span>",h+=b.text;if(h||f.text())if(e=f.qo,g)e.innerHTML="<span class='gcsj-func-color-content'>"+g+"</span>";else for(;e.firstChild;)e.removeChild(e.firstChild)},a.prototype.e1=function(a,b){var c,d,e,f=g.GC$(a).find(".gcsj-func-color-content .gcsj-func-color-text"),h=f.length;for(b=k(0,b),e=0;e<h;e++)if(c=f[e],d=c.innerText,b-=d.length,b<=0)return{node:c,offset:d.length+b};return d?{node:c,offset:d.length}:i},a.prototype.iIb=function(a,b){var c=o.getSelection(),d=this.qo.children[0],e=document.createRange();e.setStart(d,a),e.setEnd(d,b),c.removeAllRanges(),c.addRange(e)},a.prototype.Jka=function(a){var b=this,c=b.qo,d=b.Cia(c),e=b.text();d&&e&&(e=a?e.substr(0,e.length-2):e,b.Ac.push(e))},a.prototype.nLb=function(a,b){var c,d,e,f,g,h,i,j;if(b)for(c=0,d=0,e=0,f=b.length,g=0;g<a.length;g++){for(h=a[g].text,d;d<f;d++)if(i=b[d].toUpperCase(),j=h[e]?h[e].toUpperCase():void 0,i===j)e+=1;else{if("\n"!==i)break;d+1<f&&b[d+1]===O&&(d+=1)}a[g].text=b.substring(c,d),c=d,e=0}return a},a.prototype.mLb=function(a){var b,c,d,e,f;if("="===a[0]&&a.indexOf("\n")!==-1){for(b=[],c=a.length,d=!1,e=0;e<c;e++)f=a[e],'"'===f&&(d=!d),d?b.push(f):"\n"!==f?b.push(f):e+1<c&&a[e+1]===O&&(e+=1);return b.join("")}},a}(),b.FormulaTextBox=S;function ea(){
         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
      66 | var a,b,c,d=o.getSelection();d.rangeCount>0&&(a=d.getRangeAt(0),b=p.createElement("span"),b.innerHTML="<br/>"+O,a.insertNode(b),c=p.createRange(),c.setStartAfter(b),c.setEndAfter(b),c.collapse(!1),d.removeAllRanges(),d.addRange(c))}function fa(a){return"gcAttachedFormulaTextBox"===a.target.getAttribute("gcuielement")}},"./dist/plugins/group/group-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),b.Commands=e.Commands,f=e.Commands.ActionBase,g=e.GC$,h="outlineColumn",i="removeColumnOutline",j="expandColumnOutline",k="expandColumnOutlineForLevel",l="outlineRow",m="removeRowOutline",n="expandRowOutline",o="expandRowOutlineForLevel",p=d.Common.j.Fa;function E(a){var b=a.kj;return a.ML?b.rowOutlines:b.columnOutlines}function F(a){var b,c,d,e,f,g=this,h=!1;return(a?g.canExecute():g.canUndo())&&(b=g.kj,c=g.VQ.index,d=g.VQ.count,e=E(g),b&&e&&!p(c)&&!p(d)&&(f=a?e.group:e.ungroupRange,g.Lz(b,!0),f.call(e,c,d),g.Mz(b,!0),h=!0)),h}q=function(a){D(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.ML=d,e}return b.prototype.execute=function(){return F.call(this,!0)},b.prototype.undo=function(){return F.call(this,!1)},b}(f),r=function(a){D(b,a);function b(b,c){return a.call(this,b,c,!1)||this}return b}(q),s=function(a){D(b,a);function b(b,c){return a.call(this,b,c,!0)||this}return b}(q),t=function(a){D(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.ML=d,e}return b.prototype.execute=function(){var a,b,c,d,f,g=this,h=g.kj,i=h.ITa,j=!1;return g.canExecute()&&(a=g.VQ,b=a.index,c=a.count,d=E(g),h&&d&&!p(b)&&!p(c)&&(i.startTransaction(),g.Lz(h,!0),d.ungroupRange(b,c),g.Mz(h,!0),f=e.Commands.bWa(h.name()),a[f]=i.endTransaction(),j=!0)),j},b.prototype.undo=function(){var a,b,c=this,d=!1,f=c.kj;return c.canUndo()&&(a=e.Commands.bWa(f.name()),b=c.VQ[a],f&&b&&(c.Lz(f,!0),f.ITa.undo(b),c.Mz(f,!0),d=!0)),d},b}(f),u=function(a){D(b,a);function b(b,c){return a.call(this,b,c,!1)||this}return b}(t),v=function(a){D(b,a);function b(b,c){return a.call(this,b,c,!0)||this}return b}(t);function G(a,b,c,d,e){var f=0,g;for(g=b;g<=c&&g<d;g++)f+=e.call(a,g)*a.zoom();return f}function H(a,b,c,d,e){var f=0,g;for(g=b;g<d&&f<c;g++)b++,f+=e.call(a,g)*a.zoom();return b>=d?d-1:b}function I(a,b,c,d,e){if(b<d)return d;if(b>e)return e;for(var f=b;f<=e;f++)if(c.call(a,f))return f;return-1}function J(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=this,v=u.kj,w=c.index,x=b?v.getRowCount():v.getColumnCount(),y=void 0;w<0||w>=x||(d=E(u),e=1===d.direction(),f=v.am(),g=b?v.frozenRowCount():v.frozenColumnCount(),h=b?v.frozenTrailingRowCount():v.frozenTrailingColumnCount(),i=b?f.pKc:f.sKc,j=b?v.qKc:v.tKc,k=b?v.getRowHeight:v.getColumnWidth,l=b?v.getViewportTopRow:v.getViewportLeftColumn,m=b?v.getViewportHeight:v.getViewportWidth,n=l.call(v,1),r=d.find(e?w-1:w+1,c.level),r&&(s=e?r.start:w,t=e?w:r.end,e?(a?s=w:s<g&&(s=g),s<n&&(n=s),t>=x-h&&(t=x-h-1),o=m.call(v,1),o+=j?0:i,p=G(v,n,t,x,k),p>o&&(n=H(v,n,p-o,x,k)),q=I(v,n,k,g,x-1)):(a?t=w:t>=x&&(t=x-1),t>=x-h&&(t=x-h-1),s<n?q=I(v,s,k,g,x-1):(o=m.call(v,1),o+=j?0:i,p=G(v,n,t,x,k),p>o&&(q=I(v,s,k,g,x-1)))),b&&q!==y?(v.lq=q,v.os()):b||q===y||(v.qq=q,v.qs())))}function K(a){var b,c,d,e,f,g,h,i=this,j=!1;return(a?i.canExecute():i.canUndo())&&(b=i.kj,c=i.VQ,d=E(i),e=c.collapsed,f=c.index,g=c.level,!b||!d||p(e)||p(f)||p(g)||(i.Lz(b,!0),a||(e=!e),h=1===d.direction()?d.find(f-1,g):d.find(f+1,g),h&&d.setCollapsed(f,e),J.call(i,e,i.ML,c),i.Mz(b,!0),j=!0)),j}w=function(a){D(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.ML=d,e}return b.prototype.execute=function(){return K.call(this,!0)},b.prototype.undo=function(){return K.call(this,!1)},b}(f),x=function(a){D(b,a);function b(b,c){return a.call(this,b,c,!1)||this}return b}(w),y=function(a){D(b,a);function b(b,c){return a.call(this,b,c,!0)||this}return b}(w),z=function(a){D(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.ML=d,e}return b.prototype.execute=function(){var a,b,c,d,f=this,g=f.kj,h=!1;if(f.canExecute()&&(a=void 0,b=f.VQ.level,c=E(f),g&&c&&!p(b))){for(g.ITa.startTransaction(),f.Lz(g,!0),g.suspendCalcService(),a=0;a<b;a++)c.expand(a,!0);c.expand(b,!1),g.resumeCalcService(!0),f.Mz(g,!0),d=e.Commands.bWa(g.name()),f.VQ[d]=g.ITa.endTransaction(),h=!0}return h},b.prototype.undo=function(){var a,b,c,d=this,f=!1;return d.canUndo()&&(a=d.kj,b=e.Commands.bWa(a.name()),c=d.VQ[b],a&&c&&(d.Lz(a,!0),a.ITa.undo(c),f=!0,d.Mz(a,!0))),f},b}(f),A=function(a){D(b,a);function b(b,c){return a.call(this,b,c,!1)||this}return b}(z),B=function(a){D(b,a);function b(b,c){return a.call(this,b,c,!0)||this}return b}(z),C=e.Commands.h4,e.Commands[h]={canUndo:!0,execute:function(a,b,c){return C(a,r,b,c)}},e.Commands[l]={canUndo:!0,execute:function(a,b,c){return C(a,s,b,c)}},e.Commands[i]={canUndo:!0,execute:function(a,b,c){return C(a,u,b,c)}},e.Commands[m]={canUndo:!0,execute:function(a,b,c){return C(a,v,b,c)}},e.Commands[j]={canUndo:!0,execute:function(a,b,c){return C(a,x,b,c)}},e.Commands[n]={canUndo:!0,execute:function(a,b,c){return C(a,y,b,c)}},e.Commands[k]={canUndo:!0,execute:function(a,b,c){return C(a,A,b,c)}},e.Commands[o]={canUndo:!0,execute:function(a,b,c){return C(a,B,b,c)}},e.Commands.SL=function(a){a.register(h,e.Commands[h]),a.register(l,e.Commands[l]),a.register(i,e.Commands[i]),a.register(m,e.Commands[m]),a.register(j,e.Commands[j]),a.register(n,e.Commands[n]),a.register(k,e.Commands[k]),a.register(o,e.Commands[o])}},"./dist/plugins/group/group.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/group/group-actions.js")),d(c("./dist/plugins/group/group.js")),d(c("./dist/plugins/group/group.ns.js"))},"./dist/plugins/group/group.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("./dist/plugins/group/group-actions.js"),g=c("./dist/plugins/group/group.ns.js"),h={},i=null,j=void 0,k=Math.max,l=Math.min,m=Math.round,n=Math.ceil,o=e.GC$,p=o.each,q=e.Im.Lm,r=d.Common.k,s=r._b,t=r.$b,u=r.ac,v=8.25,w=17,x=4,y=e.Ul.Ol,z=d.Common.j.Fa,A=e.Ul.Pl,B=e.Ul.fp,C="rangegroup",D="gc-group",E=D+"-box",F=E+"-expand",G=E+"-collapsed",H=D+"-line",I=D+"-dot",J="rgh",K="cgh",L="rg",M="cg",N=new d.Common.ResourceManager(g.SR,"Outlines"),b.getSR=N.getResource.bind(N),O={Gt:function(){var a,b,c,d,e,f,g,h=this,i=h.TL;return i?i:(a=h.options,b=a.sheetAreaOffset,c={x:b.left,y:b.top,width:0,height:0,rowMaxLevel:-1,colMaxLevel:-1},d=h.rowOutlines,e=h.columnOutlines,f=w*h.zoom(),h.showRowOutline()&&d&&!d.iT()&&(g=d.getMaxLevel(),g>=0&&(c.width=f*(g+2)+x,c.rowMaxLevel=g)),h.showColumnOutline()&&e&&!e.iT()&&(g=e.getMaxLevel(),g>=0&&(c.height=f*(g+2)+x,c.colMaxLevel=g)),h.TL=c,c)},showRowOutline:A("showRowOutline",!0,function(){this.$p()}),showColumnOutline:A("showColumnOutline",!0,function(){this.$p()})},o.extend(e.Worksheet.prototype,O);function Y(a,b){a.Wq(e.Events.RangeGroupStateChanging,b)}function Z(a,b){a.Wq(e.Events.RangeGroupStateChanged,b)}function $(a,b){var c,d=a.options,e=d.isProtected;return!e||(c=d.protectionOptions,b?c.allowOutlineRows:c.allowOutlineColumns)}function _(a,c){var d,f,g,h=c.what===J,i=$(a,h);a.isEditing&&a.isEditing()||!i?i||a.Os(e.InvalidOperationType.groupProtected,b.getSR().Exp_GROUP_PROTECTED):(d=c.info.index,f=h?"expandRowOutlineForLevel":"expandColumnOutlineForLevel",g=ba(a,h,-1,d,!0),Y(a,g),g&&g.cancel===!1&&(a.wu().execute({cmd:f,sheetName:a.name(),level:d}),Z(a,ba(a,h,-1,d,!1))))}function aa(a,c){var d,f,g,h,i,j,k=c.what===L,l=$(a,k);a.isEditing&&a.isEditing()||!l?l||a.Os(e.InvalidOperationType.groupProtected,b.getSR().Exp_GROUP_PROTECTED):ga(k,a)&&(d=c.info,f=d.index,g=f,h=d.level,i=void 0,j=k?"expandRowOutline":"expandColumnOutline",1===d.lineDirection?f--:f++,i=ba(a,k,f,h,!0),Y(a,i),i&&i.cancel===!1&&(a.wu().execute({cmd:j,sheetName:a.name(),index:g,level:h,collapsed:d.isExpanded}),Z(a,ba(a,k,f,h,!1))))}function ba(a,b,c,d,e){var f={sheet:a,sheetName:a.name(),isRowGroup:b,index:c,level:d};return e&&(f.cancel=!1),f}function ca(a,b){var c,d,f,g,h=this,j=h.Gt(),k=j.width,l=j.height;return k||l?(c=h.am(),d=new e.Rect(j.x,j.y,k,c.height),f=new e.Rect(j.x,j.y,c.width,l),d.contains(a,b)||f.contains(a,b)?(g=da(h,a,b,j.rowMaxLevel,!0),g||(g=da(h,a,b,j.colMaxLevel,!1)),g||{what:"empty",info:i}):i):i}P=function(){function a(a,b,c){var d=this;d.PADDING=2,d.kj=a,d.ML=b,d.ZL=y(c)?c:ga(b,a).getMaxLevel()}return a.prototype._L=function(a){var b,c,d,e,f,g,h,i,j,l,n,o,p,r,s,t,u,w,x,y,z,A,C,F,G,H,I,J=this,K=J.kj,L=J.ZL;if(!(L<0)&&(b=J.ML,c=K.Gt(),d=fa.call(J,c,b),d)){if(e=L+2,f=J.PADDING,g=K.options,h=c.width,i=c.height,j=c.x,l=c.y,n=K.am(),o=n.width,p=n.height,r=n.Cr,s=n.Br,t=n.zr,u=n.Ar,a.save(),a.fillStyle=q(D).backgroundColor,a.strokeStyle=q(D).borderTopColor,a.lineWidth=1,a.fillRect(j,l,b?h:o,b?p:i),a.strokeRect(j-.5,l-.5,b?h:o+1,b?p+1:i),b?a.strokeRect(j-.5,u-.5,h,r):a.strokeRect(t-.5,l-.5,s,i),w=(b?r:s)-d,y=k(0,(b?u-g.sheetAreaOffset.top:t-g.sheetAreaOffset.left)+w/2),z=f,b&&(C=y,y=z,z=C),a.restore(),x=b?g.colHeaderVisible:g.rowHeaderVisible,a.save(),x&&w>=0)for(A=0;A<e;A++)F=d-1,G=void 0,H=j+y,I=l+z,b?H=m(H)+.5:I+=.5,a.fillStyle=q(E).backgroundColor,a.fillRect(H,I,F,F),a.font=v*K.zoom()+"pt Arial",a.strokeStyle=q(E).borderTopColor,a.strokeRect(H,I,F,F),a.fillStyle=q(E).color,G=B(a.font),J.pM(a,H,I,F,d,A+1,G),b?y+=d:z+=d;a.restore()}},a.prototype.pM=function(a,b,c,d,e,f,g){var h=""+f,i=a.measureText(h).width;i<=d&&g<=e&&(a.textBaseline="middle",a.fillText(h,b+(d-i)/2,c+d/2))},a.prototype.WL=function(a,b,c){var d,e,f,g,h=this,j=h.kj,k=h.ZL;return k<0?i:(d=k+2,e=j.am(),f=j.options,g=f.sheetAreaOffset,c?h.qM(j,a,b,c,f.colHeaderVisible,e.Cr,e.Ar-g.top,d):h.qM(j,a,b,c,f.rowHeaderVisible,e.Br,e.zr-g.left,d))},a.prototype.qM=function(a,b,c,d,f,g,h,j){var l,m,n,o,p,q=this,r=a.Gt(),s=fa.call(q,r,d),t=g-s;if(s&&f&&t>=0)for(l=k(0,h+t/2),m=q.PADDING,d&&(p=l,l=m,m=p),o=0;o<j;o++){if(n=new e.Rect(r.x+l,r.y+m,s,s),n.contains(b,c))return{index:o};d?l+=s:m+=s}return i},a}(),Q=function(){function a(a,b,c,d){var e=this;e.PADDING=2,e.LINE_SIZE=2,e.START_LINE_SIZE=6,e.bM=[],e.cM=[],e.dM=[],e.kj=a,e.ML=b,e.eM=c,e.ZL=y(d)?d:ga(b,a).getMaxLevel()}return a.prototype.YL=function(){var a,b=this;b.ZL!==-1&&(a=b.fM(0,b.ML),p(a,function(a,c){b.gM(c)}))},a.prototype.gM=function(a){var b,c,d,e,f,g,h,j,m,n,o,q,r,s,t,v,w,x,y=this,z=y.kj,A=y.ML,B=ga(A,z).direction(),C=1===B,D=0===B,E=y.hM(!0,A),F=y.hM(!1,A),G=a.start,H=a.end,I=a.level;if(C?b=H+1:D&&(b=G-1),0===a.state()){if(c=!0,d=a.parent,d&&(D&&G===d.start||C&&H===d.end)&&(c=!1),c&&y.iM(!0,I,b,E,F,B),G<=F&&H>=E){for(e=k(E,G),f=l(F,H),g=void 0,h=void 0,c&&(g={start:e,end:f,level:I,startLine:i},(C&&e===G||D&&f===H)&&(g.startLine=!0),y.bM.push(g)),m=[],n=a.children,h=e;h<=f;h++)m.push(!1);for(p(n,function(a,b){var c=b.start,d=b.end,f;if(1===b.state())for(j=c;j<=d;j++)m[j-e]=!0;f=C?d+1:d-1,m[f-e]=!0,y.gM(b)}),o=!0,h=0;h<u(n);h++){if(q=n[h],r=q.start,s=q.end,t=r===G,v=s===H,t&&v){o=!1;break}if(C&&v||D&&t)for(j=r;j<=s;j++)m[j-e]=!0}if(o)for(w=e;w<=f;w++)m[w-e]||(x={index:w,level:I+1},y.cM.push(x))}}else 1===a.state()&&y.iM(!1,I,b,E,F,B)},a.prototype.iM=function(a,b,c,d,e,f){var g={isExpanded:a,level:b};a&&(g.paintLine=!0),c>=d&&c<=e&&(g.index=c,g.lineDirection=f,this.dM.push(g))},a.prototype.jM=function(a){var b=this,c=b.kj,d=b.eM;return b.ML?c.Gr(d).findRow(a):c.Hr(d).findCol(a)},a.prototype.aM=function(a){var b,c,d,e,f,g,h,i=this;i.ZL!==-1&&(b=i.kj.Gt(),c=i.ML,d=fa.call(i,b,c),d&&(e=parseInt(q(H).borderTopWidth,10),e=isNaN(e)?2:e,f=m(d/3),g=i.PADDING,h=(d-e)/2+g,a.save(),a.fillStyle=q(D).color,i.kM(a,i.cM,c,b,d,h,e),c?i.D_a(a,i.bM,c,b,d,h,e,f):i.E_a(a,i.bM,c,b,d,h,e,f),i.mM(a,i.dM,c,b,d,h,e,g),a.beginPath(),a.restore()))},a.prototype.kM=function(a,b,c,d,e,f,g){var h,i,j,l=this,m=2,n=l.kj,o=n.options,r=o.sheetAreaOffset,s=r.left,t=r.top;a.save(),a.fillStyle=q(I).color,j=l.bM,p(b,function(b,n){var o,p,q,r,u,v=n.index,w=n.level,x=l.jM(v);x&&(l.C0a(j,v,w)||(o=c?x.y:x.x,p=(c?x.height:x.width)-g,p>=0&&(h=o+k(0,p/2),i=n.level*e+f,c?(q=h,h=i+.5,i=q,i-=t):(i+=.5,h-=s),a.strokeStyle="transparent",a.lineWidth=0,r=d.x+h,u=d.y+i,r%1!==0&&(r+=.5),u%1!==0&&(u+=.5),a.strokeRect(r,u,m,m),a.fillRect(r,u,m,m))))}),a.restore()},a.prototype.C0a=function(a,b,c){var d,e=!1,f=u(a);for(d=0;d<f;d++)if(a[d].level===c&&a[d].start<=b&&a[d].end>=b){e=!0;break}return e},a.prototype.D_a=function(a,b,c,d,e,f,g,h){var i,j,l,m,o,p,r,s,t,v,w,x,y,z,A,B,C;for(a.save(),a.strokeStyle=q(H).borderTopColor,a.fillStyle=q(H).borderTopColor,a.lineWidth=g,i=this,j=i.kj,l=ga(c,j).direction(),o=j.options,p=o.sheetAreaOffset,r=p.top,m=0;m<u(b);m++){s=b[m],t=s.start,v=s.end,w=void 0,x=void 0;do w=i.jM(t),t++;while(!w&&t<=v);do x=i.jM(v),v--;while(!x&&v>=t);(w||x)&&(w?x||(x=w):w=x,y=w.y,z=s.level*e+f,A=g,B=k(0,x.y+x.height-w.y),1===l?y+=1:y-=1,y-=r,a.beginPath(),C=d.x+z+A/2,C=n(C),a.moveTo(C,d.y+y),a.lineTo(C,d.y+y+B),a.stroke(),s.startLine&&e/2-2*g>0&&(0===l&&(y=y+B-g-r),y>=w.y-r&&y<x.y+x.height-r&&a.fillRect(n(d.x+z),d.y+y,h,g)))}a.restore()},a.prototype.E_a=function(a,b,c,d,e,f,g,h){var i,j,l,m,o,p,r,s,t,v,w,x,y,z,A,B;for(a.save(),a.strokeStyle=q(H).borderTopColor,a.fillStyle=q(H).borderTopColor,a.lineWidth=g,i=this,j=i.kj,l=ga(c,j).direction(),o=j.options,p=o.sheetAreaOffset,r=p.left,m=0;m<u(b);m++){s=b[m],t=s.start,v=s.end,w=void 0,x=void 0;do w=i.jM(t),t++;while(!w&&t<=v);do x=i.jM(v),v--;while(!x&&v>=t);(w||x)&&(w?x||(x=w):w=x,y=w.x,z=s.level*e+f,A=k(0,x.x+x.width-w.x),1===l&&(y+=1),y-=r,B=d.y+z+g/2,B=n(B),a.beginPath(),a.moveTo(d.x+y,B),a.lineTo(d.x+y+A,B),a.stroke(),s.startLine&&e/2-2*g>0&&(0===l&&(y=y+A-g-r),y>=w.x-r&&y<x.x+x.width-r&&a.fillRect(d.x+y,n(d.y+z),g,h)))}a.restore()},a.prototype.r0a=function(a){var b=q(a).backgroundImage;return"none"===b&&(b=""),b&&(b=b.split(",")[0],b=b.replace(/url\(['"]?([^'"\)]+)['"]?\)/,"$1"),b=b.trim()),b},a.prototype.mM=function(a,b,c,d,e,f,g,h){var i,j,m,o,p,r,s,t,v,w,x,y,z,A,B,C,D,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z=this,$=Z.kj,_=$.options,aa=_.sheetAreaOffset.left,ba=_.sheetAreaOffset.top,ca=q(E).borderTopColor,da=q(E).backgroundColor,ea=q(E).color,fa=q(H).borderTopColor,ga=1,ha=$.vu(),ia=Z.r0a(F),ja=Z.r0a(G);for(ia&&!ha.ko(ia)&&ha.fo(ia),ja&&!ha.ko(ja)&&ha.fo(ja),j=ja&&ha.lo(ja),m=ia&&ha.lo(ia),o=q(F),p=q(G),r=m?o.backgroundColor:"",s=j?p.backgroundColor:"",t=m?o.borderTopColor:"",v=j?p.borderTopColor:"",i=0;i<u(b);i++)a.save(),A=b[i],B=Z.jM(A.index),B?(C=c?B.height:B.width,C<=0?a.restore():(D=k(0,(C-e)/2),I=void 0,J=void 0,K=(c?B.y-ba:B.x-aa)+D,L=A.level*e+h,M=l(e,C),N=e,O=void 0,P=void 0,Q=C-M,c?(R=K,K=L,L=R,S=M,M=N,N=S,O=.5,P=0):(O=0,P=.5),y=A.isExpanded?t:v,a.strokeStyle=y?y:ca,a.lineWidth=ga,x=A.isExpanded?r:s,x?a.fillStyle=x:a.fillStyle=da,a.fillRect(d.x+K,d.y+L,M,N),I=d.x+K+O,J=d.y+L+P,a.strokeRect(I,J,M,N),a.fillStyle=ea,w=A.isExpanded?ia:ja,Z.nM(a,A.isExpanded,w,I,J,M,N),a.restore(),A.paintLine&&Q>0&&(a.save(),a.strokeStyle=fa,K=c?B.y-ba:B.x-aa,L=A.level*e+f,T=0===A.lineDirection,U=c?g:D,V=c?D:g,c?(W=K,K=L,L=W,T&&(L+=D+N,V=Q-D)):T&&(K+=D+M,U=Q-D),a.beginPath(),a.lineWidth=g,X=n(d.x+K+g/2),Y=n(d.y+L+g/2),c?(a.moveTo(X,d.y+L),a.lineTo(X,d.y+L+V-ga)):(z=0,j&&!A.isExpanded&&(z=1),a.moveTo(d.x+K,Y),a.lineTo(d.x+K+O+U+z,Y)),a.stroke(),a.restore()))):a.restore()},a.prototype.nM=function(a,b,c,d,e,f,g){var h,i,j,k=this,l=this.kj,n=l.vu();if(c&&n.ko(c)){h=n.lo(c),i=h.width,j=h.height;try{a.drawImage(h,0,0,i,j,m(d),m(e),f-1,g-1)}catch(a){}}else k.u0a(a,b,d,e,f,g)},a.prototype.u0a=function(a,b,c,d,e,f){var g,h,i=m(e/4),j=m(e/2);b||(g=m(f/4),h=m(f/2),a.fillRect(c+e/2-1,d+g,2,f-h)),a.fillRect(c+i,d+f/2-1,j,2)},a.prototype.fM=function(a,b){var c,d,e,f=this,g=f.kj,h=[],i=-1,j=-1,m=ga(b,g),n=b?g.Gr:g.Hr,o=n.call(g,f.eM),p=u(o);for(p&&(d=o[0],e=o[p-1],i=k(0,(b?d.row:d.col)-1),j=b?l(g.getRowCount(),e.row+2):l(g.getColumnCount(),e.col+2));i<j;)c=m.find(i,a),c?(i=c.end+1,h.push(c)):i++;return h},a.prototype.hM=function(a,b){var c=-1,d=this,e=d.kj,f=d.eM,g=e.frozenRowCount(),h=e.frozenColumnCount(),i=e.frozenTrailingRowCount(),j=e.frozenTrailingColumnCount(),k=e.getRowCount(),l=e.getColumnCount();return 0===f?c=a?0:(b?g:h)-1:1===f?c=a?b?g:h:(b?k-i:l-j)-1:2===f&&(c=a?b?k-i:l-j:(b?k:l)-1),c},a.prototype.oM=function(a){a&&this.kj.CH&&(a.x-=2,a.y-=2,a.width+=4,a.height+=4)},a.prototype.XL=function(a,b,c){var d,f,g,h,j,m,n,o,p,q,r,s,t,v,w,x,y=this,z=y.ZL,A=y.kj,B=A.options,C=B.sheetAreaOffset.left,D=B.sheetAreaOffset.top;if(z<0)return i;if(d=A.Gt(),f=fa.call(y,d,c),!f)return i;for(g=y.dM,m=0;m<u(g);m++)if(n=g[m],o=n.index,p=n.level*f+y.PADDING,q=y.jM(o),q&&(h=c?q.height:q.width,!(h<=0)&&(r=l(f,h),s=f,t=(c?q.y-D:q.x-C)+k(0,(h-f)/2),v=p,c&&(w=r,r=s,s=w,x=t,t=v,v=x),j=new e.Rect(d.x+t+.5,d.y+v+.5,r,s),y.oM(j),j.contains(a,b))))return n;return i},a}();function da(a,b,c,d,e){var f,g,h=new P(a,e,d),j=h.WL(b,c,e);if(j)return{what:e?J:K,info:j};for(f=ea(a,e,d),g=0;g<=2;g++)if(j=f[g].XL(b,c,e))return{what:e?L:M,info:j};return i}function ea(a,b,c){var d=[new Q(a,b,0,c),new Q(a,b,1,c),new Q(a,b,2,c)],e;for(e=0;e<=2;e++)d[e].YL();return d}function fa(a,b){var c=b?a.width:a.height;return k(0,(c-2*this.PADDING)/(this.ZL+2))}function ga(a,b){return a?b.rowOutlines:b.columnOutlines}!function(a){a[a.backward=0]="backward",a[a.forward=1]="forward"}(R=b.OutlineDirection||(b.OutlineDirection={})),h.OutlineDirection=R,function(a){a[a.expanded=0]="expanded",a[a.collapsed=1]="collapsed"}(S=b.OutlineState||(b.OutlineState={})),h.OutlineState=S,T=function(){function a(a,b,c,d){var e=this;e.children=[],e.parent=i,e.model=a,e.start=b,e.end=c,e.level=d}return a.prototype.state=function(a){var b=this,c=b.model;return arguments.length?void(c&&c.expandGroup(b,0===a)):c?c.getState(b):0},a.prototype.contains=function(a){return this.start<=a&&a<=this.end},a.prototype.addChild=function(a){a&&(this.children.push(a),a.parent=this)},a}(),b.OutlineInfo=T,h.OutlineInfo=T,U=function(){function a(a){this.level=a?a.level:0,this.collapsed=!!a&&a.collapsed,this.viewCollapsed=!!a&&a.viewCollapsed}return a}();function ha(a,b,c){var d,e,f,g;if(c>0){for(d=a.items,e=void 0,f=void 0,g=[],e=0;e<c;e++)g.push(i);if(a.items=d=d.slice(0,b).concat(g,d.slice(b)),a.V3<=0&&b>0&&(f=d[b-1]))for(e=0;e<c;e++)d[b+e]=new U(f);na(a)}}function ia(a,b,c){c>0&&(a.items.splice(b,c),na(a))}function ja(a,b,c){for(var d,e,f,g,h=i,j=a.items,k=b,l=u(j);k<l&&(d=j[k],!d||d.level<c||(h||(h=new T(a,k,k,c)),d.level>c&&(e=ja(a,k,c+1),k=e.index,h.addChild(e.g)),k>h.end&&(h.end=k),!a.isGroupEnd(k,c)));k++);if(h)for(f=h.end+1,g=h.start;g<f;g++)j[g].groupInfo||(j[g].groupInfo=h);return{g:h,index:k}}function ka(a,b){return b>=-1&&b<u(a.items)}function la(a,b,c){var d,e,f=a&&a.items;if(f)for(d=f[b]&&f[b].groupInfo;d;){if(e=d.level,e===c)return d;if(!(e>c))break;d=d.parent}return i}function ma(a,b){switch(a){case"head":case"tail":return b===i;case"direction":return 1===b;case"itemsData":return 0===u(b);default:return!1}}function na(a){a.Zka=i,a.refresh()}function oa(a,b){!b&&a.Wka||(a.Zka=a.createRangeGroup(),qa(a))}function pa(a){a.Wka&&!a.Zka&&(a.Zka=a.createRangeGroup())}function qa(a,b){a.groupChangeHandler&&a.groupChangeHandler(b)}function ra(a,c,d){if(sa(a,c),!ka(a,c+d-1))throw Error(b.getSR().Exp_InvalidCount)}function sa(a,c){if(!ka(a,c))throw Error(b.getSR().Exp_InvalidIndex)}function ta(a,b){for(var c,d=a.parent;d&&(c=b?a.end===d.end:a.start===d.start);)a=d,d=d.parent;return a}V=function(){function a(a,b,c){var d=this;d.head=i,d.tail=i,d.Zka=i,d.items=Array(a),d.V3=0,d.wz=!0,d.kj=b,d.ML=c}return a.prototype.no=function(){this.kj=i},a.prototype.group=function(a,b){var c=this,d,e;for(ra(c,a,b),c.kj.ITa.vUa(c.ML),d=0;d<b;d++)e=a+d,c.items[e]?c.items[e].level++:c.items[e]=new U;c.Wka&&c.Zka&&(c.Zka=i),oa(c),c.wz=!1},a.prototype.Lia=function(){this.Wka=!0,this.Zka=i},a.prototype.Mia=function(){var a=this;a.Wka=!1,a.refresh()},a.prototype.ungroupRange=function(a,b){var c=this,d,e;for(ra(c,a,b),c.kj.ITa.vUa(c.ML),d=0;d<b;d++)e=c.items[a+d],e&&e.level>-1&&e.level--;oa(c)},a.prototype.ungroup=function(){var a=this,b=u(a.items);a.kj.ITa.vUa(a.ML),a.items=Array(b),oa(a),a.wz=!0},a.prototype.expand=function(a,c){var d,e,f,g,h,i;if(a<-1)throw Error(b.getSR().Exp_InvalidLevel);for(d=this,e=d.items,d.kj.ITa.vUa(d.ML),pa(d),g=d.kj.Cf(),g.suspend(),h=0,i=e.length;h<i;h++)e[h]&&(f=d.find(h,a),f&&d.expandGroup(f,c));g.resume(!1)},a.prototype.expandGroup=function(a,c){if(!a)throw Error(b.getSR().Exp_GroupInfoIsNull);var d=this,e=d.direction(),f=-1;d.kj.ITa.vUa(d.ML),0===e?f=a.start-1:1===e&&(f=a.end+1),d.setCollapsed(f,!c,a.level),d.kj.$p()},a.prototype.Xr=function(a){return!(!this.wz&&ka(this,a))||!this.isCollapsed(a)},a.prototype.isCollapsed=function(a){var b=this.items[a];return!!(b&&b.viewCollapsed&&b.level>-1)},a.prototype.find=function(a,b){var c=this,d;return pa(c),b===-1?d=c.Zka:(sa(c,a),d=la(c,a,b)),d},a.prototype.getLevel=function(a){var b=this.items[a];return b?b.level:-1},a.prototype.getCollapsed=function(a){var b=this.items[a];return!!b&&!!b.collapsed},a.prototype.B4=function(a,b,c,d){var e,f;for(e=b;e<=c;e++)f=a[e],f||(f=a[e]=new U,f.level=-1),f.viewCollapsed=d},a.prototype.setCollapsed=function(a,b,c){var d,e,f,g,h,i,k=this,l=!1,m=k.items,n=k.kj.ITa,o=[];if(n.vUa(k.ML),pa(k),a<0?(d=k.head,d||(d=k.head=new U)):a<u(m)?(d=m[a],d||(d=m[a]=new U,d.level=-1)):(d=k.tail,d||(d=k.tail=new U)),e=1===k.direction(),f=c!==j,f||d.collapsed===b?f&&(d.level===c-1&&(d.collapsed=b),l=!0,k.E4(a,b,c)):(d.collapsed=b,l=!0,k.E4(a,b,c)),l&&(a+=e?-1:1,h=k.find(a,k.getLevel(a)))){for(i=h.start;i<=h.end;i++)o.push(i);g={indexes:o}}qa(k,g)},a.prototype.dPa=function(a,b){var c,d=this.items;d[a]?d[a].collapsed!==b&&(d[a].collapsed=b):(c=d[a]=new U,c.level=-1,c.collapsed=b)},a.prototype.E4=function(a,b,c){var d,e,f,g,h,i,k,l,m,n,o=this,p=o.items,q=1===o.direction(),r=q?-1:1,s=c!==j,t=a+r,u=s?c:o.getLevel(t),v=la(o,t,u);if(v&&(d=q?v.end+1:v.start-1,d!==a&&(v=null)),z(v)&&(u=s?c:o.getLevel(a),v=la(o,a,u)),v)if(e=void 0,f=v.parent,b)s||(e=q?v.end+1:v.start-1,o.dPa(e,!0),v=ta(v,q)),o.B4(p,v.start,v.end,!0);else{for(g=!1,h=void 0;f;){if(h=q?f.end+1:f.start-1,p[h]&&p[h].collapsed&&p[h].level>-1){g=!0;break}f=f.parent}if(!g)for(s||(e=q?v.end+1:v.start-1,o.dPa(e,!1),v=ta(v,q)),o.B4(p,v.start,v.end,!1),i=[v],k=0;k>=0;)if(l=i[k],k--,h=q?l.end+1:l.start-1,p[h]&&p[h].collapsed&&p[h].level!==-1)o.B4(p,l.start,l.end,!0);else for(m=l.children,n=0;m&&n<m.length;n++)++k,i[k]=m[n]}},a.prototype.getMaxLevel=function(){var a=-1,b=this.items,c;return p(b,function(b,d){d&&(c=d.level,c>a&&(a=c))}),a},a.prototype.cB=function(a,b,c,d){var e,f,g,h,i;if(!(c<=0||a===b)){for(e=this,e.kj.ITa.vUa(e.ML),a<0&&(a=0),b<0&&(b=0),f=[],g=e.items,h=s(g,a-1);h>=0&&h<a+c;)i=new U(g[h]),f.push({index:h-a,value:i}),h=s(g,h);d&&t(g,a,c),t(g,b,c),p(f,function(a,c){g[b+c.index]=c.value}),na(e)}},a.prototype.bB=function(a,b,c,d,e){var f,g,h=this;if(h.kj.ITa.vUa(h.ML),b<0&&(b=0),c<0&&(c=0),f=[],a)for(g=s(a.items,b-1);g>=0&&g<b+d;)f[g-b]=new U(a.items[g]),g=s(a.items,g);t(h.items,c,d),f.length>0&&f.forEach(function(a,b){h.items[c+b]=a}),e&&t(a.items,b,d)},a.prototype.refresh=function(){this.wz||oa(this)},a.prototype.VL=function(a){var b=this,c=b.items,d=u(c),e=a-d;e<0?c.splice(a,-e):b.items=c.concat(Array(e)),na(b)},a.prototype.getState=function(a){var b=this,c=b.items,d,e=b.direction(),f=-1;return 0===e?f=a.start-1:1===e&&(f=a.end+1),d=f<0?b.head:f<u(c)?c[f]:b.tail,d&&d.collapsed?1:0},a.prototype.Ez=function(a,b){var c=this,d=c.items;a<0?(c.head||(c.head=new U),c.head.level=b):a<u(d)?(d[a]||(d[a]=new U),d[a].level=b):(c.tail||(c.tail=new U),c.tail.level=b),na(c)},a.prototype.suspendAdding=function(){this.V3++},a.prototype.resumeAdding=function(){this.V3--},a.prototype.createRangeGroup=function(){for(var a,b,c=this,d=c.items,e=u(c.items),f=new T(c,0,e-1,(-1)),g=0;g<e;)d[g]&&(d[g].groupInfo=i),g++;for(g=0;g<e;)d[g]?(a=ja(c,g,0),b=a.g,g=a.index+1,b&&b.level>-1&&f.addChild(b)):g++;return f},a.prototype.qec=function(a,b){return 1===this.direction()?b===a.end+1:b===a.start-1},a.prototype.rec=function(a,b,c,d){var e=this,f=-1,g=0;if(1===e.direction()&&(f=0,g=1),a===b)return e.qec(a,c)||e.qec(a,d)?{start:a.start,end:a.end,level:a.level}:{start:c,end:d,level:a.level};for(;a.level>b.level;){if(b===a.parent)return e.qec(b,d)?{start:b.start,end:b.end,level:b.level}:{start:a.start+f,end:d,level:a.level-1};a=a.parent}for(;a.level<b.level;){if(a===b.parent)return e.qec(a,c)?{start:a.start,end:a.end,level:a.level}:{start:c,end:b.end+g,level:b.level-1};b=b.parent}for(;a.level>=0;){if(a.parent===b.parent)return{start:a.start+f,end:b.end+g,level:b.level-1};a=a.parent,b=b.parent}return{start:a.start+f,end:b.end+g,level:b.level-1}},a.prototype.sec=function(a){var b,c,d,e=this,f=e.items,g=f[a];return b=1===e.direction()?f[a-1]:f[a+1],c=g?g.level:-1,d=b?b.level:-1,c<d?b&&b.groupInfo:g&&g.groupInfo},a.prototype.kec=function(a,b){var c,d,e=this,f=e.sec(a),g=e.sec(a+b-1);if(z(f)&&z(g))return{start:a,end:a+b-1,count:b,level:-1};if(!f||!g){for(c=f||g;c&&c.level!==-1;)c=c.parent;f||(f=c),g||(g=c)}return d=e.rec(f,g,a,a+b-1),d.count=d.end-d.start+1,d},a.prototype.pec=function(a,b){var c,d,e,f,g=this,h=g.items;for(c=a;c<a+b;c++)if(d=h[c]&&h[c].groupInfo&&h[c].groupInfo.level,!z(d)&&d>=0)return!0;return e=1===g.direction()?a-1:a+b,f=h[e]&&h[e].groupInfo&&h[e].groupInfo.level,!z(f)&&f>=0},a.prototype.tec=function(a){var b=this,c=b.items,d=c[a]&&c[a].groupInfo&&c[a].groupInfo.level;return z(d)?-1:d},a.prototype.uec=function(a,b,c){var d,e,f=this,g=[],h=[];for(d=a;d<a+b;d++)e=f.tec(d),e===c&&h.push(d),f.tec(d+1)<c&&h.length>0&&(g.push(h),h=[]);return h.length>0&&g.push(h),g},a.prototype.lec=function(a,b){var c,d,e,f,g=this;if(1===b)return g.uec(a.start,a.count,a.level);for(c=[],d=g.getMaxLevel(),e=2===b?a.level+1:a.level,f=d;f>=e&&f>=-1;f--)c=c.concat(g.uec(a.start,a.count,f));return c},a.prototype.nec=function(a,b,c){var d,e,f,g=this;for(d=a.length-1;d>=0;d--)e=a[d],e.collapse&&g.setCollapsed(e.head,!1),g.ungroupRange(e.start,e.count);for(d=a.length-1;d>=0;d--)e=a[d],f=r.Cb(b,e.head)+c,1===g.direction()?g.group(f-e.count,e.count):g.group(f+1,e.count),e.collapse&&g.setCollapsed(f,e.collapse)},a.prototype.mec=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,o=n.items;if(1===c)for(d=n.getMaxLevel(),e=b.level+1;e<=d;e++)a.splice.apply(a,[0,0].concat(n.uec(b.start,b.count,e)));else 2===c&&a.push.apply(a,n.uec(b.start,b.count,b.level));for(f=a.length,g=a[f-1].concat([]),h=[],e=f-2;e>=0;e--)i=o[a[e][0]],j=i.groupInfo,1===n.direction()?(k=j.end+1,l=r.Cb(g,k),g.splice.apply(g,[l,0].concat(a[e])),h.push({head:k,start:j.start,count:k-j.start,collapse:i.viewCollapsed})):(k=j.start-1,l=r.Cb(g,k),g.splice.apply(g,[l+1,0].concat(a[e])),h.push({head:k,start:j.start,count:j.end-k,collapse:i.viewCollapsed}));for(m=!1,e=0;e<b.count;e++)if(g[e]!==e+b.start){m=!0;break}return{array:g,isChanged:m,groupSwap:h}},a.prototype.isGroupEnd=function(a,b){var c,d,e,f,g,h,i=this,j=i.items,k=a+1;return!ka(i,k)||(!(c=j[k])||(d=c.level,e=j[a].level,f=!1,d<e&&(g=e-d,h=e-b,h>=0&&h<g&&(f=!0)),f))},a.prototype.hitTest=function(a,b,c){return ca.call(a,b,c)},a.prototype.jp=function(a,b,c,d){var e,f,g,h,i,j,k,l=a.Gt(),m=a.am(),n=a.ss,o=l.width,p=l.height;if(o||p){if(e=d?o:m.width,f=d?m.height:p,g=d?l.rowMaxLevel:l.colMaxLevel,h=d?n.bn:n.dn,b.save(),b.beginPath(),!c||c.intersect(l.x,l.y,e,f))for(i=new P(a,d,g),j=void 0,k=void 0,i._L(b),j=h.call(a.ss,function(){return ea(a,d,g)}),k=0;k<=2;k++)j[k].aM(b);b.beginPath(),b.restore()}},a.prototype.UL=function(a,b){if(b){var c=b.what;c===J||c===K?_(a,b):c!==L&&c!==M||aa(a,b)}},a.prototype.iT=function(){return this.wz},a.prototype.s0a=function(){var a=parseInt(q(H).borderTopWidth,10);return isNaN(a)?2:a},a.prototype.fromJSON=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o=b&&b.ignoreStyle;if(a&&!o){if(c=this,d=c.items,e=a.items,f=a.itemsData,g=a.direction,h=a.head,i=a.tail,m=[],z(g)||c.direction(g),h&&(c.head=h),i&&(c.tail=i),e&&e.length>0)for(n=0;n<e.length;n++)z(e[n])||(d[n]=new U(e[n]),c.wz=!1);else p(f,function(a,b){if(j=b.index,k=b.info,j>=0&&k){for(l=0;l<b.count&&!(j+l>=u(d));l++)b.info.collapsed&&m.push(b),d[j+l]=new U(k);c.wz=!1}});for(oa(c,!0),n=0;n<m.length;n++)c.E4(m[n].index,!0)}},a.prototype.toJSON=function(a){var b,c,d,e,f,g,h,i,k,l,m=a&&a.ignoreStyle;if(!m){for(b=this,c=[],d=b.items,f=-1,g=[],e=0;e<u(d);e++)h=c[f],i=d[e],i&&(g[e]={level:i.level,collapsed:i.collapsed,viewCollapsed:i.viewCollapsed},f>=0&&e===h.count+h.index&&i.level===h.info.level&&i.collapsed===h.info.collapsed?c[f].count++:(f++,c[f]={index:e,count:1,info:{level:i.level,collapsed:i.collapsed}}));return k={items:g,itemsData:c,direction:b.direction(),head:b.head,tail:b.tail},l={},p(k,function(a,b){ma(a,b)||(l[a]=b)}),o.isEmptyObject(l)?j:l}},a}(),b.Outline=V,V.prototype.direction=A("direction",1),h.Outline=V;function ua(a){return a&&new U(a)}function va(a){return{items:a.items.map(ua),head:ua(a.head),tail:ua(a.tail),wz:a.wz,direction:a.direction()}}function wa(a,b){a.items=b.items.map(ua),a.head=ua(b.head),a.tail=ua(b.tail),a.wz=b.wz,a.direction(b.direction),oa(a,!0)}o.extend(e.lUa.prototype,{vUa:function(a){var b=this,c=b.zTa;c&&(c.wUa||(c.wUa=[]),a&&!c.wUa[0]?c.wUa[0]=va(b.xUa):a||c.wUa[1]||(c.wUa[1]=va(b.yUa)))},zUa:function(a,b){var c,d=this;void 0!==b&&(this.kj.outlineColumn.YQa=b),a&&(c=a[0],c&&wa(d.xUa,c),c=a[1],c&&wa(d.yUa,c))}}),e.lUa.$n(C,{init:function(){var a=this,b=a.kj;a.yUa=new V(a.getColumnCount(),b,(!1)),a.xUa=new V(a.getRowCount(),b,(!0))},undo:function(a){var b=a.wUa;(b||a.WIc)&&(this.zUa(b,a.WIc),this.kj.$p())},dispose:function(a){var b=this,c=a&&a.clearCache;c!==!1&&(b.yUa&&(b.yUa.no(),b.yUa=i),b.xUa&&(b.xUa.no(),b.xUa=i))}}),W={init:function(){var a=this;a.rowOutlines=a.ITa.xUa,a.columnOutlines=a.ITa.yUa,a.rowOutlines.groupChangeHandler=function(b){var c,d,f,g,h,i=b&&b.indexes;i&&a.recalcRows&&(c=a.getCalcService(),c&&!c.IsSuspended()&&a.recalcRows(i)),d=a.parent,d&&a!==d.getActiveSheet()||a.au(),i?(f=i[0],g=i[i.length-1],h=!0):(f=0,g=a.getRowCount()-1,h=!1),e.Worksheet.ao(a,"onGroupChanged",{start:f,end:g,isRow:!0,fromSetCollapsed:h})},a.columnOutlines.groupChangeHandler=function(b){var c,d,f,g,h=a.parent;h&&a!==h.getActiveSheet()||a.bu(),c=b&&b.indexes,c?(d=c[0],f=c[c.length-1],g=!0):(d=0,f=a.getColumnCount()-1,g=!1),e.Worksheet.ao(a,"onGroupChanged",{start:d,end:f,isRow:!1,fromSetCollapsed:g})},a.Wr.push(a.rowOutlines),a.Zr.push(a.columnOutlines)},dispose:function(a){var b=this;a.clearCache!==!1&&(b.rowOutlines&&(b.rowOutlines.groupChangeHandler=i),b.columnOutlines&&(b.columnOutlines.groupChangeHandler=i)),o(b.Ws()).unbind("mousedown.group")},setHost:function(a){if(a){var b=this;a.bind("mousedown.group",function(a){var c,d=b.Vs(),e=ca.call(b,a.pageX-d.left,a.pageY-d.top);e&&(c=e.what,c===L||c===J?b.rowOutlines.UL(b,e):c!==M&&c!==K||b.columnOutlines.UL(b,e))})}},onPaintSuspend:function(a){var b=this;a.suspend?(b.rowOutlines.Lia(),b.columnOutlines.Lia()):(b.rowOutlines.Mia(),b.columnOutlines.Mia())},beforeLayoutChanged:function(a){var b=this,c=a.changeType;"invalidateLayout"===c&&(b.TL=i)},onLayoutChanged:function(a){var b=this,c=a.changeType,d=a.row,e=a.rowCount,f=a.col,g=a.colCount,h=a.sheetArea,j=b.rowOutlines,k=b.columnOutlines,l=this.ITa;"addRows"===c?(l.vUa(!0),ha(j,d,e)):"deleteRows"===c?(l.vUa(!0),ia(j,d,e)):"addColumns"===c?(l.vUa(!1),ha(k,f,g)):"deleteColumns"===c?(l.vUa(!1),ia(k,f,g)):"invalidateLayout"===c?b.TL=i:"setColumnCount"===c?(l.vUa(!1),3!==h&&1!==h||k.VL(g)):"setRowCount"!==c||3!==h&&2!==h||(l.vUa(!0),j.VL(e))},paint:function(a){var b=a.ctx,c=a.clipRect,d=this,e=d.rowOutlines,f=d.columnOutlines;
      67 | e&&e.jp(d,b,c,!0),f&&f.jp(d,b,c,!1)},fromJson:function(a,b,c){if(a){var d=this,e=void 0,f=a.showRowRangeGroup,g=a.showColumnRangeGroup,h=y(f)?f:a.showRowOutline,i=y(g)?g:a.showColumnOutline;z(h)||d.showRowOutline(h),z(i)||d.showColumnOutline(i),e=a.rowRangeGroup||a.rowOutlines,e&&d.rowOutlines.fromJSON(e,c),e=a.colRangeGroup||a.columnOutlines,e&&d.columnOutlines.fromJSON(e,c)}},toJson:function(a,b){var c,d=this,e=d.rowOutlines,f=d.columnOutlines,g=d.showRowOutline();g!==!0&&(a.showRowOutline=g),c=d.showColumnOutline(),c!==!0&&(a.showColumnOutline=c),a.rowOutlines=e?e.toJSON(b):j,a.columnOutlines=f?f.toJSON(b):j}},e.Worksheet.$n(C,W),X={init:function(){f.Commands.SL(this.commandManager())},onCultureChanged:function(){b.getSR()}},e.Workbook.$n(C,X)},"./dist/plugins/group/group.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/group/group.res.en.js");b.SR={en:d}},"./dist/plugins/group/group.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_InvalidIndex="Invalid index",b.Exp_InvalidCount="Invalid count",b.Exp_InvalidLevel="Invalid level",b.Exp_GroupInfoIsNull="groupInfo is null",b.Exp_GROUP_PROTECTED="You can not use this command on a protected sheet. To use this command, you must first unprotect sheet."},"./dist/plugins/hyperlink/hyperlink.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("SheetsCalc"),g=d.Ul.fp,h=d.Ul.Nl,i=d.Ul.ol,j=d.GC$,k=d.Commands.ActionBase,l=d.CellTypes.Base,m=e.Common.j.Fa,n=e.Common.j.C4,o=e.Common.u.BIc,p=e.Common.pc,q=void 0,r=null,s=Math.max,t=Math.min,u=Math.floor,v=window.open,w=e.Common.u.kb,x="position",y="absolute",z="margin",A="font",B="left",C="top",D="padding",E="border",F="box-sizing",G="pointer",H="background-color",I="content-box",J="default",K="white",L="div",M="gc-spread-hyperlink-tooltip",N="hyperlink",O="followedHyperlink",P="hyperlink",Q="openUrl",R="generateHyperlink",S=/^sjs:\/\/\w+[\!]\w+([\:]\w+)?/,T=/^(mailto:\/\/)?([A-Za-z0-9_\-\.\!\#$%&'*\+/=?^`{|}~])+\@([A-Za-z0-9\-])+\.([A-Za-z0-9\-]){2,63}(\?subject=.+)?$/gi,U=/(((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/gi,function(a){a[a.blank=0]="blank",a[a.self=1]="self",a[a.parent=2]="parent",a[a.top=3]="top"}(V=b.HyperlinkTargetType||(b.HyperlinkTargetType={})),d.GC$.extend(d.lUa.prototype,{getHyperlink:function(a,b,c){var d,e;return m(c)&&(c=3),d=this,e=d.XTa(c).RTa(a,b),e&&!m(e.hyperlink)?e.hyperlink:r},setHyperlink:function(a,b,c,d){var e,f,g,h,i,j,k,l=this;if(m(d)&&(d=3),e=c&&c.url,e&&e.match(U)&&e.match(U).length>0?(f="www.",w(e,f)&&(c.url="http://"+e)):e&&e.match(T)&&e.match(T).length>0&&(g="mailto:",w(e,g)||(c.url=g+e)),h=l.WTa>0?[["sheetModels",d],q]:q,i=l.XTa(d).RTa(a,b,!0,h?h[0]:q),m(i))h&&(h.length=0);else{if(j=i.hyperlink,m(c))i.hyperlink=null,delete i.hyperlink;else{i.hyperlink={url:"",linkColor:q,visitedLinkColor:q,tooltip:"",target:0,drawUnderline:!0,isVisited:!1,command:""};for(k in i.hyperlink)c[k]!==q&&(i.hyperlink[k]=c[k])}h&&(h[0].push("hyperlink"),h[1]=j)}h&&h.length>0&&l.zTa.push(h)}}),d.GC$.extend(d.Worksheet.prototype,{getHyperlink:function(a,b,c){var d,e;return 0===c?r:(m(c)&&(c=3),d=this,e=d.ITa,n(e.getHyperlink(a,b,c)))},setHyperlink:function(a,b,c,d){var e,f,g,h;0!==d&&(m(d)&&(d=3),e=this,f=e.ITa,g=f.getRowCount(d),h=f.getColumnCount(d),a<0||a>=g||b<0||b>=h||(f.do("setHyperlink",a,b,c,d),this.$p()))}}),W=function(a){aa(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,g,h,i,j,k,l,n,p,q,r,s,t,u=this,x=u.kj,y=!1,z=u.VQ.url;if(m(z))return y;if(a=u.VQ.target||0,b="sjs://",0===z.indexOf(b)||"#"===z[0]){if(c=b.length,g="#"===z[0]?z.substr(1):z.substr(c),h=f.formulaToRanges(x,g,0,0,!0),h&&h.length>0){if(i=h[0].sheetName,j=h[0].ranges[0],i!==x.name()){if(k=x.parent,l=x,n=k.getSheetFromName(i),p={oldSheet:l,newSheet:n,cancel:!1},k.Wq(d.Events.ActiveSheetChanging,p),p.cancel)return;k.setActiveSheet(i),q=k.getActiveSheetIndex(),k.YJc.RIc(q),x=k.getActiveSheet(),l!==x&&k.Wq(d.Events.ActiveSheetChanged,{oldSheet:l,newSheet:x})}x.Yq(j.row+j.rowCount,j.col+j.colCount),x.setSelection(j.row,j.col,j.rowCount,j.colCount)}}else m(z)||(r="mailto:",z.match(U)&&z.match(U).length>0?(s="www.",w(z,s)&&(z="http://"+z)):z.match(T)&&z.match(T).length>0&&(w(z,r)||(z=r+z)),w(z,r)&&e.Common.u.Jb(z,"?")>1&&(t=z.split("?"),z=t[0]+"?"+t.slice(1).join("%3F")),v(o(z),["_blank","_self","_parent","_top"][a]));return y},b}(k),d.Commands[Q]={canUndo:!1,execute:function(a,b,c){return d.Commands.h4(a,W,b,c)}},X=function(a){aa(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e=this,f=e.kj,g=e.VQ,h=g.url,i=g.row,j=g.col,k=g.sheetArea;if(null===h)a=null;else{if("string"!=typeof h)return!1;if(b=h.match(U),(!b||b.length<1)&&(b=h.match(T),(!b||b.length<1)&&(b=h.match(S))),!(b&&b.length>0&&0===h.indexOf(b[0])&&h.length===b[0].length))return!1;a={url:h,linkColor:N,visitedLinkColor:O}}return f.ITa.startTransaction(),f.suspendPaint(),f.suspendEvent(),f.setHyperlink(i,j,a,k),f.resumeEvent(),f.resumePaint(),c=d.Commands.bWa(f.name()),e.VQ[c]=f.ITa.endTransaction(),!0},b.prototype.undo=function(){var a,b=this,c=b.kj;return c.suspendPaint(),c.suspendEvent(),a=d.Commands.bWa(c.name()),c.ITa.undo(this.VQ[a]),c.resumeEvent(),c.resumePaint(),!0},b}(k),d.Commands[R]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,X,b,c)}},Y={init:function(){this.commandManager().register(Q,d.Commands[Q]),this.commandManager().register(R,d.Commands[R])}},d.Workbook.$n(P,Y),Z={setHyperlinkWhenEditing:function(a){var b=a.url,c=a.row,d=a.col,e=a.sheetArea,f=this,g=f.getParent();g.options.allowAutoCreateHyperlink&&g.commandManager().execute({cmd:R,sheetName:f.name(),url:b,row:c,col:d,sheetArea:e})}},d.Worksheet.$n(P,Z),$={applyHyperlinkStyle:function(a){var b=a.style,c=a.sheet.getHyperlink(a.row,a.col,a.sheetArea);!ga(b)&&fa(b,c)},getCellTextHitInfo:function(a){var b,c,d,e,f,g,h=a.context.sheetArea,i=a.cellStyle,j=a.context,k=j.sheet,l=j.row,n=j.col;ba(k,l,n,h)&&!ga(i)&&(b=a.cellRect,b&&(c=k.Er(l),d=k.Fr(n),e=k.am(),f=void 0,m(h)||3===h?f=e.Ft(c,d):2===h?f=e.fm(c):1===h&&(f=e.gm(d)),f&&(b=b.getIntersectRect(f))),m(h)&&3!==h||!i||!b||(g=k.getText(l,n,h),a.paddingHitInfo={row:l,col:n,x:a.x,y:a.y,sheetArea:h,sheet:k,isFocusAware:!0,isReservedLocation:la(a.x,a.y,i,b,j,g)}))},processMouseUpOnCellPadding:function(a){var b,c,e,f,g,h=a.sheet,i=a.cellStyle,j=a.row,k=a.col,l=a.sheetArea;h&&!h.isEditing()&&ba(h,j,k,l)&&!ga(i)&&a.isReservedLocation&&(b=h.Ws(),ea(h),b&&(b.style.cursor=J),c=h.ITa.getHyperlink(j,k,l),c.isVisited=!0,e=c.command,m(e)||""===e||e===Q?h.getParent().commandManager().execute({cmd:Q,sheetName:h.name(),url:c.url,target:c.target}):"string"==typeof e?h.getParent().commandManager().execute({cmd:e,row:j,col:k,sheetName:h.name(),sheetArea:l}):"function"==typeof e&&e.call(r,h,j,k,l),f=h.getColumnCount(),g=new d.Range(j,(-1),1,f),h.repaint(h.getRangeRect(1,1,g)))},processMouseMoveOnCellPadding:function(a){var b,c,d=a.row,e=a.col,f=a.sheet,g=a.cellStyle,h=a.sheetArea;ba(f,d,e,h)&&!ga(g)&&(!f||f.isEditing()&&f.getActiveRowIndex()===d&&f.getActiveColumnIndex()===e||(b=f.Ws(),c=f.getHyperlink(d,e,h),a.isReservedLocation?b&&(da(f,a,c.tooltip),b.style.cursor=G):(ea(f),b&&(b.style.cursor=J))))},processMouseLeaveOnCellPadding:function(a){var b,c=a.sheet,d=a.row,e=a.col,f=a.sheetArea;ea(c),ba(c,d,e,f)&&c&&(b=c.Ws(),b&&(b.style.cursor=J))},onUpdateContainer:function(a){var b=a.cellStyle,c=a.context.row,d=a.context.col,e=a.context.sheet.getHyperlink(c,d);!ga(b)&&fa(b,e)}},l.$n(P,$);function ba(a,b,c,d){return m(d)&&(d=3),!m(a.getHyperlink(b,c,d))}function ca(){var a=h(L);return j(a).css(x,y).css(z,0).css(D,2).css(E,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(F,I).css(H,K).css(A,"9pt Arial"),a}function da(a,b,c){var d,e,f,g,h,i,k;c&&(d=a&&a.zo(),e=d.getElementsByClassName(M)[0],f=!1,m(e)&&(e=ca(),e.className=M,d.insertBefore(e,r),f=!0),g=j(e),!f&&g.isVisible()||(g.text(c),h=a.mm.bG(),i=h.left+b.x,k=h.top+b.y+20,g.css(C,k).css(B,i),g.show()))}function ea(a){var b=a&&a.zo(),c=b.getElementsByClassName(M)[0];m(c)||j(c).hide()}function fa(a,b){m(b)||(b.drawUnderline&&(m(a.textDecoration)?a.textDecoration=1:0!==a.textDecoration&&1!==(1&a.textDecoration)&&(a.textDecoration+=1)),b.isVisited?b.visitedLinkColor===r?a.foreColor="rgba(0,0,0,0)":b.visitedLinkColor===q?a.foreColor=O:a.foreColor=b.visitedLinkColor:m(b.linkColor)?b.linkColor===q&&a.foreColor||(a.foreColor=N):a.foreColor=b.linkColor)}_={0:!0,1:!0,2:!0,3:!0,4:!0};function ga(a){if(a&&a.cellType){var b=a.cellType.typeName;if(!_[b])return!0}return!1}function ha(a,b,c,d,e,f,g){var h=0,i=0,j=a.width,k=a.height,l=ia(g);return l&&(j-=l),h=f=f||0,1===d?h=(j-b)/2:2===d&&(h=j-b-f),1===e?i=(k-c)/2:2===e&&(i=k-c),l&&(h+=l),{x:h,y:i}}function ia(a){var b={context:a,value:0};return l.ao(a.sheet,"getOutlineColumnOffset",b),b.value}function ja(a,b){var c=g(b),e=s(0,d.Vn.Xn(a,b,!0)),f=a.split(/\r\n|\r|\n/).length*c;return{x:0,y:0,width:e,height:f}}function ka(a,b,c,d,e,f,g){var h=ja(a,d),i=ha(e,h.width,h.height,b,c,f,g);return h.x=i.x,h.y=i.y,h}function la(a,b,c,e,f,g){var h,j,k,l,n,o,p,q,r,s,u,v,w,x=f.sheet,y=x.yl;if(m(c))return!1;if(c.textOrientation)return!0;if(h=x.getValue(f.row,f.col,f.sheetArea),g||(g=x.getText(f.row,f.col,f.sheetArea)),!g)return!1;for(g=g.replace(/\s+/g," "),j=c&&c.font?c.font:y.Bl(),j=y.Cl(j),k=[g],l=ma(c),c.wordWrap&&(k=d.Vn.Wn(g,e.width-3-l,j),g=k.join("\r\n")),n=c.hAlign,o=c.vAlign,3===n&&(n=i(n,h,c.formatter)),p=ka(g,n,o,j,e,l,f),q=e.y+p.y,r=0;r<k.length;r++)if(s=ka(k[r],n,o,j,e,l,f),u=e.x+s.x,v=t(u+s.width,e.x+e.width),w=q,q=t(w+s.height,e.y+e.height),u<=a&&a<v&&w<=b&&b<q)return!0;return!1}function ma(a){return 8*(a.textIndent||0)}},"./dist/plugins/outlineColumn/outlineColumn-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),b.commands=e.Commands,f=e.Commands.ActionBase,g=d.Common.j.Fa,h="increaseCellIndent",i="decreaseCellIndent",j="updateOutlineColumnCheckStatus",k="updateOutlineColumnOption",l="outlineColumnCheckStatus",b.outlineColumnCheckStatus=l,m=e.Commands.h4;function s(a,b,c,d){return u(a,b,c,d)}function t(a,b,c,d){a.Wq(e.Events.OutlineColumnCheckStatusChanged,{sheet:a,sheetName:a.name(),row:b,col:c,status:d})}function u(a,b,c,d){var e,f,h,i,j,k,l,m,n,o,p=g(d)?a.getActiveColumnIndex():d;if(!a.outlineColumn.XQa(p))return null;if(e=b?1:-1,f=a.getActiveRowIndex(),h=a.getSelections()[0].rowCount,j=!0,g(c))for(c={},j=!1,i=f;i<h+f;i++)0!==i&&(k=a.rowOutlines.getLevel(i),b&&(l=a.rowOutlines.getLevel(i-1),k>l&&!c[i-1])||(m=k+e,n=a.outlineColumn.options(),o=g(n.maxLevel)?a.outlineColumn.Oia().maxLevel:n.maxLevel,o&&m+1>o||m+1<0||(c[i]={row:i,original:k+1,current:m+1},j=!0)));return j?c:null}function v(a,b,c,d){var e,f,h,i=u(a,b,c,d);if(!i)return null;e=g(d)?a.getActiveColumnIndex():d,a.outlineColumn.Lia(),a.suspendPaint();for(f in i)Object.prototype.hasOwnProperty.call(i,f)&&(h=i[f],a.getCell(h.row,e).textIndent(h.current));a.resumePaint(),a.outlineColumn.Mia()}function w(a,b,c,d){var e,f,g,h,i,j=0,k=0,l=a.rowOutlines.getLevel(b);if(a.outlineColumn.Kia.updateCheckStatus(b,d),f=b<=a.getRowCount()-2?a.rowOutlines.find(b+1,l+1):null,null!==f&&null!==d)for(g=f.start;g<f.end+1;g++)a.outlineColumn.Kia.updateCheckStatus(g,d);for(f=a.rowOutlines.find(b,l);null!==f&&null!==f.parent;){if(f.start>0){for(j=f.start-1,k=a.rowOutlines.getLevel(j),a.outlineColumn.Kia.updateCheckStatus(j,d),e=a.rowOutlines.find(j+1,k+1),g=e.start;g<e.end+1;g++)if(h=a.outlineColumn.Kia.QR[g].checkBox.checkStatus,h!==d){i="number"==typeof h&&"number"==typeof d&&3,a.outlineColumn.Kia.updateCheckStatus(j,i);break}g===e.end+1&&d===!0&&a.outlineColumn.Kia.updateCheckStatus(j,!0)}f=f.parent}}b.setCheckStatus=w;function x(a){var b=a.kj,c=e.Commands.bWa(b.name()),d=a.VQ[c];b.ITa.undo(d)}n=function(a){r(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){return!!s(this.kj,!0,this.VQ.changingRows,this.VQ.changingColumns)},b.prototype.canUndo=function(){return!0},b.prototype.execute=function(){var a,b;return!!this.canExecute()&&(a=this.kj,a.ITa.startTransaction(),a.outlineColumn.Kia.JVa(),v(this.kj,!0,this.VQ.changingRows,this.VQ.changingColumns),b=e.Commands.bWa(a.name()),this.VQ[b]=a.ITa.endTransaction(),!0)},b.prototype.undo=function(){var a=this,b=a.kj,c=e.Commands.bWa(b.name()),d=a.VQ[c];return b.ITa.undo(d),!0},b}(f),o=function(a){r(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){return!!s(this.kj,!1,this.VQ.changingRows,this.VQ.changingColumns)},b.prototype.canUndo=function(){return!0},b.prototype.execute=function(){var a,b;return!!this.canExecute()&&(a=this.kj,a.ITa.startTransaction(),a.outlineColumn.Kia.JVa(),v(a,!1,this.VQ.changingRows,this.VQ.changingColumns),b=e.Commands.bWa(a.name()),this.VQ[b]=a.ITa.endTransaction(),!0)},b.prototype.undo=function(){return x(this),!0},b}(f),p=function(a){r(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){return!0},b.prototype.canUndo=function(){return!0},b.prototype.execute=function(){var a,b=this,c=b.kj,d=b.VQ,f=d.options,g=JSON.parse(JSON.stringify(c.outlineColumn.YQa));return c.ITa.startTransaction(),c.outlineColumn.YQa=f,c.outlineColumn.refresh(),a=e.Commands.bWa(c.name()),d[a]=c.ITa.endTransaction(),d[a].WIc=g,!0},b.prototype.undo=function(){return x(this),this.kj.outlineColumn.refresh(),!0},b}(f),q=function(a){r(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){return!0},b.prototype.canUndo=function(){return!0},b.prototype.execute=function(){var a,b=this,c=b.kj,d=b.VQ,f=d.row,g=d.col,h=d.status;return c.ITa.startTransaction(),w(c,f,g,h),c.outlineColumn.refresh(),a=e.Commands.bWa(c.name()),d[a]=c.ITa.endTransaction(),t(c,f,g,h),!0},b.prototype.undo=function(){return x(this),this.kj.outlineColumn.refresh(),!0},b}(f),e.Commands[h]={canUndo:!0,execute:function(a,b,c){return b.cmd=h,m(a,n,b,c)}},e.Commands[i]={canUndo:!0,execute:function(a,b,c){return b.cmd=i,m(a,o,b,c)}},e.Commands[k]={canUndo:!0,execute:function(a,b,c){return b.cmd=k,m(a,p,b,c)}},e.Commands[j]={canUndo:!0,execute:function(a,b,c){return b.cmd=j,m(a,q,b,c)}},e.Commands.$Qa=function(a){var b=e.Ul.sl(),c=!b,d=b;a.register(h,e.Commands[h],221,c,!1,!0,d),a.register(i,e.Commands[i],219,c,!1,!0,d),a.register(j,e.Commands[j]),a.register(k,e.Commands[k])}},"./dist/plugins/outlineColumn/outlineColumn.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/outlineColumn/outlineColumn.js")),d(c("./dist/plugins/outlineColumn/outlineColumn-actions.js")),d(c("./dist/plugins/outlineColumn/outlineColumn.ns.js"))},"./dist/plugins/outlineColumn/outlineColumn.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/outlineColumn/outlineColumn-actions.js"),g=c("./dist/plugins/outlineColumn/outlineColumn.ns.js"),h=e.Common.k,i=h.ac,j=e.Common.A,k=e.Common.B,l=d.GC$.each,m=d.GC$.isEmptyObject,n=e.Common.j.Fa,o=5,p=6,q=6,r=3,s=16,t=16,u=16,v=16,w=void 0,x="number",y=null,z=new e.Common.ResourceManager(g.SR,"OutlineColumn"),A=z.getResource.bind(z),B={columnIndex:w,showCheckBox:!1,showImage:!1,images:w,showIndicator:!0,expandIndicator:w,collapseIndicator:w,maxLevel:10};function H(a){return!(!a.expandIndicator&&!a.collapseIndicator)}function I(a,b){return a&&a.outlineColumn&&a.outlineColumn.options()&&a.outlineColumn.options().columnIndex===b}function J(a,b,c){var d=b.x+c.x,e=c.y+c.height/2-b.height/2,f=b.height,g=b.width;c.x+c.width<d+g||(a.save(),a.beginPath(),a.strokeStyle="black",a.strokeRect(d,e,g,f),a.fillStyle="white",a.fillRect(d,e,g,f),3===b.checkStatus?(a.beginPath(),a.fillStyle="black",a.rect(d+g/5,e+f/5,g-.4*g,f-.4*f),a.fill()):b.checkStatus!==!0&&1!==b.checkStatus||(a.beginPath(),a.lineWidth=g/5,a.moveTo(d+g/6,e+f/2),a.lineTo(d+2*g/5,e+5/7*f),a.lineTo(d+5/6*g,e+f/6),a.stroke()),a.restore())}function K(a,b,c,d){var e=b.collapsed,f=b.x+c.x,g=c.y+c.height/2-b.height/2,h=b.height,i=b.width;c.x+c.width<f+i||(e?b.expandIndicator?L(a,b.expandIndicator,b,c,d):(a.save(),a.fillStyle="black",a.beginPath(),a.moveTo(f,g),a.lineTo(f,g+h),a.lineTo(f+i,g+h/2),a.fill(),a.restore()):b.collapseIndicator?L(a,b.collapseIndicator,b,c,d):(a.save(),a.fillStyle="black",a.beginPath(),a.moveTo(f,g+h),a.lineTo(f+i,g+h),a.lineTo(f+i,g),a.fill(),a.restore()))}function L(a,b,c,d,e){var f,g=c.x+d.x,h=d.y+d.height/2-c.height/2,i=c.width,j=c.height;if(!(d.x+d.width<g+i)&&b&&"none"!==b&&e)try{e.ko(b)?(f=e.lo(b),a.drawImage(f,g,h,i,j)):e.fo(b)}catch(a){}}function M(a,b,c,d){var e={sheet:a,sheetName:a.name(),isRowGroup:!0,index:b,level:c};return d&&(e.cancel=!1),e}function N(a,b,c){var e,f,g=a.options,h=g.isProtected;h&&!g.protectionOptions.allowOutlineRows?a.Os(d.InvalidOperationType.groupProtected,A().Exp_GROUP_PROTECTED):(e=a.rowOutlines.getLevel(b),n(c)&&(c=!a.rowOutlines.getCollapsed(b)),f=M(a,b+1,e+1,!0),a.Wq(d.Events.RangeGroupStateChanging,f),f&&f.cancel===!1&&(a.wu().execute({cmd:"expandRowOutline",sheetName:a.name(),index:b,level:e+1,collapsed:c}),a.Wq(d.Events.RangeGroupStateChanged,M(a,b+1,e+1,!1))))}function O(a,b,c,d){var e,f;n(d)&&(e=a.outlineColumn.getCheckStatus(b),d=typeof e===x?1===e?2:1:!e),f={cmd:"updateOutlineColumnCheckStatus",row:b,col:c,status:d,sheetName:a.name()},a.wu().execute(f)}function P(a,b,c){var d,e,f,g=a.getLevel(b);if(c!==g+1)for(d=c-(g+1),e=0,f=Math.abs(d);e<f;e++)d>0?a.group(b,1):a.ungroupRange(b,1)}function Q(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,q,s=R(c,"showIndicator");s?(h=a.zoom(),i=a.getRowCount(),j=!!a.rowOutlines.isCollapsed(b+1),k=o*h,l=p*h,m=null,n=null,c.expandIndicator&&(m=c.expandIndicator,j&&(k=u*h,l=v*h)),c.collapseIndicator&&(n=c.collapseIndicator,j||(k=u*h,l=v*h)),b<i-1&&(q=a.getActualStyle(b+1,d),q&&q.textIndent>e?g.indicator={x:f.value+r*h,y:-l/2,width:k,height:l,collapsed:j,collapseIndicator:n,expandIndicator:m}:delete g.indicator),f.value+=2*r*h+k):delete g.indicator}function R(a,b){return n(a[b])?B[b]:a[b]}function S(a,b,c){var d,e,f=-1,g=0,h=a.children;for(d=a.start;d<=a.end;d++)if(e=void 0,h&&h[g]&&h[g].start-1===d?(e=S(h[g],b,c),d=h[g].end,g++):e=b[d]&&b[d].checkBox&&b[d].checkBox.checkStatus,f===-1)f=e;else if(f!==e){f=typeof e===x&&typeof f===x&&3;break}for(;g<a.children.length;g++)S(h[g],b,c);return c.updateCheckStatus(a.start-1,f),f}function T(a){var b=a.rowOutlines,c=a.outlineColumn.Kia,d=b.find(0,-1);d.children&&d.children.forEach(function(a){S(a,c.QR,c)})}function U(a,b,c,d,e,f){var g,h,i=n(c.showCheckBox)?B.showCheckBox:c.showCheckBox;i?(g=!n(f.checkBox)&&1!==f.checkBox&&f.checkBox.checkStatus,h=a.zoom(),f.checkBox={x:e.value+r*h,y:-q*h,width:2*q*h,height:2*q*h,checkStatus:g},e.value+=2*r*h+2*q*h):delete f.checkBox}function V(a,b,c,d,e){var f,g,h,i,j,k=n(c.showImage)?B.showImage:c.showImage;k?(f=c.images,g=a.zoom(),f&&f.length&&(h=b>f.length-1?f[f.length-1]:f[b],i=d.value+r*g,j=0,e.images={image:h,x:i,y:j,width:s*g,height:t*g},d.value+=2*r*g+s*g)):delete e.images}function W(a,b,c){var d,e,f,g,h=a.outlineColumn.options(),i=h&&h.columnIndex;if(!n(i))return d={value:0},e=0,f=a.getActualStyle(b,i),f&&f.textIndent&&(e=f.textIndent),0!==b&&(g=a.rowOutlines.getLevel(b-1),e-g>=3&&(e=g+2)),d.value+=8*e,P(a.rowOutlines,b,e),Q(a,b,h,i,e,d,c),U(a,b,h,i,d,c),V(a,e,h,d,c),c.cellContent={left:d.value,x:d.value,y:0,width:-d.value,height:0},c}C=function(){function a(a){this.kj=a,this.YQa={},this.$e=0}return a.prototype.no=function(){var a=this;a.kj=y,a.Kia=y,a.YQa=y},a.prototype.LRa=function(a,b){return this.YQa&&this.YQa.columnIndex===b?this.Kia.QR[a].cellContent.left:null},a.prototype.options=function(a){var b=this,c=b.YQa;return i(arguments)?(b.YQa=a,b.refresh(),b):c},a.prototype.refresh=function(){var a=this.kj;n(this.YQa)||n(this.YQa.columnIndex)||0===this.$e&&(a.suspendPaint(),a.outlineColumn.Kia.updateModel(),a.resumePaint())},a.prototype.setCheckStatus=function(a,b){var c=this.YQa.columnIndex;n(c)||O(this.kj,a,c,b)},a.prototype.Wlb=function(a){this.kj.outlineColumn.Kia.setAllTiemCheckStatus(a),this.refresh()},a.prototype.getCheckStatus=function(a){var b,c;if(i(arguments))return this.kj.outlineColumn.Kia.getCheckStatus(a);for(b=[],c=this.kj.getRowCount(),a=0;a<c;a++)b[a]=this.kj.outlineColumn.Kia.getCheckStatus(a);return b},a.prototype.setCollapsed=function(a,b){N(this.kj,a,b)},a.prototype.getCollapsed=function(a){var b,c;if(i(arguments))return this.kj.outlineColumn.Kia.getCollapsed(a);for(b=[],c=this.kj.getRowCount(),a=0;a<c;a++)b[a]=this.kj.outlineColumn.Kia.getCollapsed(a);return b},a.prototype.reset=function(){if(!n(this.YQa)&&!n(this.YQa.columnIndex)){var a=this.kj;this.YQa=B,a.suspendPaint(),a.outlineColumn.Kia.updateModel(),a.resumePaint()}},a.prototype.XQa=function(a){return this.YQa&&this.YQa.columnIndex===a},a.prototype.ZQa=function(){return this.YQa&&!n(this.YQa.columnIndex)},a.prototype.Lia=function(){this.$e++},a.prototype.Mia=function(){this.$e>0&&this.$e--,0===this.$e&&this.refresh()},a.prototype.Nia=function(a,b){this.kj.outlineColumn.Kia.insertRows(a,b)},a.prototype.STa=function(a,b){this.kj.outlineColumn.Kia.deleteRows(a,b)},a.prototype.Oia=function(){return B},a.prototype.Pia=function(){return{TRIANGLE_HEIGHT:o,TRIANGLE_BASE:p,CHECKBOX_RADIUS:q,GAP:r,IMAGE_WIDTH:s,IMAGE_HEIGHT:t,INDICATOR_IMAGE_WIDTH:u,INDICATOR_IMAGE_HEIGHT:v}},a.prototype.Gka=function(a){var b,c,d=this;for(b in a)a.hasOwnProperty(b)&&(c=d.Kia.QR[b]=d.Kia.QR[b]||{},c.checkBox={checkStatus:a[b].checked})},a.prototype.CXa=function(a,b){var c=this.YQa.columnIndex;n(c)||f.setCheckStatus(this.kj,a,c,b)},a.prototype.WZa=function(){return this.Kia.QR},a}(),b.OutlineColumn=C,D=function(){function a(a){var b=this;b.kj=a,b.QR={}}return a.prototype.no=function(){this.kj=y},a.prototype.updateIndicatorCollapsed=function(a,b){var c=this;n(c.QR[a])||n(c.QR[a].indicator)||(c.QR[a].indicator.collapsed=b)},a.prototype.updateCheckStatus=function(a,b){var c=this;c.JVa(a),n(c.QR[a])||(c.QR[a].checkBox.checkStatus=b)},a.prototype.setAllTiemCheckStatus=function(a){var b,c=this,d=c.QR;for(b in d)d.hasOwnProperty(b)&&(d[b].checkBox.checkStatus=a)},a.prototype.getCheckStatus=function(a){var b=this;return n(b.QR[a])||n(b.QR[a].checkBox)?null:b.QR[a].checkBox.checkStatus},a.prototype.getCollapsed=function(a){var b=this;return!n(b.QR[a])&&!n(b.QR[a].indicator)&&b.QR[a].indicator.collapsed},a.prototype.updateModel=function(){var a,b,c,d=this,e=d.kj,f=e.getRowCount();for(e.rowOutlines.direction(0),a=0;a<f;a++)d.QR[a]=d.QR[a]||{},W(e,a,d.QR[a]);b=e.outlineColumn.options(),c=n(b.showCheckBox)?B.showCheckBox:b.showCheckBox,c&&T(e)},a.prototype.insertRows=function(a,b){var c=this;c.oEc(a,b),c.kEc(a,b)},a.prototype.oEc=function(a,b){var c,d,e,f=this.kj,g=f.outlineColumn.options();n(g)||(c=g.columnIndex,n(c)||(d=f.getActualStyle(a-1,c),e=0,d&&d.textIndent&&(e=d.textIndent),f.getRange(a,c,b,1).textIndent(e)))},a.prototype.kEc=function(a,b){var c,d=this,e=d.QR,f=e[a-1],g=f&&f.checkBox,h=d.kj.getRowCount();for(j(e,h,a,b),c=0;c<b;c++)e[a+c]={checkBox:{checkStatus:g&&g.checkStatus}}},a.prototype.deleteRows=function(a,b){this.lEc(a,b)},a.prototype.lEc=function(a,b){var c=this,d=c.QR,e=c.kj.getRowCount();k(d,e,a,b)},a.prototype.KVa=function(a,b){var c,d=this.QR[b];d&&!a[b]&&(c=d.checkBox,a[b]={checked:c&&c.checkStatus})},a.prototype.LVa=function(a){var b,c=this,d=this.QR;for(b in d)d.hasOwnProperty(b)&&c.KVa(a,b)},a.prototype.MVa=function(a){var b,c=this.QR;for(b in a)n(a[b].checked)||(c[b].checkBox.checkStatus=a[b].checked)},a.prototype.NVa=function(){var a=this.kj.ITa.zTa;return a?(a.OVa||(a.OVa={items:{}}),a.OVa):w},a.prototype.JVa=function(a){var b=this,c=b.NVa();c&&!c.all&&(n(a)?(c.all=!0,b.LVa(c.items)):b.KVa(c.items,a))},a.prototype.PVa=function(a){this.MVa(a.items)},a}(),d.GC$.extend(d.lUa.prototype,{PVa:function(a){var b=this,c=b.QVa,d=c.Kia;c.ZQa()&&(d.updateModel(),a&&d.PVa(a),b.kj.$p())}}),d.lUa.$n("outlineColumn",{init:function(){var a=this,b=a.kj;a.QVa=new C(b),a.QVa.Kia=new D(b)},undo:function(a){var b=a.OVa;b&&!a.WIc&&this.PVa(b)},dispose:function(a){var b=this,c=a&&a.clearCache;c!==!1&&b.QVa&&(b.QVa.Kia&&(b.QVa.Kia.no(),b.QVa.Kia=y),b.QVa.no(),b.QVa=y)}}),E={init:function(){var a=this;a.outlineColumn=a.ITa.QVa},dispose:function(a){if(a.clearCache!==!1){var b=this,c=b.outlineColumn;c&&(c.no(),b.outlineColumn=y)}},toJson:function(a){var b,c,d,e,f,g,h,i;function j(a,b){var c=B[a];return c===b}if(b=this.outlineColumn,c=b.YQa,d=b.Kia.QR,!n(c)){if(e={},l(B,function(a){f=c[a],n(f)||j(a,f)||(e[a]=f)}),g={},c.showCheckBox)for(h in d)d.hasOwnProperty(h)&&(i=d[h].checkBox.checkStatus,i&&(g[h]={checked:i}));m(g)||(e.data=g),a.outlineColumnOptions=e}},fromJson:function(a){var b,c,d,e=this.outlineColumn,f=a.outlineColumnOptions;if(f){if(b=f.data,c=void 0,b){c={};for(d in f)"data"!==d&&(c[d]=f[d]);e.Gka(b)}e.options(n(c)?f:c),e.refresh()}},onLayoutChanged:function(a){var b,c,d=this,e=d.outlineColumn,f=a.changeType,g=a.rowCount,h=a.row;if("addRows"===f)e.Kia.JVa(),e.Nia(h,g),e.refresh();else if("deleteRows"===f)e.Kia.JVa(),e.STa(h,g),e.refresh();else if("zoomSheet"===f)e.refresh();else if("invalidateLayout"===f&&e.Kia.QR&&!m(e.Kia.QR)&&d.rowOutlines.items&&!m(d.rowOutlines.items)){b=d.rowOutlines.items;for(c in b)b.hasOwnProperty(c)&&e.Kia.updateIndicatorCollapsed(parseInt(c,10),d.rowOutlines.isCollapsed(parseInt(c,10)+1))}},sortRangeChanged:function(a){for(var b=this.outlineColumn,c=a.column,d=a.columnCount,e=c;b.XQa(e)&&e<=c+d;)b.refresh(),e+=1}},d.Worksheet.$n("outlineColumn",E),F={paintCellPadding:function(a){var b,c=a.options.rect,d=a.options.context.sheet,e=a.options.context,f=e.row,g=e.col,h=a.ctx;I(d,g)&&c.width>0&&c.height>0&&(b=d.outlineColumn.Kia.QR[f],b&&(h.save(),b.indicator&&K(h,b.indicator,c,e.imageLoader),b.checkBox&&J(h,b.checkBox,c),b.images&&L(h,b.images.image,b.images,c,e.imageLoader),h.restore(),b.cellContent&&(c.x+=b.cellContent.left,c.width-=b.cellContent.left)))},getCellPaddingRect:function(a){var b,c=a.options.rect,d=a.options.context.sheet,e=a.options.context,f=e.row,g=e.col;I(d,g)&&c.width>0&&c.height>0&&(b=d.outlineColumn.Kia.QR[f],b&&b.cellContent&&(c.x+=b.cellContent.left,c.width-=b.cellContent.left))},getCellPaddingHitInfo:function(a){var b,c,d,e,f=a.context.sheet,g=a.context.col,h=a.context.row,i=a.x,j=a.y,k=a.cellRect,l=f.outlineColumn;if(a.paddingHitInfo=null,l&&l.YQa){for(b=l.Kia.QR[h],c=l.YQa.columnIndex,k=k.clone();g>c;)g--,k.x-=f.getColumnWidth(g);b&&g===c&&(d=void 0,e=void 0,b.indicator&&(d=b.indicator.x,e=b.indicator.x+k.x,i>=e&&i<e+b.indicator.width&&(a.paddingHitInfo={x:i,y:j,row:h,col:g,outlineColumnHitInfo:{indicator:!0}})),b.checkBox&&(d||(d=b.checkBox.x),e=b.checkBox.x+k.x,i>=e&&i<e+b.checkBox.width&&(a.paddingHitInfo={x:i,y:j,row:h,col:g,outlineColumnHitInfo:{checkBox:!0}})),b.images&&(d||(d=b.images.x),e=b.images.x+k.x,i>=e&&i<e+b.images.width&&(a.paddingHitInfo={x:i,y:j,row:h,col:g,outlineColumnHitInfo:{image:!0}})),d&&i>=k.x&&i<k.x+d&&(a.paddingHitInfo={x:i,y:j,row:h,col:g,outlineColumnHitInfo:{blank:!0}}))}},processMouseDownOnCellPadding:function(a){var b=a.sheet,c=a.row,d=a.col,e=a.outlineColumnHitInfo;n(e)||(e.indicator?N(b,c):e.checkBox?O(b,c,d):e.image||e.blank)},getOutlineColumnOffset:function(a){var b,c=a.context.sheet,d=a.context.col;I(c,d)&&(b=c.outlineColumn.options(),R(b,"showIndicator")&&(a.value+=r,H(b)?a.value+=u:a.value+=o,a.value+=r),R(b,"showCheckBox")&&(a.value+=r,a.value+=2*q,a.value+=r),R(b,"showImage")&&(a.value+=r,a.value+=s,a.value+=r))}},d.CellTypes.Base.$n("outlineColumn",F),G={init:function(){f.commands.$Qa(this.commandManager())},onCultureChanged:function(){A()}},d.Workbook.$n("outlineColumn",G)},"./dist/plugins/outlineColumn/outlineColumn.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/outlineColumn/outlineColumn.res.en.js");b.SR={en:d}},"./dist/plugins/outlineColumn/outlineColumn.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_GROUP_PROTECTED="You can not use this command on a protected sheet. To use this command, you must first unprotect sheet."},"./dist/plugins/search/search.entry.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/search/search.js");b.SearchResult=d.SearchResult,b.SearchCondition=d.SearchCondition,b.SearchFlags=d.SearchFlags,b.SearchOrder=d.SearchOrder,b.SearchFoundFlags=d.SearchFoundFlags},"./dist/plugins/search/search.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("@grapecity/js-calc"),g=!!f,h=e.Common.q,i=null,j=Math.max,k="string";function q(a,b,c){if(!a)return!1;if(a=""+a,b=""+b,0===c)return a.indexOf(b)>-1;var d=(2&c)>0,e=(1&c)>0,f=(4&c)>0,g;return f?(g=d?h.zb(b,!1,!0):h.ub(b),b=g?g:b,g=e?h.sb(b):h.qb(b),g.test(a)):(e&&(b=b.toLowerCase(),a=a.toLowerCase()),d?b===a:a.indexOf(b)>=0)}function r(a,b,c,d,e,f,g,h){var j=i,k=a+1,l=b+1;return 0===c?l>=0&&l<=h?j={r:a,c:l}:k>=0&&k<=f&&(j={r:k,c:d?g:0}):k<=f?j={r:k,c:b}:l<=h&&(j={r:d?e:0,c:l}),j}d.Worksheet.prototype.search=function(a){var b,c,e,f,h,l,n,o,p,s,t,u,v,w,x,y,z,A,B,C;if(!a)return i;if(b=this,c=a.sheetArea,e=a.searchString,f=a.searchTarget,h=a.searchFlags,l=b.getRowCount(c),n=b.getColumnCount(c),o=new m,!e||0===f||l<=0&&n<=0)return o;for(p=j(0,a.rowStart),s=j(0,a.columnStart),t=a.rowEnd,u=a.columnEnd,v=(8&h)>0,(t<0||!v)&&(t=l-1),(u<0||!v)&&(u=n-1),w=a.findBeginRow,x=a.findBeginColumn,y=w<0?p:w,z=x<0?s:x;y>=0&&z>=0;){if(A=b.getCell(y,z,c),B=void 0,(1&f)>0&&(B=a.callback?a.callback(A,b):A.text(),""!==B&&q(B,e,h)&&(o.searchFoundFlag|=1,o.foundString=B)),g&&(8&f)>0&&(B=d.util.$Xc(b,y,z),typeof B===k&&""!==B&&q(B,e,h)&&(o.searchFoundFlag|=8,o.foundString=B)),(4&f)>0&&(B=A.tag(),typeof B===k&&""!==B&&q(B,e,h)&&(o.searchFoundFlag|=4,o.foundString=B)),0!==o.searchFoundFlag)return o.foundRowIndex=y,o.foundColumnIndex=z,o;if(C=r(y,z,a.searchOrder,v,p,t,s,u),!C)break;y=C.r,z=C.c}return o},d.Workbook.prototype.search=function(a){var b,c,d,e,f,g,h,j,k;if(!a)return i;if(b=this,c=0,d=b.getSheetCount(),e=new m,!a.searchString||a.searchTarget===c||d<=0)return e;if(a.startSheetIndex===-1&&(a.startSheetIndex=0),a.endSheetIndex===-1&&(a.endSheetIndex=d-1),j=a.startSheetIndex,k=a.endSheetIndex,k>=j&&0<=j&&j<d&&0<=k&&k<d)for(f=j;f<=k;f++)if(g=b.getSheet(f),h=g.search(a),h&&h.searchFoundFlag!==c)return h.foundSheetIndex=f,h;return e},l=function(){function a(){this.startSheetIndex=-1,this.endSheetIndex=-1,this.searchString=i,this.searchFlags=0,this.searchOrder=0,this.searchTarget=1,this.sheetArea=3,this.rowStart=-1,this.columnStart=-1,this.rowEnd=-1,this.columnEnd=-1,this.findBeginRow=-1,this.findBeginColumn=-1;
      68 | }return a}(),b.SearchCondition=l,m=function(){function a(){this.foundColumnIndex=-1,this.foundRowIndex=-1,this.searchFoundFlag=0,this.foundSheetIndex=-1,this.foundString=i}return a}(),b.SearchResult=m,function(a){a[a.none=0]="none",a[a.ignoreCase=1]="ignoreCase",a[a.exactMatch=2]="exactMatch",a[a.useWildCards=4]="useWildCards",a[a.blockRange=8]="blockRange"}(n=b.SearchFlags||(b.SearchFlags={})),function(a){a[a.zOrder=0]="zOrder",a[a.nOrder=1]="nOrder"}(o=b.SearchOrder||(b.SearchOrder={})),function(a){a[a.none=0]="none",a[a.cellText=1]="cellText",a[a.cellTag=4]="cellTag",a[a.cellFormula=8]="cellFormula"}(p=b.SearchFoundFlags||(b.SearchFoundFlags={}))},"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Core"),f=c("Common"),g=c("./dist/plugins/sheetsCalc/parser-sheets.js"),h=c("@grapecity/js-calc"),i=c("./dist/plugins/sheetsCalc/calc.ns.js"),j=f.Common.j,k=f.Common.u,l=j.Ia,m=j.za,n=null,o=void 0,p=["v","n","s","b","d","sn"],q=h.Errors.Value,r=h.Errors.Calc,s=f.Formatter&&f.Formatter.GeneralFormatter,t=h.Convert.vf,u=h.Convert.Fh,v=h.Convert.Ca,w=h.Errors.Reference,x=h.Errors.NotAvailable,y=h.Errors.Name,z=f.Common.A,A=f.Common.B,B=j.Fa,C=function(a){return h.Convert.Na(a,!0)},D=d.Range.prototype.contains,E=k.Nb,F="number",G=h.CalcSource.prototype,G.referenceToArray=function(a,b,c,d,e,f,g,i){var j,k,l,m,p,r,s,t,u,v,w,x,y=this,z=1,A=1,B=[],C=a.getRangeCount();if(0===C)return B.isError=!0,B;for(s=y.getRowCount(),t=y.getColumnCount(),c=c===o||c,u=0;u<C;u++){if(c||(r=[],B.push(r)),z=a.getRowCount(u),0===z)return B.isError=!0,B;if(A=a.getColumnCount(u),0===A)return B.isError=!0,B;if(l=a.getRow(u),m=a.getColumn(u),l>=s||m>=t)return B=[n],B.rowCount=1,B.colCount=1,B.rangeCount=1,B;for(l+z>s&&(z=s-l),m+A>t&&(A=t-m),v=void 0,w=0;w<z;w++)for(j=l+w,c||(v=[],r.push(v)),x=0;x<A;x++){if(k=m+x,p=y.getValue(j,k),d&&h.Convert.vf(p))return B=[p],B.isError=!0,B;if(p=h.Convert.wf(p,b,!h.ExcelCompatibleCalcMode,f,i),e&&p===h.Convert.CalcConvertedError)return B=[q],B.isConvertError=!0,B;p===n&&f||(c?B.push(p):v.push(p))}}return c||1!==C||(B=B[0]),B.rowCount=z,B.colCount=A,B.rangeCount=C,B},G.getSheetReference=function(){var a=this;return a.Df=a.Df||new h.CalcReference(a),a.Df},function(a){a[a.a1=0]="a1",a[a.r1c1=1]="r1c1"}(H=b.ReferenceStyle||(b.ReferenceStyle={})),e.ReferenceStyle=H,I=function(){function a(a,b,c,d,e){var f=this;f.Cj=a,f.Uu=c,f.Vu=d,f.Lf=b,B(e)||(f.kT=e)}return a.prototype.getName=function(){return this.Cj},a.prototype.getRow=function(){return this.Uu},a.prototype.getColumn=function(){return this.Vu},a.prototype.getExpression=function(){return this.Lf},a.prototype.getComment=function(){return this.kT},a.prototype.fg=function(a,b){b&&b.push({type:"customName",nameInfo:this,expr:this.Lf}),this.Lf=a},a}(),b.NameInfo=I,e.NameInfo=I,h.CalcSource.prototype.createSourceModel=function(a){return new h.CalcSourceModel(a,this)},J=function(a){O(b,a);function b(b){var c=a.call(this,n)||this;return c.references=b,c}return b.prototype.toArray=function(a,b,c,d,e){var f,g,h=this.references,i=[];for(f=0;f<h.length;f++){if(g=h[f].xf.referenceToArray(h[f],a,b,c,d,e),g.isError&&c)return g;b?Array.prototype.push.apply(i,g):i.push(g[0]),f||(i.rowCount=g.rowCount,i.colCount=g.colCount)}return i.rangeCount=h.length,i},b}(h.CalcReference),b.SheetRangeReference=J,K=function(a){O(b,a);function b(b,c,e,f){var h,i,j,k=a.call(this,b&&b.yj(),c,e,f)||this;for(b||(b=new d.Worksheet),k.kj=b,k.row=e&&e.row||0,k.column=e&&e.col||0,h=b.getCalcService(),i=h.getResolvers(),j=0;j<i.length;j++)if(i[j]instanceof g.SheetReferenceResolver)return k;return h.addResolver(new g.SheetReferenceResolver(b)),h.addResolver(new g.StructureReferenceResolver(b)),k}return b.prototype.getExternalSource=function(a,b){var c,d,e,f=this,g=f.kj.parent;if(a&&(!g||g.name!==a))return n;if(!g)return k.Mb(f.kj.name(),b)?f.kj.yj():n;if(c=g.sheets,c&&c.length>0)for(d=0;d<c.length;d++)if(e=c[d],k.Mb(e.name(),b))return e.yj();return h.ParserContext.prototype.getExternalSource.call(this,a,b)},b.prototype.getExternalSourceToken=function(a){return a.getName()},b.prototype.getTableByName=function(a){var b,c,d=this.kj.tables,e=d?d.findByName(a):n;if(!e&&(b=this.kj.parent&&this.kj.parent.sheets))for(c=0;c<b.length&&(d=b[c].tables,!d||!(e=d.findByName(a)));c++);return e?e:this.kj.parent&&this.kj.parent.getSheetTab(a)},b.prototype.getTableByIndex=function(a,b){var c=this.kj.tables;return c?c.find(a,b):n},b.prototype.setSource=function(a){this.source=a;var b=a;b&&b.getSheet&&(this.kj=b.getSheet())},b.prototype.no=function(){this.kj&&this.kj.no()},b}(h.ParserContext),b.SheetParserContext=K,L=new f.Common.ResourceManager(d.SR);function P(a){return a.indexOf("LET(")>-1&&"LET"}M=function(a){O(b,a);function b(c,d){var e=a.call(this,n)||this;return e.getCalcSourceModel=function(){return this.Bf},e.createSourceModel=function(a){return new h.CalcSourceModel(a,this)},e.getRangeKey=function(a,b){return a.id+","+b.row+","+b.col+","+b.rowCount+","+b.colCount},e.getSheetRangeReference=function(a){var c,d,e,f,g,h=this.kj,i=h&&h.parent;if(a.endSource&&i&&i.sheets&&a.endSource instanceof b){for(c=i.sheets,d=!1,e=void 0,f=[],g=0;g<c.length;g++){if(e=c[g].yj(),e===this)d=!0;else if(e===a.endSource){f.push(e.getReference(a));break}d&&f.push(e.getReference(a))}return new J(f)}},e.kj=c,e.Wz=d?d:3,e}return b.prototype.startCalculation=function(){this.Hu||this.xLb()},b.prototype.endCalculation=function(){this.Hu=n,this.zIc(),this.Iu=n;var a=this.Bf.ug(!1);a&&a.clearListenersCache(),this.Af.calcOnDemand&&this.kj.repaint()},b.prototype.ZIc=function(){var a=this;a.$Ic?a.Iu&&(a._Ic=a._Ic.concat(a.Iu),a.Iu=[]):(a._Ic=a.Iu||[],a.$Ic=setTimeout(function(){a.zIc(a._Ic),delete a._Ic,delete a.$Ic},0))},b.prototype.zIc=function(a){var b,c=a||this.Iu;c&&c.length>0&&(b=this.kj,b.Wq(d.Events.RangeChanged,{isUndo:!1,sheet:b,sheetName:b.name(),row:0,col:0,rowCount:b.getRowCount(),colCount:b.getColumnCount(),changedCells:c,action:6},b.vxb))},b.prototype.clearValueCache=function(){this.xLb()},b.prototype.xLb=function(){var a=this.getRowCount(),b=this.getColumnCount();this.Hu={rowCount:a,colCount:b,arrayInfo:[]},this.Iu=[]},b.prototype.OHb=function(){this.Hu=n,this.Iu=n},b.prototype.getValue=function(a,b){var c,e,f,g,i,j,k,l,m,r,s,t,u,v=[];for(c=2;c<arguments.length;c++)v[c-2]=arguments[c];if(e=this,f=e.kj,typeof a===F)g=arguments[0],i=arguments[1],b=arguments[2];else if(a=a,a.row!==o)g=a.row,i=a.col;else if(a.name)return null;return j=e.Wz,b=b||0,g<0||i<0?q:f.Ju&&f.Ku===g&&f.Lu===i?f.Mu:(k=e.Hu,l=p[b],k?(m=k.rowCount,r=k.colCount,s=void 0,t=void 0,u=void 0,g>=m?n:i>=r?n:(s=k[g],s||(s=k[g]={}),t=s[i],t||(t=s[i]={v:f.getValue(g,i,j)}),u=t[l],u===o&&(u=h.Convert.wf(t.v,b,!h.ExcelCompatibleCalcMode),t[l]=u),u=d.Ul.w0a(u))):g>=e.getRowCount()?n:i>=e.getColumnCount()?n:e.kj.getValue(g,i,j))},b.prototype.getIdentity=function(a,b){var c=this,d=b.row,e=b.rowCount||1,f=b.column,g=b.columnCount||1;return d===-1&&(d=0,e=c.getRowCount()),f===-1&&(f=0,g=c.getColumnCount()),c.getName()+"."+d+"."+e+"."+f+"."+g},b.prototype.getReference=function(a){var b,c,d,e,f,g,i=this,j=a.row,k=a.col;if(j===-1&&(a.row=0,a.rowCount=i.getRowCount()),k===-1&&(a.col=0,a.colCount=i.getColumnCount()),b=!1,a.spillRef)if(c=i.yLb().getAnchorCell(j,k))a.rowCount=c.rowCount,a.colCount=c.colCount,b=!c.isValid;else{if(d=i.getCalcSourceModel(),e=d.Qf(j,k))return e.row===j&&e.col===k?(a.rowCount=e.rowCount,a.colCount=e.colCount,new h.CalcReference(i,[a])):void 0;if(f=d.Kf(j,k),!f||33!==f.type)return f&&("@"===f.functionName||f instanceof h.ReferenceExpression)?(a.rowCount=1,a.colCount=1,new h.CalcReference(i,[a])):void 0;b=!0,a.rowCount=1,a.colCount=1}return g=new h.CalcReference(i,[a]),b&&(g.isSpillError=!0),g},b.prototype.getSources=function(a){var c,d,e,f,g;if(this.kj&&this.kj.parent&&this.kj.parent.sheets&&a instanceof b){for(c=this.kj.parent.sheets,d=!1,e=void 0,f=[],g=0;g<c.length;g++){if(e=c[g].yj(),e===this&&(d=!0),e===a){f.push(e);break}d&&f.push(e)}return f}},b.prototype.Ppb=function(a,b){var c,d=this,e=d.Hu,f=e&&e.arrayInfo;f&&(c=!1,f.forEach(function(d,g){if(d){var h=d.reference,i=d.key;D.call(h.yf[0],a,b)&&(delete e[i],f[g]=o,c=!0)}}),c&&(e.arrayInfo=[],f.forEach(function(a){a&&e.arrayInfo.push(a)})))},b.prototype.referenceToArray=function(a,b,c,d,e,f,g,i){var k,l,r,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=this,J=1,K=1,L=[],M=I.kj,N=I.Hu,O=p[b],P=a.getRangeCount();if(0===P)return L.isError=!0,L;if(N&&(x=a.getRangeCount()+"_"+a.getRow(0)+"_"+a.getColumn(0)+"_"+a.getRowCount(0)+"_"+a.getColumnCount(0)+"_"+b+"_"+c,u=N[x]))return u;for(y=this.getRowCount(),z=this.getColumnCount(),c=c===o||c,A=0;A<P;A++){if(c||(v=[],L.push(v)),J=a.getRowCount(A),0===J)return L.isError=!0,L;if(K=a.getColumnCount(A),0===K)return L.isError=!0,L;if(r=a.getRow(A),t=a.getColumn(A),r>=y||t>=z)return L=c?[n]:[[n]],L.rowCount=1,L.colCount=1,L.rangeCount=1,L;for(r+J>y&&(J=y-r),t+K>z&&(K=z-t),B=void 0,C=void 0,D=M.Ju,E=0;E<J;E++)for(k=r+E,c||(B=[],v.push(B)),N&&(N[k]||(N[k]={}),w=N[k]),F=0;F<K;F++){if(l=t+F,D&&M.Ku===k&&M.Lu===l)u=M.Mu,D=!1;else{if(N?(C=w[l],C?u=C.v:(u=M.getValue(k,l,I.Wz),C=w[l]={v:u})):u=M.getValue(k,l,I.Wz),g&&(G=M.getFormatter(),H=void 0,H=G instanceof s?G.formatString():G,"@"===H?u=M.getText(k,l):u instanceof Date&&(u=j.Pa(u)),m(C)||(C=w[l]={v:u})),d&&h.Convert.vf(u))return L=[u],L.isError=!0,L;if(C&&C[O]!==o)u=C[O];else if(u=h.Convert.wf(u,b,!h.ExcelCompatibleCalcMode,f,i),C&&(C[O]=u),e&&C===u)return L=[q],L.isConvertError=!0,L}h.Convert.j$a(u,f)||(c?L.push(u):B.push(u))}}return c||1!==P||(L=L[0]),L.rowCount=J,L.colCount=K,L.rangeCount=P,N&&!isNaN(P)&&!isNaN(J)&&!isNaN(K)&&P*J*K>100&&P*J*K<1e6&&N.arrayInfo.length<50&&(N[x]=L,N[x].rowCount=J,N[x].colCount=K,N[x].rangeCount=P,N.arrayInfo.push({reference:a,key:x})),L},b.prototype.getColumnCount=function(){var a=this.kj;return a.Js?0:a.getColumnCount(this.Wz)},b.prototype.getRowCount=function(){var a=this.kj;return a.Js?0:a.getRowCount(this.Wz)},b.prototype.isHiddenRow=function(a,b){var c=this.kj,d=c.Nu&&c.Nu();return!(!d&&b)&&0===c.getRowHeight(a)},b.prototype.getName=function(){var a=this.Wz,b=B(this.JXc)?this.kj.name():this.JXc;return a===d.SheetArea.colHeader?b+"CH":a===d.SheetArea.rowHeader?b+"RH":b},b.prototype.yLb=function(){var a=this,b=a.ZHb;return b||(b=a.ZHb=a.kj.ITa.ZHb),b},b.prototype.setArray=function(a,b,c,d,e){return this.yLb().setArray(this,a,b,c,d,e)},b.prototype.updateItem=function(a,b,c){return this.yLb().updateItem(this,a,b,c)},b.prototype.GIb=function(a,b){this.yLb().GIb(a,b)},b.prototype.HIb=function(){this.yLb().HIb()},b.prototype.setValue=function(a){var b,c,e,f,g,h,i,j,k,m,n,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=[];for(b=1;b<arguments.length;b++)G[b-1]=arguments[b];if(c=this,e=c.kj,h=c.Wz,a=a,a.row!==o)f=a.row,g=a.col,i=1;else{if(a.name)return;f=arguments[0],g=arguments[1],i=2}j=arguments[i],k=arguments[i+1],m=c.Hu,m&&(n=m[f],n&&(p=n[g],p&&(p.v=j,p.b!==o&&(p.b=o),p.d!==o&&(p.d=o),p.n!==o&&(p.n=o),p.s!==o&&(p.s=o),p.sn=o))),q=d.Ul.x0a(j),r=e.ITa,s=!1,t=e.tables,u=t&&t.find(f,g),3===h&&u&&(v=u.showHeader()&&f===u.headerIndex(),w=u.showFooter()&&f===u.footerIndex(),v||w||(s=u.yq(f,g,q))),x=e.wq,3===h&&!s&&x&&x.Ou&&(y=x.getValue(f,g),z=!1,y.hasBinding&&(A=void 0,m?(B=m.bindingRows=m.bindingRows||{},A=B[f],A||(A=B[f]=l({},e.getDataItem(f)))):A=l({},e.getDataItem(f)),r.Cp(f,g,{Dp:A,Ep:y.value}),z=x.setValue(f,g,q,r.zTa)),s="dataManagerBindingSource"===x.CL?z:y.hasBinding),s||(C="hyperlink",D="__proto__","string"==typeof q&&q[C]&&(E=q[C],F={url:E},r.setHyperlink&&r.do("setHyperlink",f,g,F),delete q[D].hyperlink),r.do("setValue",f,g,q,h,!0,!0,arguments[i+2])),e.cJc=!0,this.Iu?this.Iu.push({row:f,col:g}):e.Wq(d.Events.CellChanged,{sheet:e,sheetName:e.name(),row:f,col:g,sheetArea:h,propertyName:"value",oldValue:k,newValue:j})},b.prototype.getCustomFunction=function(a){return this.kj?this.kj.Pu(a):n},b.prototype.getCustomName=function(a){a=E(a);var b=this.kj?this.kj.getCustomName(a):n;return b?b.getExpression():n},b.prototype.getSheet=function(){return this.kj},b.prototype.setFormula=function(a,b,c){},b.prototype.setArrayFormula=function(a,b,c,d,e){},b.prototype.setFormulaByName=function(a,b){},b.prototype.refresh=function(){this.kj.repaint()},b.prototype.toJSON=function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p,q,r,s,t,u,v=b,w=a.data||{},x=!0,y=this.Cf();for(y.UIc=!0,k=0;k<=c;k++)if(f=w.dataTable||{},g=v[k]){for(i=f[k],x=!i,i=i||{},l=0;l<=d;l++)if(h=g[l],h&&h.Lf){j=i[l]||{};try{n=y.unparse(this,h.Lf,k,l,!1,!0),o=P(n),p=void 0,o&&(B(j.prefix)&&(j.prefix={}),p=n,n=p.replace(/_xlpm\./g,"")),!h.Pf&&n&&0===n.indexOf("@")&&Z(this.kj,n.slice(1,n.length),0,0)&&(n=n.slice(1,n.length),o&&(p=p.slice(1,p.length))),h.Pf?h.Pf.row===k&&h.Pf.col===l&&(j.arrayInfo=h.Pf,j.formula=n,o&&(j.prefix[o]=p)):(j.formula=n,o&&(j.prefix[o]=p)),x=!1,i[l]=j}catch(a){}}if(x){if(f!==w.dataTable)continue}else f[k]=i;w.dataTable=f}if(e){for(q=w.columnDataArray||[],r=0;r<e.length;r++)s=e[r],s&&s.Lf&&(t=this.Cf().unparse(this,s.Lf,0,r,!1,!0),u=q[r]||{},u.formula=t,q[r]=u);q.length>0&&(w.columnDataArray=q)}m(w)||(a.data=w),delete y.UIc},b}(h.CalcSource),b.SheetSource=M,M.prototype.getParserContext=function(a,b,c){return b=b||h.pf(0,0),new K(this.kj,a,b,c)},N=function(a){O(b,a);function b(b){var c=a.call(this,n)||this;return c.createSourceModel=function(a){return new h.CalcSourceModel(a,this)},c.Qu=b,c}return b.prototype.getCustomFunction=function(a){return this.Qu?this.Qu.getCustomFunction(a):n},b.prototype.getCustomName=function(a){var b=this.Qu?this.Qu.getCustomName(a)||this.Qu.aJb(a):n;return b?b.getExpression():n},b}(h.CalcSource),b.SpreadSource=N;function Q(a,b,c,e,f,g){var i,j=a&&a instanceof d.Worksheet&&a,k=new h.Parser;return c=c===o?0:c,e=e===o?0:e,i=new K(j,(!!f),h.pf(c,e)),g&&(i.culture=!0),k.parse(i,b)}b.formulaToExpression=Q;function R(a,b,c,e,f,g){var i,j=a&&a instanceof d.Worksheet&&a,k=new h.Parser;return c=c===o?0:c,e=e===o?0:e,i=new K(j,(!!f),h.pf(c,e)),i.YSa=g,k.unparse(i,b)}b.expressionToFormula=R;function S(a,b,c,d,e){c===o&&(c=0),d===o&&(d=0);var f=Q(a,b,c,d,e,!0);return T(a,f,c,d)}b.evaluateFormula=S;function T(a,b,c,d,e){var f,g,i=a.Cf();return c===o&&(c=a.getActiveRowIndex()),d===o&&(d=a.getActiveColumnIndex()),f=!0,e&&e.convertNullToZero!==o&&(f=e.convertNullToZero),g=a.yj(),i.Hg(g,b,h.pf(c,d),!1,f)}b.evaluateExpression=T;function U(a,b,c,d,e){var f,j,k,l=a.row,m=a.col,o=a.row+a.rowCount-1,p=a.col+a.colCount-1,q=!1,r=!1,s=!1,t=!1;return arguments.length>=4&&(q=0!==(1&d),r=0!==(4&d),s=0!==(2&d),t=0!==(8&d),l-=q?b:0,o-=r?b:0,m-=s?c:0,p-=t?c:0),e&&(j=V(a,e,b),k=W(a,e,b),j&&k)?f=g.StructureReferenceResolver.create(e,j,k,a.col-e.dataRange().col,a.col+a.colCount-e.dataRange().col-1):(1===a.rowCount&&1===a.colCount?f=h.rf(n,n,l,m,q,s):(a.row<0&&(l=o=i.BAND_INDEX_CONST),a.col<0&&(m=p=i.BAND_INDEX_CONST),f=h.uf(n,n,l,m,o,p,q,s,r,t,b,c)),f)}b.rangeToExpression=U;function V(a,b,c){if(1===a.rowCount){if(b.hasHeadersRow()&&a.row===b.startRow())return 2;if(b.hasTotalsRow()&&a.row===b.endRow())return 8;if(c===a.row)return 1}else{if(b.hasHeadersRow()&&a.row===b.startRow()){if(a.rowCount===b.dataRange().rowCount+1)return 6;if(b.hasTotalsRow()&&a.rowCount===b.dataRange().rowCount+1+1)return 14}if(a.row===b.dataRange().row){if(a.rowCount===b.dataRange().rowCount)return 3;if(b.hasTotalsRow()&&a.rowCount===b.dataRange().rowCount+1)return 12}}return o}function W(a,b,c){return a.col===b.startColumn()&&a.colCount===b.dataRange().colCount?1:1===a.colCount?2:a.col>=b.startColumn()&&a.col+a.colCount-1<=b.endColumn()?4:o}function X(a,b,c,d,e){var f=U(a,b,c,d),g=new K(n,(!!e),h.pf(b,c)),i=new h.Parser,j=i.unparse(g,f);return g.no(),j}b.rangeToFormula=X;function Y(a,b,c,d,e,f,g){var i=U(b,c,d,e,g),j=new K(a,(!!f),h.pf(c,d)),k=new h.Parser;return k.unparse(j,i)}b.rangeToFormulaWithStructReference=Y;function Z(a,b,c,e){var f,g,h,i,j,k,l,m,n;if(!b)return null;if(c=c?c:0,e=e?e:0,f=a.Cf(),g=f.parse(a.yj(),b,c,e,!0,!0))if(h=g.source,h&&13===g.type);else if(1===g.type&&g.endSource){for(i=g.source,j=g.endSource,k=i.getSources(j),l=!1,m=0;m<k.length;m++)if(k[m]===a.yj()){l=!0;break}g=l&&g}return!g||!g.getRange||h&&h!==a.yj()?null:(n=g.getRange(c,e),n?new d.Range(n.row,n.col,n.rowCount,n.colCount):null)}b.formulaToRange=Z;function $(a,b,c,e,f){var i,j,k,l,n,p,q,r,s,t,u=[],v=[];if(!b)return u;for(i={},c=c||0,e=e||0,j=new h.Parser,k=g.qzb(j,b,a,c,e,o,f),l=0;l<k.length;l++)if(n=k[l].sheetRanges,n&&!m(n))for(p=0;p<n.sheets.length;p++)for(q=n.sheets[p],v=i[q],v||(i[q]=v=[],u.push({sheetName:q,ranges:v})),r=n[q],s=0;s<r.length;s++)t=r[s],v.push(new d.Range(t.row,t.col,t.rowCount,t.colCount));return u}b.formulaToRanges=$;function _(a,b,c,d,e){var f=new h.Parser,g=new K(n,(!!e),h.pf(b,c)),i=aa(f,g,a,b,c,d);return g.no(),i}b.rangesToFormula=_;function aa(a,b,c,d,e,f){var g,h,i,j="";for(g=0;g<c.length;g++)h=U(c[g],d,e,f),i=a.unparse(b,h),j+=g>0?", "+i:i;return j}b.ALb=aa,b.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15};function ba(a,b,c,d,e,g,h){var i,j,k,l,m=d.getValue(b,c),n=!1,o=100,p=.001,q=.01,r=(C(m)?+m:0)-h,s=d.getValue(e,g),u=(C(s)?+s:0)-h;if(C(s)&&Math.abs(u)<p)n=!0;else if(t(s))n=!1;else for(i=r+(0===r?q:q*r),k=0;!n&&k<o;k++)i=f.Common.o.Lma(i,13),a.setValue(b,c,i),s=d.getValue(e,g),j=(C(s)?+s:0)-h,C(s)&&Math.abs(j)<p?n=!0:t(s)?i=(r+i)/2:r-i===0?i=r+(0===r?q:q*r):u-j===0?i=r+2*(i-r):(l=i-j*(r-i)/(u-j),r=i,u=j,i=l);return n||a.setValue(b,c,m),n}b.goalSeek=ba},"./dist/plugins/sheetsCalc/calc.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BAND_INDEX_CONST=-2147483648,b.MAX_ROW_COUNT=1048576,b.MAX_COLUMN_COUNT=16384},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-calc"),e=c("Common"),f=c("./dist/plugins/sheetsCalc/calc.ns.js"),g=c("./dist/plugins/sheetsCalc/parser-sheets.js"),h=c("Core"),i=e.Common.u,j=i.Nb,k=Math.min,l=Math.max,m=void 0,n=null,o=d.Convert.vf,p=d.Errors.Reference,q=h.util.l_a;function u(a,b){var c,d,e,f;return b||(b=this),c=l(a.row,b.row),d=l(a.column,b.column),e=k(a.row+a.rowCount,b.row+b.rowCount),f=k(a.column+a.columnCount,b.column+b.columnCount),c>=e||d>=f?n:{row:c,column:d,rowCount:e-c,columnCount:f-d,intersectWith:u}}r=function(){function a(a,b,c,d,e,f,g,h){var i=this;i.Rj=a,i.Vj=b,i.Wj=c,i.Qj=d,i.Tj=e,i.Uj=f,i.Xj=g,i.Yj=h}return a.prototype.Nj=function(a){var b,c,d=this,e=d.Qj.kj,f=e&&e.KLc();return f&&a>=0?(b=a-d.Tj+1,c=e.NLc(d.Tj,b,!0),d.Tj-d.Vj+c):d.Tj-d.Vj},a.prototype.Oj=function(a){var b,c,d=this,e=d.Qj.kj,f=e&&e.KLc();return f&&a>=0?(b=a-d.Uj+1,c=e.NLc(d.Uj,b),d.Uj-d.Wj+c):d.Uj-d.Wj},a.prototype.Sj=function(a,b,c,d,e){var f=this;return f.Rj===a&&(f.Vj===-1||f.Vj<=b&&b+d<=f.Vj+f.Xj)&&(f.Wj===-1||f.Wj<=c&&c+e<=f.Wj+f.Yj)},a.prototype.Pj=function(a,b,c,d,e){var f=this,g=f.Qj.kj,h=g&&g.KLc(),i=f.Tj,j=f.Uj,k=f.Xj,l=f.Yj;return h&&(k+=g.MLc(i,k,!0),l+=g.MLc(j,l)),f.Qj===a&&(i===-1||i<=b&&b+d<=i+k)&&(j===-1||j<=c&&c+e<=j+l)},a.prototype.intersectWith=function(a,b,c,d,e){var f,g,h=this;return h.Qj!==a?n:(f=h.Zj(a,b,c,d,e),g=h.Zj(a,h.Vj,h.Wj,d,e),g.intersectWith(f))},a.prototype.Zj=function(a,b,c,d,e){var f=b===-1?0:b,g=b===-1||d===-1?a.rowCount:d,h=c===-1?0:c,i=c===-1||e===-1?a.colCount:e;return{row:f,column:h,rowCount:g,columnCount:i,intersectWith:u}},a}(),b.MoveSwapInfo=r;function v(a,b,c,d){return(!d||a<b)&&c}function w(a){return[a.row,a.col,a.rowCount,a.colCount].join(",")}function x(a,b,c,d){var e=a[b];e||(e=a[b]={}),e[c]=d}function y(a,b,c){var d=a[b];return!!d&&d[c]}s=function(){function a(){}return a.zj=function(b,c,e,g,h,i,j,l,m,n,o){var q,r,s,t,u,v,w=e,x=a,y=this.zj;if(!e)return w;if(s=e.type,10===s)w=d.Lh(y.call(x,b,c,e.value,g,h,i,j,l,m,n,o));else if(1===s&&e.sf()||33===s){if(q=k((e.source||c).getRowCount(),f.MAX_ROW_COUNT),r=k((e.source||c).getColumnCount(),f.MAX_COLUMN_COUNT),e.rowRelative&&(e.row+g<0||e.row+g>=q)||e.columnRelative&&(e.column+h<0||e.column+h>=r))return d.Hh(p,e.source);w=e.offset(0,0,!1)}else if(1===s){if(q=k((e.source||c).getRowCount(),f.MAX_ROW_COUNT),r=k((e.source||c).getColumnCount(),f.MAX_COLUMN_COUNT),t=e,t.rowRelative&&!e.isFullColumn&&(t.row+g<0||t.row+g>q)||t.columnRelative&&!e.isFullRow&&(t.column+h<0||t.column+h>r)||t.endRowRelative&&!e.isFullColumn&&(t.endRow+g<0||t.endRow+g>q)||t.endColumnRelative&&!e.isFullRow&&(t.endColumn+h<0||t.endColumn+h>r))return d.Hh(p,e.source,e.endSource);w=e.offset(0,0,!1,g,h)}else if(9===e.type)w=d.Kh(e.operatorType,y.call(x,b,c,e.value,g,h,i,j,l,m,n,o),e.value2&&y.call(x,b,c,e.value2,g,h,i,j,l,m,n,o));else if(7===s){if(u=[],e.arguments&&e.arguments.length>0)for(v=0;v<e.arguments.length;v++)u[v]=y.call(x,b,c,e.arguments[v],g,h,i,j,l,m,n,o);w=d.Jh(e,u)}else 13===s&&(w=e.offsetWhenCopy(b,c,g,h,i,j,l,m,n,o));return w},a.copyFormula=function(b,c,e,f,g,h,i,j,l,n){var o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z=b,$=f,_=b.getSource(),aa=f.getSource(),ba=a;if(Z&&$){for(o=aa&&aa.getSheet().ITa.dUa(),p=c,q=e,r=g,s=h,t=i,u=j,c<0&&(p=0,t=k(b.rC(),f.rC())),e<0&&(q=0,u=k(b.cC(),f.cC())),g<0&&(r=0),h<0&&(s=0),v=new d.CalcSourceModel(b.Cf(),_),A=aa.getSheet(),B=!n&&A.KLc(),C=t,D=u,E=A.getRowCount(),F=A.getColumnCount(),w=0;w<t;w++)for(x=0;x<u;x++)Z.Uf(v,w+p,x+q,w,x);for(G={},H=f.Cf(),w=0,y=0;w<t&&w+r<E;w++)if(I=w+r,B&&0===A.getRowHeight(I))t++;else if(l&&aa.isHiddenRow(I,!0))y++;else{for(x=0,z=0,u=D;x<u&&x+s<F;x++)if(J=x+s,B&&0===A.getColumnWidth(J))u++;else{if(K=v.Kf(y,z)){if(K===G)continue;if(L=g+w-c-y,M=h+x-e-z,K=ba.zj(_,aa,K,I,J,L,M,g,h,C,D),N=v.Qf(y,z),aa){if(B&&N)continue;if(N&&!N.isDynamicArray){for(O=N.rowCount,P=N.colCount,Q=p-N.row,Q>0&&(O-=Q),R=t-w,R<O&&(O=R),S=q-N.col,S>0&&(P-=S),T=u-x,T<P&&(P=T),U=0;U<O;U++)for(V=0;V<P;V++)v.Rf(w+U,x+V,G);f.setArrayFormula(I,J,O,P,H.unparse(aa,K,I,J),m,o)}else W=K?H.unparse(aa,K,I,J):m,aa.setFormula(I,J,W),X=v.Mf(y,z),X&&(Y=new d.EvaluateContext(aa,d.pf(I,J),(!1)),X=d.Mh(Y,K,!1,0,0),X=X===K?m:X),$.ig(I,J,K,X,N,o)}else $.Rf(I,J,K),$.Xf(I,J,N)}else $&&$.Kf(I,J)&&$.ig(I,J,m,m,m,o);z++}y++}}},a.moveFormula=function(a,b,c,d,e,f,g,i){var j,l,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=a.Bj(),O=d.Bj(),P=N.Cf();if(N&&O){for(j=d.getRowCount(),l=d.getColumnCount(),o=N.dUa(),p=O.dUa(),q=P.ih(),b<0&&(b=0,g=k(a.getRowCount(),j)),e<0&&(e=0),c<0&&(c=0,i=k(a.getColumnCount(),l)),f<0&&(f=0),r=!(a===d&&a.name()===d.name()),s=g,t=i,u=g,w=d.KLc(),w&&(s+=d.MLc(e,g,!0),t+=d.MLc(f,i)),N.Sg(b,c,g,i),ca(N,b,c,g,i),O.Sg(e,f,s,t),ca(O,e,f,s,t),x=[],y=0;y<g;y++)for(z=0;z<i;z++)A=N.Kf(y+b,z+c),B=N.Qf(y+b,z+c),C=N.Mf(y+b,z+c),A?(x.push({Lf:A,Pf:B,Nf:C}),N.Sf(y+b,z+c,o)):x.push(n);for(G=r?{}:null,y=0,D=0;y<u&&y+e<j;y++)if(H=y+e,w&&0===d.getRowHeight(H))u++;else{for(z=0,E=0,v=i;z<v&&f+z<l;z++)if(I=z+f,w&&0===d.getColumnWidth(I))v++;else{if(J=x[D*i+E]){if(A=J.Lf,B=J.Pf,w&&B){E++;continue}P&&B&&!B.isDynamicArray&&B.row===b+y&&B.col===c+z&&(F=h.kf(H,I,B.rowCount,B.colCount)),K=B&&!B.isDynamicArray?F:m,C=J.Nf,O.FTa(p,H,I),O.Rf(H,I,A),O.Xf(H,I,K),O.Wf(H,I,C),r&&(G[H+", "+I]=A)}else O.FTa(p,H,I),O.Rf(H,I,m),O.Xf(H,I,m);E++}D++}q.Dj(N,b,c,g,i),q.Dj(O,e,f,s,t),L=N.getSource().getSheet(),M=L.uja&&(L.parent||L).tja(),q.Ej(M,N.getSource(),b,c,O.getSource(),e,f,g,i,!0,G),r===!0&&q.Ej(M,N.getSource(),b,c,O.getSource(),e,f,g,i,!0,G)}},a.prototype.isAdjustCell=function(a){return a.preAdj||this.imb&&a===this.imb[0]},a.prototype.isAdjust=function(a){return a.preAdj||this.imb&&a===this.imb[0]},a.prototype.hh=function(a,b){var c=this,d,e;isNaN(b)||(c.imb||(c.imb={},c.jmb={}),d=c.imb[b],e=c.jmb[b],a&&!a.preAdj&&a!==d&&(d?e.nextAdj=a:c.imb[b]=a,a.preAdj=e,a.nextAdj=n,c.jmb[b]=a))},a.prototype.Fj=function(a,b){var c,d,e,f=this;isNaN(b)||(c=f.imb&&f.imb[b],a&&(a.preAdj||a===c)&&(d=a.preAdj,e=a.nextAdj,d?d.nextAdj=e:f.imb[b]=e,e?e.preAdj=d:f.jmb[b]=d,a.preAdj=n,a.nextAdj=n))},a.prototype.Gj=function(a,b,c,d,e,f,g){this.Hj(a,D,b,c,d,e,f,g);var h=0,i=0,j=0,k=0;0===b&&(d&&e?j=c:d?h=c:e?k=c:i=c),E(a,D,b,c,h,i,j,k,d,e),H(a,D,b,c,d,e)},a.prototype.Hj=function(a,b,c,d,e,f,g,h){var i,j,k,l,n,o,p,q,r,s,t,u,w,z,A,B,C,D,E,F=this,G=F.imb;if(G){for(q={};G[0];)if(n=G[0],i=n.ah,p=i.dUa(),o=i.getSource(),j=n.row,k=n.column,y(q,j,k))F.Fj(n,0);else{if(l=i.Kf(j,k))if(l=b.call(F,o,j,k,l,a,c,d,e,f,m,g,h),r=i.Qf(j,k)){if(o===a&&(s=f?d:-d,e?c<=r.row&&(r.row+=s):c<=r.col&&(r.col+=s)),j===r.row&&k===r.col)if(r.isDynamicArray)i.fg(j,k,l,r,!0,v(e?j:k,c,p,a.id===o.id));else for(t=j;t<j+r.rowCount;t++)for(q[t]||(q[t]={}),u=k;u<k+r.colCount;u++)i.fg(t,u,l,r,t===j&&u===k,v(e?t:u,c,p,a.id===o.id)),x(q,t,u,!0)}else i.fg(j,k,l,r,!0,v(e?j:k,c,p,a.id===o.id));else(i.getRowExpression&&i.getRowExpression(j)||i.getColumnExpression&&i.getColumnExpression(k))&&i.Ag(j,k,1,1);F.Fj(n,0)}for(;G[1];)n=G[1],i=n.ah,p=i.dUa(),j=n.row,i.getRowExpression&&(l=i.getRowExpression(j),l&&i.fg&&(o=i.getSource(),i.fg(j,-1,b.call(F,o,j,-1,l,a,c,d,e,f),m,!0,v(j,c,p,a.id===o.id)))),F.Fj(n,1);for(;G[2];)n=G[2],i=n.ah,p=i.dUa(),k=n.column,i.getColumnExpression&&(l=i.getColumnExpression(k),l&&i.fg&&(o=i.getSource(),i.fg(-1,k,b.call(F,o,-1,k,l,a,c,d,e,f),m,!0,v(k,c,p,a.id===o.id)))),F.Fj(n,2);for(;G[3];)w=G[3],z=w.name,i=w.ah,l=i.DTa(z),A=b.call(F,i.getSource(),0,0,l,a,c,d,e,f,{isNameID:!0}),i.gg(z,A),F.Fj(w,3);for(B in G)if(C=+B,C>3&&G.hasOwnProperty(B))for(;G[B];)D=G[B],E=D.ah,l=b.call(F,E,0,0,D.expression,a,c,d,e,f),E.setExpression(D.id,D.name,l),F.Fj(D,C)}},a.prototype.ph=function(a){var b=this,c=a.getCalcSourceModel(),d=a.getRowCount(),e=a.getColumnCount();ca(c,0,0,d,e),b.Hj(a,O),E(a,O,0,0,0,0,0,0,!0,!1),H(a,O,0,0,!0,!1)},a.prototype.Ej=function(a,b,c,d,e,f,g,h,i,j,k){var l,n,o,p,q,s,t,u,v,z,A,B,C,D,E,F,G,H,I,K,L,M,N=this,O=$,P=new r(b,c,d,e,f,g,h,i),Q={};if(a&&_(a,P,j),J(b,P,j),t=N.imb,v={},t){for(;t[0];)if(n=t[0],l=n.ah,o=n.row,p=n.column,s=l.dUa(),y(Q,o,p))N.Fj(n,0);else{if(q=l.Kf(o,p),u=l.getSource(),q)if(z=m,k&&k[o+", "+p]&&(u=b,z={crossSheetMoved:!0}),q=O.call(N,u,o,p,q,P,j,z),A=l.Qf(o,p),B=void 0,A&&!A.isDynamicArray)if(B=w(A),o===A.row&&p===A.col)for(v[B]=!0,C=o;C<o+A.rowCount;C++)for(Q[C]||(Q[C]={}),D=p;D<p+A.colCount;D++)l.fg(C,D,q,A,C===o&&D===p,s),x(Q,C,D,!0);else v[B]||(l.fg(o,p,q,A,!1,s),x(Q,o,p,!0));else l.fg(o,p,q,A,!0,s);else(l.getRowExpression&&l.getRowExpression(o)||l.getColumnExpression&&l.getColumnExpression(p))&&l.Ag(o,p,1,1);N.Fj(n,0)}for(;t[1];)n=t[1],l=n.ah,o=n.row,s=l.dUa(),l.getRowExpression&&(q=l.getRowExpression(o),q&&l.jg&&l.jg(o,O.call(N,u,o,-1,q,P,j),m,s)),N.Fj(n,1);for(;t[2];)n=t[2],l=n.ah,p=n.column,s=l.dUa(),l.getColumnExpression&&(q=l.getColumnExpression(p),q&&l.kg&&l.kg(p,O.call(N,u,-1,p,q,P,j),m,s)),N.Fj(n,2);for(;t[3];)E=t[3],F=E.name,l=E.ah,q=l.DTa(F),G=O.call(N,u,0,0,q,P,j),l.gg(F,G),N.Fj(E,3);for(H in t)if(I=+H,I>3&&t.hasOwnProperty(H))for(;t[H];)K=t[H],L=K.ah,M=L.getSource(),q=O.call(N,M,0,0,K.expression,P,j),L.setExpression(K.id,K.name,q),N.Fj(K,I)}},a.prototype.Dj=function(a,b,c,d,e){var f,g,h,i,j,k=this,l=b+d,m=c+e;for(h=b;h<l;h++)for(i=c;i<m;i++)f=a.Yf(h,i),g=a.Kf(h,i),(f||g)&&(k.Fj(f,0),a.Q3(h,i,0),j=a.qg(h,i,!0),k.hh(j,0))},a.prototype.Ij=function(a,b,c){var d,e,f=this;for(d=b;d!==-1&&d<b+c;d++)(a.Yf(-1,d)||a.Kf(-1,d))&&(a.Q3(-1,d,2),e=a.sg(d,!0),f.hh(e,2))},a.prototype.Jj=function(a,b,c){var d,e,f=this;for(d=b;d!==-1&&d<b+c;d++)(a.Yf(d,-1)||a.Kf(d,-1))&&(a.Q3(d,-1,1),e=a.rg(d,!0),f.hh(e,1))},a.prototype.Kj=function(a){var b,c,e,f,g,h=this,i=a.Cf().getAllSourceModels();for(e=0;e<i.length;e++)if(f=i[e],f.lmb)for(b=f.lmb(),g=0;g<b.length;g++)c=b[g],c&&c.isVolatile&&c instanceof d.CellCalc&&!h.isAdjustCell(c)&&h.hh(c,0)},a.prototype.onBeforeAddRemoveRows=function(a,b,c){[a,c].forEach(function(a){if(a){var c=a.rC(),d=a.cC();a.Sg(b,0,c-b,d),a.Ug(b,c-b),ca(a,b,-1,c-b,-1,!0)}})},a.prototype.onAfterAddRemoveRows=function(a,b,c,d,e,f){var g=this;[a,f].forEach(function(a){if(a){var e=a.rC(),f=a.cC();d?a.Ag(b,0,c,f):e+=c,g.Dj(a,b,0,e-b,f),g.Jj(a,b,e-b),g.Kj(a)}}),g.Gj(a.getSource(),b,c,!0,d,m,e),a.Cf().autoCalculation&&a.Cf().recalculateAll(!1)},a.prototype.onAfterAddRemoveColumns=function(a,b,c,d,e,f){var g=this;[a,f].forEach(function(a){if(a){var e=a.rC(),f=a.cC();d?a.Ag(0,b,e,c):f+=c,g.Dj(a,0,b,e,f-b),g.Ij(a,b,f-b),g.Kj(a)}}),g.Gj(a.getSource(),b,c,!1,d,m,e),a.Cf().autoCalculation&&a.Cf().recalculateAll(!1)},a.prototype.onBeforeAddRemoveColumns=function(a,b,c){[a,c].forEach(function(a){if(a){var c=a.rC(),d=a.cC();a.Sg(0,b,c,d-b),a.Wg(b,d-b),ca(a,-1,b,-1,d-b,!0)}})},a.prototype.onAfterRemoveName=function(a,b){var c=a.wg(b,!1);c&&(c.updateListening(!0,!1),c.fh(),c.updateListeningOnRemoved())},a.prototype.adjustFormulaOnRemoveName=function(a,b,c){return da(a,b,c)},a.prototype.invalidName=function(a,b){var c,d;b&&(c=a.getCalcSourceModel(),d=c.wg(b.toUpperCase(),!0),d&&d.Yg())},a.prototype.onAfterRemoveTable=function(b,c){var d,e,f,g,i,j,k,l,m,n,o,p,q=this;for(i=0;i<b.length;i++)j=b[i],ca(j.source().getCalcSourceModel(),j.startRow(),j.startColumn(),j.endRow()-j.startRow()+1,j.endColumn()-j.startColumn()+1);if(k=q.imb)for(l={};k[0];)if(m=k[0],d=m.ah,e=m.row,f=m.column,y(l,e,f))q.Fj(m,0);else{if(g=d.Kf(e,f))if(g=a.adjustExpressionOnRemoveTable(g,b,e,f,c),n=d.Qf(e,f),n&&!n.isDynamicArray)for(n=h.kf(e,f,n.rowCount,n.colCount),o=e;o<e+n.rowCount;o++)for(l[o]||(l[o]={}),p=f;p<f+n.colCount;p++)d.fg(o,p,g,n,o===e&&p===f),x(l,o,p,!0);else d.fg(e,f,g,n,!0);else(d.getRowExpression&&d.getRowExpression(e)||d.getColumnExpression&&d.getColumnExpression(f))&&d.Ag(e,f,1,1);q.Fj(m,0)}},a.adjustExpressionOnRemoveTable=function(b,c,e,f,g){var h,i,j,k,l,m,o,p,q,r,s,t,u,v,w,x,y,z=a.adjustExpressionOnRemoveTable;if(9===b.type){if(h=b.value,i=b.value2,j=z(h,c,e,f,g),k=i&&z(i,c,e,f,g),h!==j||i!==k)return d.Kh(b.operatorType,j,k)}else if(7===b.type){for(l=!1,m=[],o=0;o<b.arguments.length;o++)p=b.arguments[o],q=z(p,c,e,f,g),l=l||p!==q,m.push(q);if(l)return d.Jh(b,m)}else if(10===b.type){if(r=b,s=r.value,t=z(s,c,e,f,g),s!==t)return d.Lh(t)}else if(13===b.type)for(u=b,o=0;o<c.length;o++)if(u.baseTable===c[o])return g?d.Ih:(v=u.getRange(e===-1?0:e,f===-1?0:f,!0),w=e===-1||1===u.referencePortions(),x=1===v.rowCount&&1===v.columnCount,y=u.source,x?d.rf(y,n,v.row,v.col,w,!1):d.uf(y,n,v.row,v.col,v.row+v.rowCount-1,v.col+v.colCount-1,w,!1,w,!1));return b},a}(),b.CalcOperatorAdjustor=s,t=d.CalcService.prototype,t.uzb=function(){return new s};function z(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p;return c>=0||!e?(m=d+(e?c:0),n=f+(g?c:0),o=k&&L(h,a,k),p=!k&&L(h,a,k),(o||p)&&(!l&&i+j<=c||l&&i<=c)&&(m-=e?j:0,n-=g?j:0),o=k&&L(h,b,k),p=!k&&L(h,b,k),(o||p)&&(!l&&i<=m||l&&(e&&c+d>=i||!e&&d>=i)?(m+=j,n+=j):(!l&&i<=n||l&&(g&&c+f>=i||!g&&f>=i))&&(n+=j)),m-=e?c:0,n-=g?c:0,l&&i+j<=c&&(m+=e?j:0,n+=g?j:0),{index:m,endIndex:n}):{index:d,endIndex:f}}function A(a,b,c,e,f,g,h,i,j,k,l,m){if(b&&!m){var n=j?f.row:f.column,p=j?f.rowRelative:f.columnRelative,q=void 0;if(j&&c>=0||!j&&e>=0||!p){if(k)q=z(a,b,j?c:e,n,p,-1,!1,g,h,i,j,l).index;else if(q=K(a,b,j?c:e,n,p,g,h,i,j,l),o(q))return d.Hh(q);q!==n&&(f=f.offset(j?q-n:0,j?0:q-n,!0))}}return f}function B(a,b,c,e,f,g,h,i,j,k,l,m){var n,p,q,r,s,t,u,v;if(b&&!m){if(n=f.tf(),3===n||j&&2===n||!j&&1===n)return f;if(p=j?f.rowRelative:f.columnRelative,q=j?f.endRowRelative:f.endColumnRelative,r=j?f.row:f.column,s=j?f.endRow:f.endColumn,t=void 0,j&&c>=0||!j&&e>=0||!p||!q){if(k)t=z(a,b,j?c:e,r,p,s,q,g,h,i,j,l);else if(t=M(a,b,j?c:e,r,p,s,q,g,h,i,j,l),o(t))return d.Hh(t);u=t.index,v=t.endIndex,u===r&&v===s||(f=f.offset2(j?u-r:0,j?0:u-r,j?v-s:0,j?0:v-s,c,e))}}return f}function C(a,b,c,d,e,f,g,h,i){if(b){var j=e;

      at a.text (public/js/spreadjs/gc.spread.sheets.all.14.2.0.min.js:65:8090)
      at a.text (public/js/spreadjs/gc.spread.sheets.all.14.2.0.min.js:65:8196)
      at a.j1 (public/js/spreadjs/gc.spread.sheets.all.14.2.0.min.js:65:12534)
      at a.workbook (public/js/spreadjs/gc.spread.sheets.all.14.2.0.min.js:65:9203)
      at public/js/spreadjs/gc.spread.sheets.designer.all.14.2.0.min.js:1:863627
      at Object.InternalInit (public/js/spreadjs/gc.spread.sheets.designer.all.14.2.0.min.js:1:863316)
      at e.setConfig (public/js/spreadjs/gc.spread.sheets.designer.all.14.2.0.min.js:1:5422203)
      at m (public/js/spreadjs/gc.spread.sheets.designer.all.14.2.0.min.js:1:5249579)
      at o (public/js/spreadjs/gc.spread.sheets.designer.all.14.2.0.min.js:1:5252744)
      at l (public/js/spreadjs/gc.spread.sheets.designer.all.14.2.0.min.js:1:5256841)
      at Object._validate (public/js/spreadjs/gc.spread.sheets.designer.all.14.2.0.min.js:1:5251970)
      at Object.sd (public/js/spreadjs/gc.spread.sheets.designer.all.14.2.0.min.js:1:5253622)
      at new e (public/js/spreadjs/gc.spread.sheets.designer.all.14.2.0.min.js:1:5417964)
      at ref (src/Designer.jsx:9:27)
      at Object.<anonymous> (src/App.test.js:5:3)

  ΓùÅ renders learn react link

    TypeError: Cannot read property 'destroy' of null

      10 |         }
      11 |         else {
    > 12 |             ref.current.destroy();
         |                         ^
      13 |             ref.current = null;
      14 |         }
      15 |     }

      at apply (src/Designer.jsx:12:25)
      at Object.<anonymous> (src/App.test.js:5:3)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        24.442 s, estimated 27 s
Ran all test suites related to changed files.


